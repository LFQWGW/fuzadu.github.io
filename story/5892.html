<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>在Linux上使用iptables</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>在Linux上使用iptables</h2></div><div class="content"><p>本指南将尝试解释如何在Linux上以易于理解的语言使用iptables。</p><p>概述 / 综述</p><p>iptables是基于规则的防火墙，它将按顺序处理每个规则，直到找到匹配的规则。</p><p>TODO：此处包含示例</p><p>使用 / 惯用法 / 正确用法 / 常规做法</p><p>iptables实用程序通常预先安装在您的Linux发行版上，但实际上并没有运行任何规则。您可以在以下大多数发行版中找到该实用程序：</p><code>/sbin/iptables</code><p>阻止单个IP地址</p><p>您可以使用-s参数阻止IP，将10.10.10.10替换为您尝试阻止的地址。您将注意到，在本例中，我们使用了-i参数(或-insert也可以)而不是追加，因为我们希望确保此规则在任何允许规则之前首先显示。</p><code>/sbin/iptables -I INPUT -s 10.10.10.10 -j DROP</code><p>允许来自IP地址的所有流量</p><p>您也可以使用与上述相同的命令，但用Accept替换Drop，从而允许来自某个IP地址的所有流量。您需要确保此规则在任何删除规则之前首先出现。</p><code>/sbin/iptables -A INPUT -s 10.10.10.10 -j ACCEPT</code><p>阻止来自所有地址的端口</p><p>通过使用-dport开关并添加要阻止的服务的端口，您可以完全阻止通过网络访问端口。在此示例中，我们将阻止MySQL端口：</p><code>/sbin/iptables -A INPUT -p tcp --dport 3306 -j DROP</code><p>允许来自单个IP的单个端口</p><p>您可以将-s命令与-dport命令一起添加，以进一步将规则限制为特定端口：</p><code>/sbin/iptables -A INPUT -p tcp -s 10.10.10.10 --dport 3306 -j ACCEPT</code><p>查看当前规则</p><p>您可以使用以下命令查看当前规则：</p><code>/sbin/iptables -L</code><p>这应该会给出类似于以下内容的输出：</p><code>Chain INPUT (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     all  --  192.168.1.1/24  anywhere            
ACCEPT     all  --  10.10.10.0/24       anywhere             
DROP       tcp  --  anywhere             anywhere            tcp dpt:ssh 
DROP       tcp  --  anywhere             anywhere            tcp dpt:mysql</code><p>当然，实际产出会更长一些。</p><p>清除当前规则</p><p>您可以使用flush参数清除所有当前规则。如果您需要以正确的顺序放置规则，或者在测试时，这是非常有用的。</p><code>/sbin/iptables --flush</code><p>特定于分布的</p><p>虽然大多数Linux发行版都包含某种形式的iptables，但其中一些也包含包装器，这使得管理变得更加简单。大多数情况下，这些“插件”采用init脚本的形式，这些脚本负责在启动时初始化iptables，尽管一些发行版也包含试图简化常见情况的成熟的包装应用程序。</p><p>白眉企鹅</p><p>Gentoo上的*iptables/init脚本能够处理许多常见场景。对于初学者，它允许您将iptables配置为在启动时加载(通常是您想要的)：</p><code>rc-update add iptables default</code><p>使用init脚本，可以使用易于记忆的命令加载和清除防火墙：</p><code>/etc/init.d/iptables start
/etc/init.d/iptables stop</code><p>init脚本处理在启动/停止时保持当前防火墙配置的细节。因此，您的防火墙始终处于您离开它的状态。如果您需要手动保存新规则，init脚本也可以处理此问题：</p><code>/etc/init.d/iptables save</code><p>此外，您还可以将防火墙恢复到以前保存的状态(对于您正在试验规则并且现在想要恢复以前的工作配置的情况)：</p><code>/etc/init.d/iptables reload</code><p>最后，init脚本会将iptables置于“恐慌”模式，所有传入和传出流量都会被阻止。我不确定为什么此模式有用，但似乎所有Linux防火墙都有此模式。</p><code>/etc/init.d/iptables panic</code><p>警告：*如果您通过SSH连接到您的服务器，请不要启动死机模式；否则您将无法断开连接！您应该将iptables置于恐慌模式的唯一时间是当您身体处于计算机前面时。</p><div class="item_info"><span class="item_key"><a href="/tag/规则/">规则</a></span><span class="item_key"><a href="/tag/阻止/">阻止</a></span><span class="item_key"><a href="/tag/iptables/">iptables</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14177.html">如何在Linux上使用端口敲门(以及为什么不应该使用)</a><li><a href="/story/14161.html">如何将电子邮件自动分类到特定的Outlook文件夹</a><li><a href="/story/12244.html">如何在Windows防火墙上打开端口？</a><li><a href="/story/11716.html">如何在Apple Mail for Mac中设置外出回复</a><li><a href="/story/10116.html">如何在Outlook中计划或延迟发送电子邮件</a><li><a href="/story/9732.html">如何在Apple Mail中设置规则</a><li><a href="/story/9572.html">如何在Outlook中导出和导入规则</a><li><a href="/story/9510.html">如何仅获取重要电子邮件的Outlook通知</a><li><a href="/story/8888.html">如何使用Windows防火墙阻止应用程序访问Internet</a><li><a href="/story/7744.html">如何使用规则管理您的Outlook.com电子邮件</a><li><a href="/story/7670.html">如何使用快速步骤和规则在Outlook中更好地管理电子邮件</a><li><a href="/story/6926.html">使用具有高级安全性的Windows防火墙</a><li><a href="/story/5345.html">使用AutomateIt自动化您的手机或平板电脑</a><li><a href="/story/5128.html">极客学校：学习Windows 7-Windows防火墙</a><li><a href="/story/4257.html">如何在Windows防火墙中创建高级防火墙规则</a><li><a href="/story/3828.html">组策略极客：如何使用GPO控制Windows防火墙</a><li><a href="/story/3409.html">如何在Windows 8中启用Ping Echo回复</a><li><a href="/story/1356.html">在Windows 7中使用AppLocker限制对程序的访问</a><li><a href="/story/1003.html">自动将每日电子邮件移动到Outlook中的特定文件夹</a><li><a href="/story/853.html">在Excel 2007中使用条件单元格格式</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>