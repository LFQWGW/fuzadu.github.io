<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>5个Cmdlet，帮助您开始使用PowerShell</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>5个Cmdlet，帮助您开始使用PowerShell</h2></div><div class="content"><img class="content_img" src="/image/7f/7fa1ef060593f0114013c3ac96300ee7.png" /><p>PowerShell正在迅速成为高级用户和IT专业人员的首选脚本语言和CLI。学习一些命令来帮助您入门是非常值得的，所以今天我们为您准备了5个有用的cmdlet供您学习。</p><p>获取命令</p><p>Get-Command是整个PowerShell中最有用的cmdlet之一，因为它允许您搜索某些cmdlet，从而帮助您掌握PowerShell。诚然，单独使用Get-Command并不是很有用，因为它只会吐出PowerShell拥有的所有命令。</p><img class="content_img" src="/image/2b/2bb10fe252af0696ec45651a432d66ba.png" /><p>但是从这里我们可以看到，PowerShell输出对象既有Name属性，也有ModuleName属性。使用此信息，我们可以通过搜索包含特定术语的cmdlet来细化我们的搜索。例如，如果我想查找包含单词“ip”的所有cmdlet，我可以这样做：</p><img class="content_img" src="/image/bd/bdebe37a942aed1cf735d57675fc636c.png" /><p>正如您所看到的，我们仍然获得了相当多的结果，我们的下一个选择是在特定模块中进行搜索。在我们的示例中，我将选择NetTCPIP模块。</p><img class="content_img" src="/image/15/155c0c6a243ec019d728c6d94765b682.png" /><p>获取帮助</p><p>使用Get-Command找到要查找的cmdlet后，您会想知道语法以及如何使用该特定cmdlet。这就是Get-Help的用武之地，如果您曾经在Windows中使用过命令行，您可能会这样做：</p><p>这在PowerShell中不起作用，这是因为在PowerShell中，使用空格将命令与其参数分开。因此，我们使用Get-Help并将cmdlet名称作为参数传递给Get-Help。</p><img class="content_img" src="/image/70/703da1f6fd7449ec12ffb16c775c1749.png" /><p>获取成员</p><p>Get-Member允许我们获取有关cmdlet返回的对象的信息。Get-Member的缺点在于它依赖于PowerShell的管道功能，为了演示这一点，我们可以使用Get-Process cmdlet。</p><img class="content_img" src="/image/a8/a898c2d03fc46c1e7861719e804843f7.png" /><p>正如您可以看到的，PowerShell的输出向我们显示了一些属性，您可以在每列的顶部看到这些属性。第一个问题是，虽然这些可能是您大部分时间都在寻找的属性，但仍然有更多这样的属性。第二个问题是，它没有显示我们能够在对象上调用的任何方法。要查看方法和属性，我们可以通过管道将输出传递给get-ember，如下所示：</p><img class="content_img" src="/image/9f/9f11278ffa22d2539f03d66a4113ec31.png" /><p>虽然Get-Member现在对您可能没有什么意义，但您迟早会需要使用Get-Member，而且越早学会使用越好。例如，使用输出中的信息，我们可以执行以下操作：</p><p>该脚本将启动记事本，然后将“get-process-name记事本”的输出赋给$NotepadProc变量，然后我们调用$NotepadProc上的WaitForExit方法，这会导致脚本暂停，直到您关闭记事本，一旦您关闭记事本，计算器就会启动。</p><p>$_(当前管道对象)</p><p>虽然不完全是cmdlet，但它是PowerShell中最常用的特殊变量之一。$_的正式名称是“当前管道对象”。它用于脚本块、过滤器、函数的PROCESS子句、WHERE-OBJECT、foreACH-OBJECT和开关。但是，使用示例更容易解释，这将把我们带到下一个也是最后一个cmdlet，Where-Object。</p><p>其中-对象</p><p>其中-object做的完全像它听起来的那样，它根据对象是否满足特定标准来选择对象。这将把$_和我们可以使用Get-Member看到的属性放在一起。为了演示这一点，我们将Get-Process的输出通过管道传输到Where-Object cmdlet。</p><img class="content_img" src="/image/9d/9d847ca62c389cb4c2e519aa7dd4f13e.png" /><p>那么，你会问，这里到底是怎么回事？我们要做的第一件事是获取计算机上的进程列表，并将输出(使用|字符)传递给WHERE-Object cmdlet，该cmdlet接受脚本块1作为参数。脚本块(由大括号定义)指示WHERE-Object cmdlet仅选择其Name参数等于“IExplore”的对象，因此我们只获得正在运行的IE实例的列表。就这些，玩得开心！</p><div class="item_info"><span class="item_key"><a href="/tag/cmdlet/">cmdlet</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/输出/">输出</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/8752.html">如何在Windows 10上使用PackageManagement(也称为OneGet</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>