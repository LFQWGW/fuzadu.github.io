<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>极客学派：学习PowerShell变量、输入和输出</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>极客学派：学习PowerShell变量、输入和输出</h2></div><div class="content"><img class="content_img" src="/image/20/207ea41ab315096bfcdb3ed62317373a.png" /><p>随着我们从简单地运行命令转向编写成熟的脚本，您将需要一个临时位置来存储数据。这就是变量的用武之地。</p><p>请务必阅读本系列的前几篇文章：</p><p>
了解如何使用PowerShell自动化Windows。
学习在PowerShell中使用Cmdlet。
了解如何在PowerShell中使用对象。
在PowerShell中学习格式化、筛选和比较。
学习在PowerShell中使用远程处理。
使用PowerShell获取计算机信息。
在PowerShell中使用集合</p><p>在接下来的一周里，我们将继续关注这一系列的节目。</p><p>变数</p><p>大多数编程语言都允许使用变量，变量只是保存值的容器。在PowerShell中，我们也有变量，它们非常容易使用。下面介绍如何创建一个名为“FirstName”的变量并为其赋值“Taylor”。</p><p>大多数人似乎会问的第一件事是，为什么我们在变量名前面放一个美元符号，这实际上是一个非常好的问题。实际上，美元符号只是对shell的一个小小提示，表明我们希望访问变量的内容(考虑容器内的内容)，而不是容器本身。在PowerShell中，变量名不包括美元符号，这意味着在上面的示例中，变量名实际上是“FirstName”。</p><p>在PowerShell中，您可以看到在变量PSDrive中创建的所有变量。</p><img class="content_img" src="/image/d2/d26f54a4d5d4c760fca9df6937b010ef.png" /><p>这意味着您也可以随时从shell中删除变量：</p><p>变量也不必包含单个对象；您可以同样轻松地在一个变量中存储多个对象。例如，如果您希望在变量中存储正在运行的进程列表，则只需将get-process的输出分配给它即可。</p><p>理解这一点的诀窍是记住等号的右手边总是首先求值。这意味着如果您愿意，您可以在右侧拥有整个管道。</p><p>CPUHog变量现在将包含使用最多CPU的三个正在运行的进程。</p><img class="content_img" src="/image/58/5862ffd8334e3720c74793e9886be98a.png" /><p>当您确实有一个保存对象集合的变量时，有一些事情需要注意。例如，对变量调用方法将导致对集合中的每个对象调用该方法。</p><p>这会杀死集合中的所有三个进程。如果要访问变量中的单个对象，则需要将其视为数组。</p><p>这样做将为您提供集合中的第一个对象。</p><img class="content_img" src="/image/25/25c268311a40e533d690848e604a20e6.png" /><p>别被抓到！</p><p>默认情况下，PowerShell中的变量是弱类型的，这意味着它们可以包含任何类型的数据，这似乎一直吸引着PowerShell的新人！</p><p>我们有两个变量，一个包含字符串，另一个包含整数。那么，如果添加它们会发生什么呢？这实际上取决于您添加它们的顺序。</p><p>当…的时候 / 然而 / 尽管 / 虽然</p><p>在第一个示例中，第一个操作数是一个整数$a，因此PowerShell认为您正在尝试进行数学运算，因此也会尝试将任何其他操作数转换为整数。但是，在第二个示例中，第一个操作数是字符串，因此PowerShell只是将其余操作数转换为字符串并将它们连接起来。更高级的脚本编写者通过将变量转换为他们期望的类型来防止这种陷阱。</p><p>以上两种情况都会导致Number变量包含一个值为5的整数对象。</p><p>输入输出</p><p>因为PowerShell旨在实现自动化，所以您会希望尽可能避免提示用户输入信息。也就是说，有些时候您无法避免它，对于这些时间，我们有Read-Host cmdlet。使用它非常简单：</p><img class="content_img" src="/image/3d/3d042db4ca1994561d2066c444578eae.png" /><p>然后，您输入的任何内容都将保存在变量中。</p><img class="content_img" src="/image/8e/8eb54db60ceb0a7c0e04a6c7fc8b8af8.png" /><p>使用写输出cmdlet，写入输出同样简单。</p><img class="content_img" src="/image/29/29b02837ccbe76824000143875b15717.png" /><p>明天加入我们吧，我们把学到的一切都联系在一起！</p><div class="item_info"><span class="item_key"><a href="/tag/变量/">变量</a></span><span class="item_key"><a href="/tag/powershell/">powershell</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14159.html">如何在Bash中使用变量</a><li><a href="/story/3419.html">专家极客：使用PowerShell像驱动器一样导航注册表命令行样式</a><li><a href="/story/2855.html">如何在Windows中使用全局系统环境变量</a><li><a href="/story/2565.html">如何使用雨量计在桌面上显示报价</a><li><a href="/story/23.html">在Windows窗体窗口之间传递变量，而不使用ShowDialog()</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>