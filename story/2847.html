<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>从命令行替换纯文本文件中的文本</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>从命令行替换纯文本文件中的文本</h2></div><div class="content"><p>Windows命令行工具库中缺少的一个非常有用的功能是替换纯文本文件中的文本的功能。这样的功能可用于许多系统管理员执行的各种实际任务，例如：</p><p>
更新配置/INI文件以替换UNC路径。
批量更新存储在终端/Citrix服务器上的INI文件中的用户信息。
与脚本结合使用来部署“模板化”数据，然后将值应用到复制的文件。</p><p>我们的解决方案是一个与Visual Basic Replace函数接口的VBScript。通过将此脚本放入Windows PATH变量中的某个位置，您现在就可以使用此功能了。</p><p>用途</p><p>一旦进入系统，只需使用ReplaceText命令即可调用该脚本。下面几个示例将说明您可以使用此功能的方法：</p><p>将C：DataValues.csv文件中的“null”替换为“n/a”：</p><p>扫描C：Users(+子目录)文件夹中的所有INI文件，使用不区分大小写的搜索将所有出现的“Server=Old”替换为“Server=New”：</p><p>扫描当前用户配置文件中的所有CFG文件，使用区分大小写的搜索将“p@ssw0rd”替换为“PA$$word”：</p><p>正如您在下面看到的，该脚本非常简单，可以很容易地进行修改，以适应您可能遇到的任何特殊情况。或者，您可能希望创建脚本副本，对特定值进行硬编码，以便双击即可执行该命令，并且/或者允许您轻松地将其分发给其他人。</p><p>剧本</p><p></p><p>“替换文本”作者：Jason Faulkner‘SysadminGeek.com</p><p>‘此脚本应放在系统的PATH变量中指定的文件夹中。</p><p>‘用法(WScript)：’ReplaceText filename OldText NewText[/i]</p><p>‘/i(可选)-文本匹配不区分大小写</p><p>set oArgs=WScript.Arguments</p><p>intCaseSensitive=0For i=3 to oArgs.Count-1如果UCase(oArgs(I))=“/i”，则intCaseSensitive=1Next</p><p>set of so=CreateObject(“Scripting.FileSystemObject”)</p><p>如果不是oFSO.FileExists(oArgs(0))，则返回“WScript.Echo”指定的文件不存在。否则，将设置oFile=oFSO.OpenTextFile(oArgs(0)，1)，readstrText=oFile.ReadAll=oOFile.Close。</p><p>**strText=Replace(strText，oArgs(1)，oArgs(2)，1，-1，intCaseSensitive)</p><p>如果设置oFile=oFSO.OpenTextFile(oArgs(0)，2)，则需要设置oFile=oFSO.OpenTextFile(oArgs(0)，2)；如果是，则设置oFile=oFSO.OpenTextFile(oArgs(0)，2)；</p><div class="item_info"><span class="item_key"><a href="/tag/oargs/">oargs</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/替换/">替换</a></span></div></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>