<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>极客学校：学习Windows 7-监控、性能和保持Windows最新</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>极客学校：学习Windows 7-监控、性能和保持Windows最新</h2></div><div class="content"><img class="content_img" src="/image/a1/a17ef2899040c2a9ec7e57cda4b9a0d5.png" /><p>在今天的“极客学校”中，我们来看看我们可以用来监控计算机性能和可靠性的工具。</p><p>请务必阅读Windows7上这个极客学校系列之前的文章：</p><p>
介绍How-to Geek学校。
升级和迁移。
配置设备。
管理磁盘。
管理应用程序。
管理Internet Explorer。
IP寻址基础知识。
联网。
无线联网。
Windows防火墙。
远程管理。
远程访问</p><p>本周我们将继续关注这一系列剩下的节目。</p><p>事件日志</p><p>事件日志是记录计算机上重要事件的特殊文件，例如当用户登录到您的计算机或程序崩溃时。当您对计算机问题进行故障排除时，事件日志是非常有用的工具。您可以使用Windows事件查看器读取事件日志，但您需要是该计算机的管理员才能执行此操作。</p><p>打开事件查看器</p><p>要打开事件查看器，请单击开始并启动控制面板。</p><img class="content_img" src="/image/29/294cb20f41324740407d5513355683f4.png" /><p>然后进入系统和安全部分。</p><img class="content_img" src="/image/69/6910786624504ee678e12fbaaabab320.png" /><p>在这里，您需要单击管理工具。</p><img class="content_img" src="/image/b9/b95a373f371bdcab073658659e9bfe1d.png" /><p>然后，您可以通过单击事件查看器快捷方式将其打开。</p><img class="content_img" src="/image/dc/dc8b7dd380b7122f2f1abc13bee3ec68.png" /><p>非那样做不行。</p><img class="content_img" src="/image/19/192b2d96abc14545e26fce6607304806.png" /><p>事件查看器在多个不同的日志中显示事件。Windows日志包括：</p><p>
应用程序日志-应用程序日志包含程序记录的事件，例如，它可能能够告诉您特定程序崩溃的原因。
安全日志-安全日志记录有效和无效登录尝试等事件，以及与资源使用相关的事件(如创建、打开或删除文件)。
安装日志-安装日志记录添加、删除或更新Windows功能的事件。例如，每次安装Windows Update时都会记录一个条目。
系统日志-系统日志包含Windows系统组件记录的事件。例如，如果驱动程序在启动期间加载失败，则系统日志中会记录一个事件。</p><p>要查看其中一个Windows日志，只需展开Windows日志控制台树项目，然后选择要查看的日志即可。</p><img class="content_img" src="/image/c8/c81987e7e4b507b5a3c09bcb61f8637f.png" /><p>在右侧，您可以看到日志包含的所有事件。有三种类型的事件：</p><p>
错误-由令人讨厌的红色感叹号表示，错误表示存在致命问题，如数据丢失。
警告-由黄色感叹号表示，警告表示存在问题，但程序可以继续运行。它们还可以作为期货错误可能发生的通知。
信息-由白色感叹号表示，信息事件描述程序、驱动程序或服务的成功操作。</p><p>注意：安全日志不使用上述事件级别，而是使用安全审核。</p><p>过滤日志</p><p>事件日志包含数千个事件，查找所需信息有时可能很棘手。如果您知道要查找的内容，则始终可以使用日志筛选器过滤掉所有不相关的信息。让我们看看如何使用事件查看器来确定计算机启动需要多长时间。您需要做的第一件事是打开应用程序和服务日志，然后深入到Microsoft，然后深入到Windows。</p><img class="content_img" src="/image/ad/ad3dc8582ac0f19ecf7f5ad6c2383951.png" /><p>然后找到Diagnostics-Performance文件夹并筛选其操作日志文件。</p><img class="content_img" src="/image/e5/e5993431b7815b452b9a89ac861f2744.png" /><p>现在为事件ID为100的所有警告级别事件创建筛选器。</p><p>注：我碰巧知道这些信息，因为我以前需要用到它。您应该关注如何创建筛选器，而不是引导事件的事件ID为100。</p><img class="content_img" src="/image/f6/f693d26cfa79cae6b1414902198e0c2a.png" /><p>单击OK后，您应该只会看到警告级别的事件。</p><img class="content_img" src="/image/df/df8039d2ff8ea4998708ca0366625e15.png" /><p>如果您选择其中一个结果并查看其内容，您将看到引导时间(以毫秒为单位)。</p><img class="content_img" src="/image/63/631f116dd1cf7b2cc8fb6f960d728246.png" /><p>创建自定义视图</p><p>如果您知道每天都要连接到服务器并应用自定义筛选器来查看特定事件，则可能需要考虑创建自定义视图，该视图允许您创建自己的预先筛选的日志文件。创建新的自定义视图与创建新的筛选器完全相同：只需右键单击日志，然后从上下文菜单中选择Create Custom View。</p><img class="content_img" src="/image/8b/8b520d2b76d78ac98b65574390510b2a.png" /><p>然后选择过滤条件。我们将再次使用事件ID为100的警告级别事件。</p><img class="content_img" src="/image/37/37a1d40abccb3c897a37a8e53f7bd6fe.png" /><p>然后为您的新自定义视图命名并单击OK。</p><img class="content_img" src="/image/a4/a41151150ac92fe15a4e737ba1e99ee6.png" /><p>现在，您将拥有一个很好的、预先过滤的日志。</p><img class="content_img" src="/image/50/50725db754c6bf04f96ca4d3f8cf2249.png" /><p>限制日志文件的大小</p><p>如果需要控制日志文件的大小，可以通过右键单击日志选择属性来实现。</p><img class="content_img" src="/image/ad/ad1d203887f7033515d024f3007b650c.png" /><p>您可以在此处更改日志文件的大小(以KB为单位)，默认值为20MB。</p><p>注意：默认设置适用于大多数用途。</p><img class="content_img" src="/image/3e/3ed7b521f5413c9ab3133de016771ed2.png" /><p>资源监视器</p><p>Windows 7资源监视器在一个易于使用的界面中提供总体CPU、磁盘、网络和内存利用率的快速摘要。您可以将其视为任务管理器的更详细版本。</p><p>要打开资源监视器，请按Win+R组合键打开一个运行框，然后键入resmon并按Enter。</p><img class="content_img" src="/image/e5/e5339d9ba1976d2a0879d99dc57ea2e6.png" /><p>将出现默认窗口，并显示概述选项卡。在概述选项卡中，您可以看到四种受监控的资源-CPU、磁盘、网络和内存。</p><img class="content_img" src="/image/be/be2ce696ebfbc061b2e4258493f4ff05.png" /><p>当您的计算机突然运行缓慢时，资源监视器非常有用。</p><p>可靠性监视器</p><p>可靠性监视器是一种高级工具，用于测量计算机的硬件和软件问题以及其他更改。要打开可靠性监视器，请按Win+R组合键打开一个运行框，然后键入Perfmon/rel并按Enter键。</p><img class="content_img" src="/image/59/59b372f103678879cd2100dae7a4cd3b.png" /><p>您将看到一个很大的图表，显示您的系统在过去一周左右的总体可靠性。您将获得从1到10的系统稳定性评级，1是最差的，10是最好的。</p><img class="content_img" src="/image/64/647c7bae05a12bfb416e9f4e336d107f.png" /><p>随着时间的推移，您会注意到我的机器上的评级越来越低，但您也会注意到图表上有两个错误。要查看发生的错误，只需选择日期即可。</p><img class="content_img" src="/image/96/961a7b8e7cd8009cafd3176a18d6e3ed.png" /><p>在上面的屏幕截图中，您将看到由于断电而记录的严重事件，大大降低了我的系统的可靠性。看起来今天早些时候又出了一个错误。我们也去看看吧。</p><img class="content_img" src="/image/df/df5e5449b8b072ae0539cf656bfe0cb8.png" /><p>看起来又一次停电了。看起来我需要投资一个UPS部门。如您所见，可靠性监视器对于跟踪系统行为的趋势非常有用。</p><p>性能监视器</p><p>Windows性能监视器允许您实时测量网络上本地或远程计算机的性能，也可以通过收集日志数据供以后分析。</p><p>打开性能监视器</p><p>要打开性能监视器，请按Win+R组合键打开Run对话框，然后键入Perfmon，然后按Enter。</p><img class="content_img" src="/image/31/310675ec7ce89ab55204637ebead02ef.png" /><p>MMC控制台打开后，在控制台树中展开监视工具项，然后选择性能监视器。</p><img class="content_img" src="/image/39/3998297fdcbc416c010e5853a4ce2ec0.png" /><p>性能监视器的一大优点是，它允许您以图形方式查看实时性能信息。它通过使用性能计数器来做到这一点。性能计数器是对某事物在给定时间的执行情况的度量，性能计数器可以包含在操作系统中，也可以作为应用程序的一部分。性能计数器可以衡量的一个示例是CPU响应系统请求所花费的时间，如下所示。</p><img class="content_img" src="/image/1a/1a9f3b799b6b4cdae85934e680bee30a.png" /><p>要添加性能计数器，只需单击绿色的Add按钮。</p><img class="content_img" src="/image/95/95d48e0c74f92d24b44375e5acd4406f.png" /><p>然后选择要添加的性能计数器，方法是选择它们并单击“添加”按钮。</p><img class="content_img" src="/image/1e/1e2e81fbfd2e3bfc08b122bd3e148374.png" /><p>字面上有数千个计数器，但我在上面添加的那些是考试中最需要记住的。以下是对每一种情况的简要解释：</p><p>处理器 / 处理程序 / 加工者 / food processor 的简称</p><p>以下性能计数器对排除CPU问题很有用，可在处理器部分下找到：</p><p>
%Processor Time：这显示CPU响应系统请求所花费的时间。
中断/秒：这测量处理器每秒接收的平均硬件中断数。</p><p>记忆力 / 记忆中事物 / 回忆 / 存储器</p><p>以下性能计数器对解决内存问题很有用，可在内存部分下找到：</p><p>
可用MB：这衡量可用于在计算机上运行进程的内存量。
Pages/sec：这将显示每秒的硬故障数量。硬错误是需要访问磁盘的页面错误。</p><p>物理磁盘</p><p>以下性能计数器对于排除物理磁盘约束故障非常有用，可在PhysicalDisk部分下找到：</p><p>
%Disk Time：这测量由于磁盘正在为读或写请求提供服务而处于繁忙状态的时间量。
*当前磁盘队列长度：这将显示正在等待处理的未完成磁盘请求的数量。</p><p>逻辑磁盘</p><p>以下性能计数器对于排除逻辑磁盘约束故障非常有用，可在LogicalDisk部分下找到：</p><p>
%可用空间：这将显示有多少可用磁盘空间。</p><p>网络接口</p><p>以下性能计数器对排除网络问题很有用，可在NetworkInterface部分下找到：</p><p>
字节总数/秒：它显示所有协议上从网络接口发送和接收的字节总数。</p><p>一旦您添加了所有计数器，您就可以实时查看所有数据。</p><img class="content_img" src="/image/05/05897b44fdd4c435a182249861d6e833.png" /><p>使Windows保持最新</p><p>我的“如果它没有损坏，就不要修复它”规则的一个例外是安装Windows更新。有两种方法可以更新Windows：</p><p>
使用互联网-当你购买一台新的Windows7PC时，它的配置方式是，如果你选择启用Windows更新，更新本身将在安装更新时从Microsoft服务器下载。</p><p>你可能会问，与之相对的是什么？答案是与使用Windows Server Update Services(WSUS)相反。</p><p>
WSUS-当您使用WSUS时，您有一个中央服务器，它可以下载整个公司的所有更新，包括所有Microsoft产品的更新，而不仅仅是Windows产品的更新。当您的客户端计算机需要安装更新时，它们都连接到WSUS服务器并使用您网络的本地带宽安装更新，而不是30，000台连接到Internet来下载相同文件的计算机。正如你可以想象的那样，这节省了大量的带宽，因为更新只下载一次。</p><p>更改您获取更新的位置</p><p>虽然设置WSUS服务器超出了考试目标的范围，但您当然需要知道如何设置Windows7客户端以使用WSUS服务器。通常，到您使用WSUS时，您将至少拥有10个客户端，因此最好通过GPO来完成。因此，继续按Win+R组合键以打开运行对话框，然后键入gpedit.msc并按Enter键。</p><p>注意：请记住，我们是在一个Windows 7客户端上设置GPO。通常，这是在中央服务器上完成的，并链接到包含组织中的计算机的OU，这样您就不必走遍每台计算机并告诉它们使用WSUS。</p><img class="content_img" src="/image/94/940208254305c8e9e44a2ad6601ec49c.png" /><p>然后向下钻取至：</p><img class="content_img" src="/image/79/79ceab2968243ba8aad4c508440c03fb.png" /><p>然后双击右侧的“指定Intranet Microsoft更新服务位置”设置。</p><img class="content_img" src="/image/78/78a91fcd7c638f9bb52b977f09d5342f.png" /><p>然后，您将需要启用策略并输入WSUS服务器的URI。</p><img class="content_img" src="/image/b4/b49cf72135a4f737cebb15eaa2b63763.png" /><p>非那样做不行。</p><p>更改Windows Update设置</p><p>注意：如果您使用的是WSUS，您可能会通过组策略编辑这些设置，而不是在每个客户端上编辑，如下所示。</p><p>打开“开始”菜单，然后单击“Windows Update”项。</p><img class="content_img" src="/image/72/727d7b9adcd6a34d69b0eb6dbc58bd96.png" /><p>在这里，您将在左侧看到更改设置链接。</p><img class="content_img" src="/image/40/4085f7c483a63ce104310ce630a7382d.png" /><p>从这个集中位置，您几乎可以更改Windows更新的各个方面。</p><img class="content_img" src="/image/1a/1a69f71dd2595056ba49cde4f62df3ba.png" /><p>需要注意的一点是，您可以使用下拉列表更改Windows Update行为。</p><img class="content_img" src="/image/a1/a18c60b99a951eb42c570cc61934df05.png" /><p>简略的 / 概括的 / 简易判罪的 / 简易的</p><p>这是一个很长的过程，所以这里有一个简短的总结：</p><p>
Windows事件查看器允许您查看包含有关PC上发生的事件的重要信息的日志文件。
资源监视器是任务管理器的更详细版本，允许我们查看有关您的计算机上当前正在发生的情况的详细信息。
可靠性监视器使您可以轻松识别降低PC可靠性的趋势。
Windows性能监视器允许您实时查看自定义性能信息，以及查看一段时间内跟踪的性能数据。
Windows更新允许您的PC使用最新的安全修补程序保持最新状态。虽然您可能会在非常小的企业中使用开箱即用的Windows Update配置，但WSUS和组策略是可行的。</p><p>家庭作业 / 准备工作 / 预先所做的研究 / 在家里做的工作</p><p>
了解并使用两台Windows 7虚拟机设置事件订阅。
了解如何使用数据收集器集通过性能监视器跟踪一段时间内的性能信息。</p><p>除了今天的家庭作业，你还应该阅读下面的帖子，熟悉可以用来提高电脑性能的小提示和小窍门。这些也是考试目标的一部分。</p><p>
请阅读Chris Hoffman关于Windows页面文件的精彩帖子。
了解如何使用ReadyBoost提高计算机性能。
了解如何使用msconfig禁用启动程序。
了解如何使用powerercfg评估计算机的能效。
阅读有关如何在Windows 7中切换电源计划的信息。</p><p>如果你有任何问题，可以发tweet给我@taabgibb，或者直接留言。</p><div class="item_info"><span class="item_key"><a href="/tag/事件/">事件</a></span><span class="item_key"><a href="/tag/日志/">日志</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/6878.html">使用事件查看器排除故障</a><li><a href="/story/4699.html">什么是Windows事件查看器，我如何使用它？</a><li><a href="/story/3418.html">使用免费工具从事件查看器中查找事件ID</a><li><a href="/story/3266.html">如何使用事件查看器查找PC的引导时间</a><li><a href="/story/2004.html">将活动添加到IE 8中的Windows Live日历</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>