<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何使用Visual Studio调试Windows Vista边栏小工具</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何使用Visual Studio调试Windows Vista边栏小工具</h2></div><div class="content"><p>我们的Vista Gadget崩溃和我的电子邮件充满抱怨的一个附带好处是，我学会了如何在Visual Studio中调试Vista Gadget，所以我正在与每个人分享财富。</p><p>对于本练习，您需要一份Visual Studio2005副本和一个损坏的Vista Gadget，但是如果您尝试一下，您可能可以调整它以使用不同的工具。</p><p>关键步骤：启用脚本调试</p><p>打开Internet Explorer的选项面板，找到高级选项卡，取消选中“禁用脚本调试”复选框。</p><img class="content_img" src="/image/a0/a0adcf340b17d529f709aabd1d828203.png" /><p>在完成调试之后，您可能想要将其关闭，因为在浏览时它可能会变得相当烦人。</p><p>打开您的小工具代码</p><p>安装小工具后，Windows将解压文件并将其复制到用户配置文件中的文件夹。我们需要找到该文件夹并打开组成小工具逻辑的javascript文件。</p><p>只需将以下内容粘贴到资源管理器地址栏：</p><img class="content_img" src="/image/40/406f3eab61d796089e40e5ef6170d261.png" /><p>您将看到安装到您的配置文件中的所有小工具的目录列表。在Visual Studio中打开主javascript文件。</p><p>附加到边栏进程</p><p>接下来，我们需要附加到您的小工具的特定侧栏进程。(在执行此步骤之前，请确保您的小工具正在运行)</p><p>转到Tools\Attach to Process或点击Ctrl+Alt+P打开对话框。</p><img class="content_img" src="/image/ce/ce35d761c3fe60cbe4f0af3c25a16192.png" /><p>现在，您应该查找一个名为“sidebar.exe”的进程，其标题设置为您的小工具的名称，然后单击“附加”按钮。</p><img class="content_img" src="/image/db/dbbb3dfb815686c0fcc1bd1d4f3dcaa0.png" /><img class="content_img" src="/image/db/db8c0f7f3feb5f04a68ba09323c1b18c.png" /><p>现在到了关键的一步…。单击以在白色区域…的左侧设置断点</p><img class="content_img" src="/image/12/12c8f02a4544666047db04c469f49826.png" /><p>如果一切顺利，您将立即进入一个名为x-gadget：/main.js的新文件，一旦命中断点，您的调试工具将立即激活。</p><img class="content_img" src="/image/4a/4a19f9ecc5abed2d46b50b1afdfd373a.png" /><p>请注意，您不能修改此文件，但可以使用“即时”窗口实时测试任何代码。</p><p>重要注释</p><p>
在调试每隔一段时间轮询的小工具时，明智的做法是将间隔设置得非常低，这样您就不必等待很长时间来触发它。
您可以在原始源文件中进行更改，但您必须关闭/重新打开小工具，然后重新附加到它。
如果您收到关于没有加载符号的错误，则说明您没有按照启用脚本调试的第一步进行操作。
您必须在监视框中手动输入要监视的变量的名称，但是您可以像真正的调试器一样单步执行小工具。</p><p>调试愉快！</p><div class="item_info"><span class="item_key"><a href="/tag/调试/">调试</a></span><span class="item_key"><a href="/tag/工具/">工具</a></span><span class="item_key"><a href="/tag/文件/">文件</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/4970.html">如何在Android上访问开发人员选项并启用USB调试</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>