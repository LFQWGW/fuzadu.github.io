<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>IT极客：使用SNMP(简单网络管理协议)监控网络设备</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>IT极客：使用SNMP(简单网络管理协议)监控网络设备</h2></div><div class="content"><img class="content_img" src="/image/de/de88289346c8bd46adfbb4113db78de6.jpg" /><p>您是否需要知道远程设备认为度量值是多少？HTG还解释了什么是简单网络管理协议(SNMP)，以及如何使用它来监控网络设备。</p><p>图片由Iistargazer提供</p><p>概述 / 综述</p><p>创建简单网络管理协议(SNMP)是为了提供一个通用协议基础，网络管理员可以预期他们的设备制造商将使用该协议基础来暴露产品的不同方面。此外，还可以使用SNMP远程访问CPU负载、路由表和网络流量统计等信息。您还可以使用SNMP在支持它的设备上设置配置，但这超出了本指南的范围。</p><p>从SNMP读入/读出是使用“Community”字符串完成的。作为管理员，您的工作是设置此字符串。下面是一些关于如何做到这一点的示例。</p><p>一旦连接到设备上，您需要使用OID来“拉”它以获取信息。不同的OID会给您不同的信息，在本指南中我们将重点关注网络流量的同时，鼓励您进一步探索这个世界。我们将在下面解释如何获取“神秘”的OID。</p><p>作者的作品漫无边际</p><p>早在我DD-WRT研究的最初几天，我就开始使用这种巧妙的方式来查看路由器的信息。现在，如果我没有呢？我只是觉得自己看不见。当用户抱怨网络速度时，能够浏览边界路由器所说的网络利用率，并迅速解决问题，这是多么有价值，我简直无法强调。</p><p>读取/绘制SNMP信息(OID)</p><p>为了即时满足，如何读取snmp配置信息放在了文章的第一位，因为大多数人不会反复需要配置部分，而不是…。</p><p>好了，您已经为SNMP配置了设备(如果没有，请参阅下面的一些示例如何操作)，但是您如何知道要读取哪些OID，以及您实际是如何做到这一点的呢？有许多商业软件和免费程序可以帮助实现这一确切目标。我们将把重点放在几个免费的OID上，您可以使用这些免费的OID来绘制图形或浏览整个OID名称空间。</p><p>《BandWith Monitor》来自美国太阳风(制图)</p><p>人们不能不遇到太阳风公司，因为它是该领域的主要网络参与者之一。我们不会深入到太阳风提供的过多的联网产品中，而是专注于一种名为“免费实时带宽监控器”的免费网络实用程序。</p><p>这个新的公用事业版本有两个明显的缺点：</p><p>
它的目的是显示网络带宽，因此不适合用于检索其他SNMP协议信息。
它也没有提供保存/打开配置文件的选项。</p><p>如果上述限制有问题，请继续阅读其他选项之一。</p><p>使用常规的“下一步”-&gt;“下一步”-&gt;“完成”程序下载并安装，然后打开程序。</p><p>您应该会看到如下所示的向导。填写目标设备的“IP”和“社区”信息，然后单击“下一步”。</p><img class="content_img" src="/image/33/33f1827f2310fcca04eb80c59638c1cd.png" /><p>该程序将为其界面“拉”该设备，并将它们显示在一个非常友好的、格式化的、彩色的和名称枚举的列表中。</p><img class="content_img" src="/image/82/820d91aa1b07d35595135c278c9eb062.png" /><p>选择您想要监控的接口(使用CTRL可以进行多选)，然后单击“下一步”。</p><img class="content_img" src="/image/dc/dc3f6bf0e93f30f0b2301d6352363c1c.png" /><p>在上面的示例中，我们选择了两个名为“DSL wan1”和“ATM wan2”的接口。您可以接受默认设置，然后点击“启动监视器”。</p><img class="content_img" src="/image/35/35b34d88d291eade3fb2eec4ede8aec0.png" /><p>上面的图形窗口应该会打开，并开始以5秒(可配置)的刷新间隔显示交通信息。</p><p>关于刷新间隔的注意：这个程序真正的优势在于，在我遇到的所有程序中，这是唯一一个可以告诉你刷新间隔是否太短的程序。*在过去的一周里，我从调试SNMP读数的问题中获得了非常独特的“乐趣”，因为似乎有些设备不能(或者根本不会)更新他们的数据统计数据超过X次/秒(对于Juniper设备是7次/秒)。这个程序是唯一一个告诉我刷新间隔太快的程序，这解释了为什么我得到的结果不稳定。</p><p>除非您仍然需要在目标设备上启用SNMP(见下文)，否则就完成了。
欢欣鼓舞，踏上你快乐的旅途：)</p><p>来自Plixer的“Flowalyzer”(制图)</p><p>这款免费的公用事业叫做Flowalyzer，操作起来非常简单。看起来像是Plixer把大家熟知的STG应用工具包起来了(解释如下)，并把它包装成了更友好的东西。它还具有“从OID到名称列表的转换”等功能。与太阳风相比，这个实用程序的主要优势是可以以数字形式提取OID。</p><p>话虽如此，但它有两个非常严重的缺点：</p><p>
我发现这个程序不适合长时间的监控，因为它会莫名其妙地&随机地崩溃。
虽然它的最大优势是能够将其配置保存到文件中，然后通过将程序与后缀直接关联来调用它们，但它也对文件保存在哪里非常敏感。我发现如果保存文件的目录树包含“空格”，当试图调用它们时，程序会出错。</p><p>总而言之，使用此程序获取OID并“将它们提供给STG程序”和/或“让地狱走出道奇”。</p><p>当您打开该程序时，您将看到下面的窗口。</p><img class="content_img" src="/image/11/111af12c2e3437e4487e25b5a44a4045.png" /><p>单击“Select a R/W SNMP Credential”(选择读/写SNMP凭据)下拉列表，然后单击“Create/Edit”(创建/编辑)。</p><img class="content_img" src="/image/65/6592739c67e65f5cf1820e603ca43c59.png" /><p>填写您的目标设备所需的个人信息(主要是社区字符串)并保存。</p><img class="content_img" src="/image/d6/d69f6f41e7e54c5ff10f15a04c953d4f.png" /><p>填写目标设备的IP，然后单击“Get”(获取)。</p><img class="content_img" src="/image/61/61191ba1ecace6852da570b4a542cf37.png" /><p>一旦您这样做了，程序窗口的下半部分应该会填充从设备中提取的所有信息，如下图所示。</p><img class="content_img" src="/image/e4/e4395ff0fc1afb96d0a3b3e38cbec57c.png" /><p>单击其中一行应该会弹出如下所示的监视器窗口。</p><img class="content_img" src="/image/b1/b1f0a757ea0372117e88e79133d918f8.png" /><p>要获取OID追捧已久的内容，请点击“查看”-&gt;“设置”。</p><img class="content_img" src="/image/21/212499553eb91e67e9f4ea51551c752e.png" /><p>在下一个窗口中，可以看到传入/传出流量的OID。</p><img class="content_img" src="/image/23/23944d73cc80792814bd7fc98d92aa68.png" /><p>你拿到OID了，耶！</p><p>Leonid Mikhailov提供的简单流量监控器(STG)(制图)</p><p>这个免费的实用程序是到目前为止最古老的选项，但它可以完美地工作几年，并且可以将其配置保存在可共享的文件中。唯一的缺点是您需要通过其他方式获取OID。</p><p>请从我们或作者处下载程序(以避免热链接)。</p><p>将zip文件解压缩到您选择的位置，然后运行它。您将看到一个空白窗口。</p><img class="content_img" src="/image/b7/b778e09b8e01da7bd2e987eba5b93bd7.png" /><p>点击“查看”-&gt;“设置”。</p><img class="content_img" src="/image/af/afb6f0b3a31717f630024639695060d8.png" /><p>在下一个窗口中，您需要输入从其他方法获得的OID(在本指南中至少有两个)。</p><img class="content_img" src="/image/0b/0b7ec91d34e95371303ad3583d653569.png" /><p>如果一切顺利，主窗口应该会填满所有信息，如下图所示。</p><img class="content_img" src="/image/a7/a7a2abbb3cb53b7ad4a1effe5f312e91.png" /><p>由SNMP4tPC提供的GetIF(浏览OID树)</p><p>这个程序很旧，虽然有新的选择，但由于它是免费的，它完成了工作，也是让我开始的那个，尊重我对它的要求。</p><p>使用这个程序或类似的程序将使你能够提取更多的信息，而不仅仅是设备的界面信息。话虽如此，我们将使用接口的示例来使后续内容更具可读性。</p><p>下载程序可以从我们这里下载(避免热链接)，也可以向作者下载。</p><p>使用常规的“下一步”-&gt;“下一步”-&gt;“完成”程序进行安装，然后打开程序。</p><img class="content_img" src="/image/58/58af2674a814a2b07a49f5fdf83c7682.png" /><p>填写目标设备的详细信息表格，然后点击“Start”(开始)。</p><img class="content_img" src="/image/b6/b612f174a40bceb4f6ad64fd99da9d54.png" /><p>要遍历OID树，请转到“MBrowser”选项卡。</p><img class="content_img" src="/image/25/25b4ce49dbef81a54415c87349cffa08.png" /><p>一旦你看到一个你想要阅读的片段，选择它并点击“开始”。</p><p>例如，要获取我们使用上述程序获得的相同“interface”信息，请浏览至：iiso-&gt;org-&gt;dod-&gt;internet-&gt;mgmt-&gt;mib-2-&gt;interface-&gt;ifTable-&gt;ifEntry-&gt;ifDescr，然后单击“Start”。</p><img class="content_img" src="/image/6e/6e57030407c8494afe24de7ad81e495b.png" /><p>窗口的下半部分现在显示了为目标设备上的接口指定的“名称”。要获得“流量OID”，请记下接口号(在我们的示例中，wan2=interface7)，然后继续到“ifInOctets”和“ifOutOctets”子树。</p><p>它们位于：iiso-&gt;org-&gt;dod-&gt;internet-&gt;mgmt.mib-2接口-&gt;iifTable-&gt;iifEntry-&gt;iifInOctets。</p><img class="content_img" src="/image/be/be0e5fe597a6addd6c5c7db1e73a8047.png" /><p>单击要监控其通信量的接口，并记下窗口左下角的OID。</p><p>现在，您可以将收集的OID带到上面的某个监控程序。</p><p>在目标设备上启用SNMP</p><p>几乎每一个可以联网的自尊设备都支持以这种方式暴露自己的个人信息。也就是说，并不是每台设备都这样做，您可能需要参考设备的文档来找出如何做到这一点。以下是我身边的一些例子，但这绝不是一个详尽的清单。</p><p>关于DD-WRT</p><p>在WebGUI中，转到“服务”并向下滚动页面以找到“SNMP”单选按钮。</p><p>选择“Enabled”(启用)单选按钮并保存配置。</p><img class="content_img" src="/image/7a/7ac7245ae1361dae8986ae0d1d7382de.png" /><p>启用后，您将看到您可以更改的详细信息。重要的是，您要注意您使用的是哪个“RO社区”。默认值为“public”，但您可以根据需要将其更改为任何其他值。保存并应用更改。</p><p>论Fortigate(FortiOS)</p><p>假设FortiOS是相当新的版本(v4和更高版本)，在主窗口中展开“Config”窗格并选择“SNMP”。</p><img class="content_img" src="/image/9b/9bdff78dbcfa014460dff2bba7c48f50.png" /><p>注意：上面的屏幕截图取自v5FortiOS。</p><p>要创建新的“SNMP v1/v2c”社区，请单击“新建”。</p><img class="content_img" src="/image/d8/d8d66ff4d78182a58c722b101338af65.png" /><p>填写“社区名称”、允许访问的IP范围、从什么“接口”访问等重要信息，即“社区名称”、“社区名称”等信息。完成后，单击页面底部的“确定”保存您的设置。</p><p>您还需要为SNMP流量启用您想要从中读取信息的接口。为此，请进入“配置”-&gt;“网络”。</p><img class="content_img" src="/image/89/89a6ce362da7d002f7cf79e4a5965dc5.png" /><p>在本例中，我们使用了“port8”，因此我们将编辑该接口。</p><img class="content_img" src="/image/eb/ebf9550adf99ddb2ea07e815b76d649e.png" /><p>选中“SNMP”复选框，然后点击页面底部的“OK”。</p><p>注意：如果您的设备上启用了VDOM，则您尝试从中读取SNMP的界面必须在“management_vdom”中。更改Vdom的管理不在本指南的讨论范围内。</p><p>关于Juniper(Junos)</p><p>在WebGUI中，进入“配置”-&gt;“服务”-&gt;“SNMP”。</p><img class="content_img" src="/image/7b/7ba6e0c6063afab4f66baf6b48feeb11.png" /><p>点击“添加”。</p><p>填写您选择的“社区名称”，然后选择“授权”类型。</p><img class="content_img" src="/image/fb/fb39cd3783b24926bac39b2229e69767.png" /><p>保存并提交更改以使其生效。</p><p>在NetApp上</p><p>打开“NetApp OnCommand System Manager”并登录到您的存储设备。在“配置”-&gt;“系统工具”下，单击“SNMP”，然后单击“编辑”。</p><img class="content_img" src="/image/d2/d20dad852c914d40bb469e43281e5c52.png" /><p>单击“添加”。</p><img class="content_img" src="/image/e5/e57ce7fba61e1924a22e40ea3a10d9ae.png" /><p>这将使您能够添加一个新的“Community”字符串，如下所示。</p><img class="content_img" src="/image/b3/b300224e59e31022406d78c1ac573f9f.png" /><p>填写所需的名称，然后一直单击“确定”。</p><p>论Windows</p><p>在Windows上激活snmp是可能的，只是很少使用，甚至很少被谈论(看着你，MS认证…)。。您需要先安装该服务。</p><p>转到“程序和功能”安装该服务。</p><img class="content_img" src="/image/6c/6cf973bab798fb47aee3145464fb1020.png" /><p>进入“打开或关闭Windows功能”。</p><img class="content_img" src="/image/15/15ced5a66acd8112aef360f34b50422a.png" /><p>滚动查找“简单网络管理协议(SNMP)”。选中其复选框，然后单击“确定”进行安装。</p><img class="content_img" src="/image/82/823e0c162cf1a6d26fe2b20cca74faf2.png" /><p>安装后，通过打开“Services”配置社区字符串。</p><img class="content_img" src="/image/18/18f4782013cb5f53e6cbfedeac5fc672.png" /><p>滚动查找该服务并进入其属性。</p><img class="content_img" src="/image/02/02573be5ec8d3c2803a33b77c24d1bdd.png" /><p>转到“安全”选项卡。</p><img class="content_img" src="/image/39/3979834264a4568f095f285be5b2f429.png" /><p>要添加社区，请单击“添加”。</p><img class="content_img" src="/image/d3/d30e1361b5797f5f471f3dd4caf516b4.png" /><p>填写所需的社区名称，然后单击“添加”和“确定”以使设置生效。</p><p>注意：您可能需要更改其他属性才能使远程计算机获得读数，但这远远超出了本指南的范围。</p><p>到此为止，您应该已经做好了绘制网络信息图表的准备，并且鼓励您探索SNMP协议可以为您提供哪些超出本指南范围的功能，例如：使用MIB和陷阱。只要记住下面…中的引语总结就行了</p><p>我们都是我们眼泪的总和。太少了，土地就不肥沃，那里什么也长不出来。太多了，我们最好的都被冲走了。(巴比伦5g‘kar)</p><div class="item_info"><span class="item_key"><a href="/tag/snmp/">snmp</a></span><span class="item_key"><a href="/tag/程序/">程序</a></span><span class="item_key"><a href="/tag/oid/">oid</a></span></div></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>