<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何从Linux终端查看可用磁盘空间和磁盘使用情况</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何从Linux终端查看可用磁盘空间和磁盘使用情况</h2></div><div class="content"><p>df和du命令从Linux、MacOS和许多其他类Unix操作系统上使用的Bash shell报告磁盘空间使用情况。通过这些命令，您可以轻松识别哪些内容正在耗尽您的系统存储空间。</p><p>查看总磁盘空间、可用磁盘空间和已用磁盘空间</p><p>bash包含两个与磁盘空间相关的有用命令。要找出可用的和已使用的磁盘空间，请使用df(磁盘文件系统，有时称为磁盘空闲)。要找出占用已用磁盘空间的原因，可以使用du(磁盘使用率)。</p><p>在Bash终端窗口中键入df并按Enter开始。您将看到许多类似于下面的屏幕截图的输出。使用不带任何选项的ndf将显示所有已挂载文件系统的可用空间和已用空间。乍一看，它可能看起来难以理解，但它相当容易理解。</p><code>df</code><img class="content_img" src="/image/6b/6b63b9d6a50847cefe0620b031fbb042.png" /><p>显示器的每一行由六列组成。</p><p>
FileSystem：指定此文件系统的名称。
1K块：此文件系统上可用的1K块的数量。
已用：显示此文件系统上已使用的1K块的数量。
可用：表示此文件系统上未使用的1K块的数量。
Use%：n此文件系统中使用的空间量以百分比形式给出。
file：输入文件系统名称(如果在命令行中指定)。
已装载在：位于文件系统的装载点。</p><p>您可以使用-B(块大小)选项将1K块计数替换为更有用的输出。要使用此选项，请键入DF、空格，然后键入-B，然后键入K、M、G、T、P、E、Z或Y列表中的字母。这些字母表示1024刻度的倍数中的千、兆、吉、太、Peta、exa、Zeta和Yotta值。</p><p>例如，要查看以MB为单位的磁盘使用情况数字，可以使用以下命令。请注意，B和M之间没有空格。</p><code>df -BM</code><img class="content_img" src="/image/a7/a749cd7d7367b91670dad9d96cf2880f.png" /><p>h(人类可读)选项指示df为每个文件系统的大小使用最适用的单位。在下一个输出中，请注意有千兆字节、兆字节甚至千字节大小的文件系统。</p><code>df -h</code><img class="content_img" src="/image/20/20773221df64201255577bdc270e0d7f.png" /><p>如果需要查看以信息节点数量表示的信息，请使用-i(信息节点)选项。inode是Linux文件系统用来描述文件和存储有关它们的元数据的数据结构。在Linux上，inode保存每个文件和目录的名称、修改日期、硬盘位置等数据。这对大多数人来说没有什么用处，但是系统管理员有时必须参考这类信息。</p><code>df -i</code><img class="content_img" src="/image/52/523587ab6a239fb33c584a886c8dcba4.png" /><p>除非被告知不要这样做，否则df将提供有关所有已挂载文件系统的信息。这可能会导致具有大量输出的杂乱显示。例如，列表中的/dev/loop条目是伪文件系统，允许将文件挂载为分区。如果你使用新的Ubuntu snap安装应用程序的方法，你可以获得很多这样的东西。它们上的可用空间将始终为0，因为它们不是真正的文件系统，所以我们不需要看到它们。</p><p>我们可以告诉df排除特定类型的文件系统。为此，我们需要知道希望排除哪种类型的文件系统。T(打印类型)选项将为我们提供该信息。它指示df在输出中包括文件系统的类型。</p><code>df -T</code><img class="content_img" src="/image/c1/c1fc02ad498b96ddf3e9985c753584c9.png" /><p>/dev/loop条目都是squashfs文件系统。我们可以使用以下命令排除它们：</p><code>df -x squashfs</code><img class="content_img" src="/image/b0/b0b3f165881baf7cee6e3fb9e5b617a8.png" /><p>这给了我们一个更容易管理的产出。要获得总数，我们可以添加--total选项。</p><code>df -x squashfs --total</code><img class="content_img" src="/image/99/99612d7dfc3b78f7e4bf4a115dd1e324.png" /><p>通过使用-t(Type)选项，我们可以要求df只包含特定类型的文件系统。</p><code>df -t ext4</code><img class="content_img" src="/image/c5/c5170a9cb17c6859bbffa5baa43c53ac.png" /><p>如果我们想要查看一组文件系统的大小，可以按名称指定它们。Linux中的驱动器名称是按字母顺序排列的。第一个驱动器名为/dev/sda，第二个驱动器名为/dev/sdb，依此类推。分区是有编号的。因此，/dev/sda1是驱动器/dev/sda上的第一个分区。我们告诉df通过将文件系统的名称作为命令参数传递来返回特定文件系统的信息。让我们看看第一个硬盘驱动器的第一个分区。</p><code>df /dev/sda1</code><img class="content_img" src="/image/df/dfb4f16d501ce06812e85c139dce68d5.png" /><p>请注意，您可以在文件系统名称中使用通配符，其中*表示任意字符集，而？表示任何单个字符。因此，要查看第一个驱动器上的所有分区，我们可以使用：</p><code>df /dev/sda*</code><p>我们可以要求df报告一组命名的文件系统。我们正在请求/dev和/run文件系统的大小，我们想要一个总数。</p><code>df -h --total /dev /run</code><img class="content_img" src="/image/c5/c599eefcaf171c093eb0829cad84bf61.png" /><p>为了进一步自定义显示，我们可以告诉DF要包括哪些列。为此，请使用--output选项并提供所需列名的逗号分隔列表。请确保逗号分隔列表中不包含任何空格。</p><p>
来源：输入文件系统的名称。
fstype：指定文件系统的类型。
iTotal：以inode为单位表示文件系统的大小。
ised：以inode为单位表示文件系统上使用的空间。
iavail：以inode为单位分配文件系统上的可用空间。
ipcent：以信息节点为单位计算文件系统上已用空间的百分比，以百分比表示。
大小：文件系统的大小，默认以1K块为单位。
已用：表示文件系统上使用的空间，默认情况下以1K块为单位。
可用性：释放文件系统上的可用空间，默认情况下以1K块为单位。
pcent：以inode为单位表示文件系统上已用空间的百分比，默认情况下以1K块为单位。
file：输入文件系统名称(如果在命令行中指定)。
目标：指定文件系统的挂载点。</p><p>让我们让df用人类可读的数字报告第一个驱动器上的第一个分区，并使用source、fstype、size、useed、avail和pcent列：</p><code>df -h /dev/sda1 --output=source,fstype,size,used,avail,pcent</code><img class="content_img" src="/image/1a/1a7b7b7a517505fd730918423ff8e8e5.png" /><p>长命令非常适合被转换为别名。我们可以通过键入以下命令并按Enter键来创建别名DFC(用于DF自定义)：</p><code>alias dfc="df -h /dev/sda1 --output=source,fstype,size,used,avail,pcent"</code><img class="content_img" src="/image/50/50797541f1ba4c5efda3ed3fe3b2ab3a.png" /><p>键入dfc并按Enter键与键入长命令具有相同的效果。要使此别名成为永久别名，请将其添加到您的.bashrc文件或.bash_aliasesfile中。</p><p>我们一直在寻找改进df输出的方法，以使其显示的信息符合您的要求。如果您想采取相反的方法，让df返回所有可能的信息，可以使用-a(All)选项和--output选项，如下所示。-a(All)选项要求df包括每个文件系统，使用--output选项而不使用逗号分隔的列列表会导致df包括每一列。</p><code>df -a --output</code><img class="content_img" src="/image/27/27f66f55aca7738a6ce46560e99417ff.png" /><p>通过Less命令通过管道传输来自df的输出是查看此命令可能产生的大量输出的一种便捷方式。</p><code>df -a --output | less</code><p>找出占用已用磁盘空间的原因</p><p>让我们做一些调查，找出这台电脑上有什么东西在占用空间。我们将从我们的一个df命令开始。</p><code>df -h -t ext4</code><img class="content_img" src="/image/84/841146236c475a0e493f0d8288c95caf.png" /><p>第一个硬盘驱动器的第一个分区上使用了78%的磁盘空间。我们可以使用du命令来显示哪些文件夹保存的数据最多。发出不带任何选项的du命令将显示发出du命令的目录下的所有目录和子目录的列表。如果您从主文件夹执行此操作，则列表将非常长。</p><code>du</code><img class="content_img" src="/image/1f/1fcdf0c861ff1b65c323d0c3d0d01049.png" /><p>输出格式非常简单。每行显示一个目录的大小和名称。默认情况下，大小以1K块为单位显示。要强制du使用不同的块大小，请使用-B(块大小)选项。要使用此选项，请键入du、空格，然后键入-B，然后键入K、GM、G、T、P、EZ和Y列表中的一个字母，就像我们上面对df所做的那样。要使用1M块，请使用以下命令：</p><code>du -BM</code><img class="content_img" src="/image/26/26533d55f5febca5ec7064c5fa9c5b54.png" /><p>就像df一样，du有一个人类可读的选项-h，它根据每个目录的大小使用一系列块大小。</p><code>du -h</code><img class="content_img" src="/image/d3/d38a69d85357258f529c8464e055340b.png" /><p>s(汇总)选项提供每个目录的总数，而不显示每个目录中的子目录。以下命令要求du以人类可读数字的摘要格式返回当前工作目录下所有目录(*)的信息。</p><code>du -h -s *</code><img class="content_img" src="/image/a7/a759dca3bf68c34082df9b50f49b5e32.png" /><p>到目前为止，“图片”文件夹保存的数据最多。我们可以要求杜按大小从大到小对文件夹进行排序。</p><code>du -sm Pictures/* | sort -nr</code><img class="content_img" src="/image/92/9238c7731301c7a168d7795e5a5292fb.png" /><p>通过细化df和du返回的信息，很容易找出有多少硬盘空间在使用，并发现是什么占用了这些空间。然后，您可以明智地决定是否将某些数据移动到其他存储、向计算机添加另一个硬盘或删除冗余数据。</p><p>这些命令有很多选项。我们在这里描述了最有用的选项，但是您可以在Linux手册页中看到df命令和du命令的完整选项列表。</p><div class="item_info"><span class="item_key"><a href="/tag/文件系统/">文件系统</a></span><span class="item_key"><a href="/tag/df/">df</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14199.html">如何在Linux上使用mkfs命令</a><li><a href="/story/13549.html">如何在Linux上将ext2或ext3文件系统迁移到ext4</a><li><a href="/story/13374.html">如何从Linux终端挂载和卸载存储设备</a><li><a href="/story/7311.html">什么是文件系统？为什么会有这么多文件系统？</a><li><a href="/story/6446.html">NTFS或FAT32：为内部SSD数据分区选择最佳文件系统</a><li><a href="/story/5079.html">文件系统只是一堆文件夹吗？(说明文件系统)</a><li><a href="/story/4375.html">为什么Linux不需要碎片整理</a><li><a href="/story/3285.html">我应该为我的USB驱动器使用什么文件系统？</a><li><a href="/story/2612.html">什么是Linux fstab文件，它是如何工作的？</a><li><a href="/story/2519.html">您应该使用哪个Linux文件系统？</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>