<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>极客学校：在PowerShell中使用集合</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>极客学校：在PowerShell中使用集合</h2></div><div class="content"><img class="content_img" src="/image/20/207ea41ab315096bfcdb3ed62317373a.png" /><p>由于PowerShell基于.Net Framework，并结合了各种其他技术(如WMI和CIM)，因此总是有多种方法来完成相同的任务。请加入我们这篇简短的帖子，在这里我们将学习如何选择最佳方法来完成我们的任务。</p><p>请务必阅读本系列的前几篇文章：</p><p>
了解如何使用PowerShell自动化Windows。
学习在PowerShell中使用Cmdlet。
了解如何在PowerShell中使用对象。
在PowerShell中学习格式化、筛选和比较。
学习在PowerShell中使用远程处理。
使用PowerShell获取计算机信息</p><p>在接下来的一周里，我们将继续关注这一系列的节目。</p><p>使用批处理Cmdlet</p><p>在本系列的前面部分，当我们向您介绍管道时，我们向您展示了如何获取一个cmdlet输出的对象，并使用类似以下内容将它们作为输入传递给另一个cmdlet：</p><p>这将杀死名称为“记事本”的任何进程。但是您可能想知道PowerShell如何能够用一条命令杀死每个记事本实例。答案就在Stop-Process cmdlet的帮助下。</p><img class="content_img" src="/image/e5/e5f66569576fec1a67da3c403a51c973.png" /><p>如果您查看语法部分的最后一行代码，您可以看到InputObject参数接受Process[]类型的对象，并且每当您看到后面跟着两个类似的方括号的类型时，就意味着该参数接受前面的一个或多个类型。在这种情况下，它接受一个或多个进程对象。从技术上讲，我们可以说InputObject cmdlet接受进程数组。只要有以这种方式支持批处理操作的cmdlet，就可以使用它。这是第一个选择。</p><p>使用WMI</p><p>尽管WMI不是微软总部推出的最好的技术，但在如何使用对象集合的列表中，它确实排在第二位。我们可以很容易地从Win32_Process类中获得正在运行的进程列表，如下所示：</p><img class="content_img" src="/image/7a/7a3aab1af86027237302823c8cbd7ec4.png" /><p>由于WMI查询返回其自身类型的对象，因此您需要寻找可以停止该过程的方法，因此让我们通过管道将其传递给get-ember。</p><img class="content_img" src="/image/16/16db8e8ca8fcef2c465561f11c591dd3.png" /><p>看起来最近要停止的是Terminate方法，所以肯定就是它了。要调用WMI对象上的方法，只需通过管道将其传递给Invoke-WmiMethod并指定该方法的名称。</p><img class="content_img" src="/image/8e/8eadf73dece2502ec792b22773d1de9b.png" /><p>太好了，这招奏效了。每当您在WMI中获得ReturnValue为0时，只要记住该命令已成功执行即可。</p><p>列举 / 数数</p><p>如果不使用其他两种方法，如果您必须对一组对象执行某些操作，则可以枚举整个对象并对每个单独的对象执行操作。首先，您必须找到用于停止单个进程的方法。</p><img class="content_img" src="/image/8d/8d1b2e2e5bbe35f21c102a63163365b5.png" /><p>很好，看起来我们可以使用Kill方法，然后通过管道进入ForEach-Object将它们全部杀死。</p><img class="content_img" src="/image/e7/e7d8cdf158ea387d89adc60ba3605971.png" /><p>在这里，我们获取get-process返回的所有进程对象，并将它们传递给ForEach-Object cmdlet。与WHERE-Object cmdlet非常相似，我们用$_表示管道中的每个对象，我们可以在上面调用Kill()方法。说了这么多，做了这么多，枚举集合比上面的方法慢得多，应该只用作最后的结果。</p><p>简略的 / 概括的 / 简易判罪的 / 简易的</p><p>选择一</p><p>选择二</p><p>选择三</p><p>各位，这次到此为止，下周再见，享受更多的PowerShell乐趣。</p><div class="item_info"><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/方法/">方法</a></span><span class="item_key"><a href="/tag/对象/">对象</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14706.html">如何在Linux上使用uniq命令</a><li><a href="/story/14624.html">解释的Linux文件时间戳：atime、mtime和ctime</a><li><a href="/story/14585.html">如何在Microsoft Excel中兑换货币</a><li><a href="/story/14577.html">如何检查Linux上安装了哪个GPU</a><li><a href="/story/14572.html">如何使用Jouralctl读取Linux系统日志</a><li><a href="/story/14570.html">如何在Linux上使用grep命令</a><li><a href="/story/14555.html">2020年CES最佳：我们今年看到的所有最好的东西</a><li><a href="/story/14550.html">如何在Linux上使用Tail命令</a><li><a href="/story/14542.html">如何从MacOS Catalina向iPhone添加自定义铃声</a><li><a href="/story/14508.html">如何使用键盘快捷键简化流媒体Netflix</a><li><a href="/story/14507.html">如何在Linux上使用HISTORY命令</a><li><a href="/story/14499.html">如何在Linux上使用免费命令</a><li><a href="/story/14467.html">如何在Windows 10上切换到本地用户帐户</a><li><a href="/story/14466.html">如何在Linux上使用at和Batch来调度命令</a><li><a href="/story/14461.html">如何设置您的新Mac</a><li><a href="/story/14450.html">如何在Excel中将一长列变为多列</a><li><a href="/story/14438.html">如何在iPhone上创建和使用Memoji和Animoji</a><li><a href="/story/14434.html">Chrome 79的新特性，现已推出</a><li><a href="/story/14426.html">如何使用Google Sheets中的查询功能</a><li><a href="/story/14424.html">如何向Outlook会议请求添加默认签名</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>