<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何将Windows服务器的DNS记录导出到网页</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何将Windows服务器的DNS记录导出到网页</h2></div><div class="content"><p>如果您运行的Windows服务器利用了内置的DNS服务器，那么您将拥有一个很好的图形界面来查看和管理您的DNS记录。然而，在绝大多数情况下，您可能只是查看这些记录，而不是更新它们。此过程并不困难，但可能会带来麻烦，因为您必须通过远程桌面连接到DNS服务器计算机，打开DNS控件并找到记录。如果你可以简单地在网上看到这些信息，不是更容易吗？</p><p>为了实现这一功能，我们有一个非常简单的脚本，它可以将您当前的DNS服务器记录导出到文本文件，并通过一个简单的索引HTML文件使其可用，该文件可以从任何具有Web浏览器的设备访问。</p><p>配置 / 构造 / 布局 / 外形</p><p>总体而言，脚本的配置选项非常简单。您只需配置希望目标文件结束的输出位置。此文件夹将填充“default.htm”和“[domain].dns.zone.txt”文件。可以根据需要在脚本中自定义这些名称。</p><p>该脚本假定您已使用Windows DNS服务器使用的默认命名约定([domain].dns)命名DNS文件。如果您没有使用默认命名约定，脚本将无法正常工作。</p><p>作为一项附加功能，该脚本可以删除DNS服务器中不再活动的未使用的DNS记录文件。如果启用(默认情况下关闭)，当DNS记录文件的导出过程失败(意味着在DNS服务器中找不到该域)时，它将被删除。这些未链接的DNS记录文件不会造成任何危害，也不会消耗任何资源，因此可以放心地保留它们。</p><p>如果您经常更新DNS记录，则可以将脚本配置为在计划任务中定期运行，这样您就知道您正在查看的信息始终是最新的。该脚本的输出是只读的，因此对结果文件所做的任何更改都不会反映在您的DNS服务器中。</p><p>它是如何工作的</p><p>该脚本只需从默认的Windows位置读取当前的DNS文件，然后与DNSCmd命令行工具交互以生成输出文件。DNSCmd工具包含在Server 2008中，但Server2003计算机必须安装资源工具包工具才能将此实用程序放到您的系统中。</p><img class="content_img" src="/image/85/85da0f3ffef25531dbebc0fa238cc241.png" /><p>‘[domain].dns.zone.txt’是ZoneExport命令产生的输出。</p><img class="content_img" src="/image/0f/0f4ebd2effe49094fe1f7071f4adfaaa.png" /><p>您可以通过在浏览器中查看输出‘default.htm’文件来访问该列表。如果已将脚本配置为导出到公共可用的位置，则可以从任何位置查看输出。</p><img class="content_img" src="/image/66/66b114886c3e9788fc3ebf7e55587277.png" /><p>通过单击域，您可以看到来自DNS服务器的该域的所有DNS信息。</p><img class="content_img" src="/image/5c/5c4404b43bcbc2779b197bc66a945a89.png" /><p>剧本</p><p></p><p>@ECHO OFFTITLE DNS转储到HTMLECHO DNS转储到HTMLECHO作者：Jason FaulknerECHO SysadminGeek.comECHO.ECHO。</p><p>设置启用延迟扩展</p><p>生成HTML页面的REM目录。SET OutPath=C：inetpubwwwrootdnsSET HTMLPage=default.htm</p><p>REM HTML页面标题/Header.SET Title=DNS记录</p><p>REM删除DNS服务器中当前未加载的DNS记录文件(1=是，0=否)设置DeleteNotFound=0</p><p>DEL/Q“%OutPath%*”设置OutFile=“%OutPath%%HTMLPage%”</p><p>REM HTML标题信息。根据需要进行自定义。ECHO^%OutFile%ECH^&gt;%OutFile%ECH^&gt;%OutFile%ECH^%Title%^&gt;%OutFile%ECH^&lt;/Head^&gt;&gt;%OutFile%ECH^%%OutFile%ECH^&lt;H1^&gt;%Title%^&lt;H1^&gt;&gt;%OutFile%ECH^&lt;/H3^&gt;计算机名称：%ComputerName%^&lt;/H3^&gt;</p><p>设置DNSDir=%WinDir%system32dnsFOR/F%%A IN(‘DIR/A：-D/B/L%DNSDir%*.dns’)Do(设置区域=%%A，然后设置区域=！zone：.dns=！设置ZoneFile=！zone！.dns.zone.txt)和回声导出：！zone！**DNSCmd。/ZoneExport！zone！！ZoneFile！如果不存在%DNSDir%！ZoneFile！，则返回%DNSDir%！ZoneFile！(.zoneExport！zone！ZoneFile！)。当前未加载到DNS服务器中。如果{%DeleteNotFound%}=={1}DEL/F/Q%DNSDir%%A*)ELSE(%DNSDir%A)ELSE(%DNSDIR%A)，则说明当前未加载到DNS服务器中。因此，请将该文件移到！zone！^&lt;/A^&gt;^&lt;BR/^&gt;&gt;%OutFile%OUTFILE%1中，因为REM输出始终位于DNS目录中，因此请将该文件移动到</p><p>ECHO^&lt;BR/^&gt;&gt;%OutFile%ECHO^&lt;/BODY^&gt;&gt;%OutFile%ECHO^&lt;/HTML^&gt;&gt;%OutFile%</p><p>ENDLOCAL</p><div class="item_info"><span class="item_key"><a href="/tag/dns/">dns</a></span><span class="item_key"><a href="/tag/文件/">文件</a></span><span class="item_key"><a href="/tag/脚本/">脚本</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/11235.html">什么是拒绝服务攻击和DDoS攻击？</a><li><a href="/story/10458.html">如何更改iPhone或iPad上的DNS服务器</a><li><a href="/story/8901.html">如何检查您的路由器是否有恶意软件</a><li><a href="/story/7662.html">如何加密您的DNS以实现更安全的浏览</a><li><a href="/story/7582.html">如何在Windows中创建快捷方式来更改DNS服务器</a><li><a href="/story/7416.html">如何清除Windows上的Google Chrome DNS缓存</a><li><a href="/story/6517.html">如何在MacOS上重置DNS缓存</a><li><a href="/story/5865.html">更改DNS服务器的终极指南</a><li><a href="/story/5856.html">使用第三方DNS服务的7个原因</a><li><a href="/story/5732.html">如何切换到OpenDNS或Google DNS以加快Web浏览速度</a><li><a href="/story/5575.html">什么是DNS缓存中毒？</a><li><a href="/story/5572.html">DNSSEC将如何帮助保护互联网，以及SOPA如何几乎将其定为非法</a><li><a href="/story/4672.html">什么是DNS，我应该使用其他DNS服务器吗？</a><li><a href="/story/4474.html">如何在世界任何地方轻松观看Netflix和Hulu</a><li><a href="/story/4262.html">如何使用PowerShell更改您的IP地址</a><li><a href="/story/3216.html">如何通过DD-WRT使用DNS名称访问您的计算机</a><li><a href="/story/2626.html">如何使用OpenDNS或Google DNS设置您的Verizon FiOS路由器</a><li><a href="/story/2623.html">如何在Mac上使用OpenDNS或Google DNS</a><li><a href="/story/1907.html">使用Namebench查找速度更快的DNS服务器</a><li><a href="/story/1427.html">使用Google公共DNS加快您的Web浏览速度</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>