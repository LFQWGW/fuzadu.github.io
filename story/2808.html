<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>从命令行备份和还原SQL Server数据库</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>从命令行备份和还原SQL Server数据库</h2></div><div class="content"><p>SQL Server维护计划中最重要的部分是定期备份数据库。要备份数据库，不能简单地复制数据库各自的MDF和LDF文件，因为SQL Server锁定了这些文件。相反，您需要通过SQL Server创建真正的备份文件。</p><p>虽然这可以通过在SQL Management Studio中制定维护计划来实现，但SQL Server的免费速成版不提供此界面。要解决此问题，您可以在以Windows管理员身份登录时运行以下命令来轻松备份数据库：</p><p>下面的示例将有所帮助。</p><p>默认SQL Server实例：</p><p>命名的SQL Server实例：</p><p>上面创建了“MyDB”到文件“D：BackupsMyDB.bak”的完全可恢复的备份副本，可用于灾难恢复。当然，您可以将备份位置和文件更改为您需要的任何位置，但请确保您指定了本地计算机上存在的文件夹位置。然后可以将此备份文件复制到磁带机或其他外部备份位置。</p><p>常见问题是“能否将备份文件创建到映射驱动器或UNC位置？”快速的回答是否定的。原因是因为SQL Server Windows服务是以只有权访问本地计算机的用户帐户运行的。您可以更改运行服务的帐户，但出于安全原因，强烈建议您这样做。</p><p>从命令行还原数据库备份</p><p>要从备份文件恢复数据库，只需使用以下命令：</p><p>例如：</p><p>上述命令将从备份文件“D：BackupsMyDB.bak”中存储的数据恢复“MyDB”的备份。自创建备份文件以来对MyDB所做的任何更改都将丢失。</p><p>使用上述命令时需要记住的一件重要事情是，它应该在创建相应备份文件的同一SQL Server上使用。SQL备份文件存储“幕后”信息，这些信息控制备份文件中数据文件的复制位置和复制方式。如果要从其他SQL Server还原备份，则备份文件中的路径位置可能与要还原到的服务器不匹配，并将导致错误。虽然可以解决此问题，但使用SQL Management Studio工具恢复在另一个SQL Server上创建的备份要容易得多。</p><p>注意：以上命令适用于SQL 2005及更高版本(任何版本)。对于SQL 2000和更早版本，请将“SqlCmd”替换为“oSql”。</p><div class="item_info"><span class="item_key"><a href="/tag/备份文件/">备份文件</a></span><span class="item_key"><a href="/tag/sql/">sql</a></span><span class="item_key"><a href="/tag/位置/">位置</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/2838.html">管理过时备份文件的自动化策略</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>