<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何自动生成计算机统计数据并通过电子邮件发送</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何自动生成计算机统计数据并通过电子邮件发送</h2></div><div class="content"><img class="content_img" src="/image/e0/e05d3c6de37fe850b08bff94e90b289d.jpg" /><p>每天检查服务器上的各种日志数据和统计数据很重要，但这会变得单调乏味。如果每天都能收到一封包含所有亮点的电子邮件，这样你甚至不需要进入服务器来检查问题，那不是很好吗？本指南将向你展示如何在Linux和Windows上配置自动电子邮件。</p><p>我们将专门为Ubuntu和Windows 8.1介绍这一点，Gmail将用作发送邮件的电子邮件服务器。“如果您有其他版本的Linux或Windows，或者更喜欢使用其他电子邮件服务，这里的说明应该很容易修改。</p><p>Linux中的自动电子邮件</p><p>我们将使用两个不同的软件包ssmtp和mailutils来完成此任务，因此请使用以下命令安装这两个软件包：</p><p>安装后，我们需要对SSMTP配置文件进行一些更改：</p><p>使用这些更改编辑文件(如果您愿意，只需擦除文件中的所有文本并复制/粘贴这些设置是安全的)：</p><p>编辑完文件后，您需要更改权限，因为您的Gmail密码是以明文形式存储的。</p><p>让root成为文件的所有者总是更安全，但是这样我们就必须在脚本中使用sudo命令，它会提示我们输入密码，从而违背了自动化整个过程的目的。</p><p>如果您使用的是共享服务器，并且担心您的密码以明文形式存储，并且root用户可以读取，那么可以创建一个一次性的gmail帐户，或者首先使用不需要任何类型身份验证的电子邮件服务器。</p><p>为确保一切配置正确，让我们尝试一封测试电子邮件：</p><p>“测试”将在电子邮件的正文中，主题将是“测试邮件设置”。请检查您的电子邮件以确保您收到了它。</p><p>为电子邮件编写脚本</p><p>现在我们可以从命令行发送电子邮件了，现在让我们编写一个脚本，该脚本将向我们发送有关系统的一些基本信息。</p><p>显然，您可以对脚本进行更深入的处理，甚至可以将格式做得更好一些，但以下是我们的电子邮件中的输出：</p><img class="content_img" src="/image/9f/9f91cb937e223b1338366b8cb57736d8.jpg" /><p>现在脚本已经编写和测试完毕，我们可以使用cron自动在每天的同一时间执行它。在本例中，我们将电子邮件配置为每天凌晨2点发送，这样我们就可以在当天晚些时候查看数据。</p><p>对于凌晨2：00的电子邮件，请添加：</p><p>如果您需要关于这一部分的更多帮助，我们已经写了一整篇关于crontab文件的文章。</p><p>Windows中的自动电子邮件</p><p>通过PowerShell在命令行发送电子邮件是可能的，但我们发现使用第三方应用程序实现此功能要容易得多，尤其是使用Gmail时。SendEmail是一款适用于Windows的免费程序，可以轻松集成Windows Task Scheduler和Gmail。/单击上面的链接下载最新版本，并确保获取支持TLS的版本。</p><p>下载SendEmail后，解压zip文件并将其内容放在某个位置，只要您计划自动发送电子邮件，就可以将其存储到该位置。在本例中，我们将程序存储在C：\SendEmail中</p><p>让我们测试一下SendEmail以快速了解它的工作方式。*通过在“开始”或“运行”(Ctrl+R)菜单中键入cmd打开命令提示符。</p><img class="content_img" src="/image/02/02e3fddf1151da452e884a08e4053ae6.jpg" /><p>在命令提示符打开的情况下，使用change directory命令导航到存储SendEmail文件的位置。</p><p>现在，我们可以尝试使用以下命令发送测试电子邮件：</p><p>显然，在执行该命令之前，请将“用户名”和“密码”替换为您的帐户凭据。</p><p>下面是上面的命令实际执行的操作：</p><p>sendEmail执行该程序。</p><p>-f-发件人地址</p><p>-t-to地址</p><p>-s-SMTP服务器</p><p>-xu-帐户用户名</p><p>-XP-帐户密码</p><p>-u-电子邮件主题</p><p>-m-电子邮件正文文本</p><p>检查您的收件箱以确保您收到了测试电子邮件，然后我们可以继续编写将向我们发送服务器信息的脚本。</p><p>为电子邮件编写脚本</p><p>为了最大限度地利用我们的脚本，我们将为PowerShell编写该脚本。/通过在运行提示符(Ctrl+R)中键入powershell_ise.exe来打开Windows PowerShell ISE。</p><img class="content_img" src="/image/99/990a086d323f3efd3355c9e064ec9347.jpg" /><p>在PowerShell ISE窗口的右侧，您可以列出PowerShell能够执行的每个命令。*这应该会让您很好地开始生成需要报告的信息类型。*在脚本中，您还可以调用第三方程序输出信息(例如，SendEmail是第三方应用程序，但PowerShell和cmd可以使用它来完成它们通常无法完成的任务)。</p><img class="content_img" src="/image/81/8135ba4b26833045e0125d1691b874f2.jpg" /><p>对于我们的示例脚本，我们将检查C盘的当前磁盘使用情况，显示当前正在运行的进程，并显示当前通过网络共享的所有文件。</p><p>在此脚本中，各种信息输出到C：\SendEmail\info.txt，然后该文档中的文本在被删除之前通过电子邮件发送给我们。*使用PS1文件扩展名保存脚本(PowerShell文件)。</p><p>脚本完成后，从运行提示符运行一次快速测试，以确保其工作正常。</p><p>只需使用带有-file参数的powershell命令并指定脚本的路径即可。</p><img class="content_img" src="/image/11/113de2c26f0bd832753f8685fd99dd56.jpg" /><p>检查您的收件箱以确保您收到了电子邮件-如果没有，请检查您的脚本是否有语法错误。以下是从我们的示例脚本生成的电子邮件的外观：</p><img class="content_img" src="/image/22/22e7745de17f9ce20e7bd144aa0c6c40.jpg" /><p>您可以调整格式(如回显文本之间的空行)，使其在您的设备上显示得更好，或者更好的是，您可以使用第三方程序，该程序将以比Windows更易读的格式输出所需的信息(脚本编写过程仍然是一样的)。</p><p>一旦您解决了脚本中的问题，您就可以使用Windows任务计划程序将其自动化。请通过开始菜单打开Windows任务计划程序。</p><img class="content_img" src="/image/43/43dffff8e0bb23c6b2ca1e09ebefd386.jpg" /><p>打开任务调度器后，选择操作&gt;创建基本任务。</p><img class="content_img" src="/image/fb/fba9dc514563f25c7d278bfacd38242a.jpg" /><p>将此任务命名为类似于“每日电子邮件脚本”的名称，然后单击“下一步”。在下一个屏幕上，选择您希望电子邮件脚本运行的频率(可能是每天)。然后，选择您希望脚本运行的时间，然后单击“下一步”。</p><p>现在您应该在向导的“Action”部分，选择“Start a Program”并输入与我们先前在Run提示符中输入的文本相同的文本，以测试我们的脚本。</p><img class="content_img" src="/image/d9/d9595bb77ba968600bde2d4b61bd3c27.jpg" /><p>在此窗口中单击下一步，然后单击是：</p><img class="content_img" src="/image/09/0976f739ef1afe4ec9f6c2f5ba8d78f9.jpg" /><p>单击最后一个菜单上的“完成”，您就完成了自动电子邮件的计划。</p><div class="item_info"><span class="item_key"><a href="/tag/电子邮件/">电子邮件</a></span><span class="item_key"><a href="/tag/脚本/">脚本</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14432.html">如何在Outlook中的电子邮件上方显示快速操作按钮</a><li><a href="/story/14253.html">如何动态自定义您的Gmail地址</a><li><a href="/story/14158.html">如何在Outlook中读取邮件标题</a><li><a href="/story/14054.html">如何将电子邮件保存到硬盘</a><li><a href="/story/13941.html">如果您收到网络钓鱼电子邮件，应该怎么办？</a><li><a href="/story/13937.html">如何在Outlook联系人组中隐藏电子邮件地址</a><li><a href="/story/13909.html">如何将旧电子邮件帐户导入Gmail</a><li><a href="/story/13866.html">如何在Microsoft Outlook中设置POP3或IMAP帐户</a><li><a href="/story/13677.html">如何在Gmail中禁用动态电子邮件</a><li><a href="/story/13676.html">如何阻止超人(和其他应用程序)跟踪您打开的电子邮件</a><li><a href="/story/13663.html">为什么我会从自己的电子邮件地址收到垃圾邮件？</a><li><a href="/story/13651.html">使用Outlook Mail App滑动操作快速处理邮件</a><li><a href="/story/13409.html">整理电子邮件的最佳方式：将它们存档</a><li><a href="/story/13321.html">预览您的电子邮件安全吗？</a><li><a href="/story/13274.html">电子邮件轰炸如何使用垃圾邮件隐藏攻击</a><li><a href="/story/13214.html">忘掉收件箱零号：用俄亥俄州来对你的电子邮件进行分类</a><li><a href="/story/12721.html">如何配置iPhone和iPad的邮件设置</a><li><a href="/story/12391.html">如何在Outlook中为电子邮件添加过期日期(以及它们的用途)</a><li><a href="/story/12301.html">如何配置iPhone和iPad的邮件设置</a><li><a href="/story/11561.html">如何阻止合法电子邮件被标记为垃圾邮件</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>