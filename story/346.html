<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>用于将文件上载到远程服务器上的相同子目录的Shell脚本</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>用于将文件上载到远程服务器上的相同子目录的Shell脚本</h2></div><div class="content"><p>Web开发人员的一项非常常见的任务是将单个文件从开发箱上的子目录上载到远程服务器上的相同子目录。不幸的是，这始终是一个烦人的手动过程，涉及在两个服务器上切换目录，并且浪费大量时间。</p><p>因此，我自己编写了一个shell脚本来自动执行此操作，使用SCP进行安全文件复制。(重要附注：FTP非常不安全，请改用WinSCP)</p><p>要解决的主要问题是，我在开发机器上安装的WordPress与安装在服务器上的WordPress的基目录不同。在我的开发机器上，它是/var/www，而在我的服务器上，它更像是/var/www/howtogeek/docs/。我决定只在脚本开始时将它们移到变量中，如下所示：</p><p>请注意，脚本中的本地目录(LDIR)在路径中的每个/之前都有一个\。这是因为我们稍后将把它传递给脚本中的sed命令，所以我们必须转义这些值。“我确信还有其他方法可以解决这个问题，但我不知道。</p><p>接下来，我设置自动ssh登录。为此，您需要首先运行ssh keygen实用程序，如下所示：</p><p>然后，您需要将~/.ssh/id_rsa.pub文件复制到远程服务器上的~/.ssh/Authorized_key文件。如果已经在远程服务器上创建了~/.ssh目录(可能需要检查)，则可以运行此命令来复制密钥：</p><p>现在，我们已经实现了自动ssh登录，无需密码即可使用scp实用程序。现在，我们来看一下脚本中将使用的scp命令：</p><p>$1是您将传递给脚本的参数，用于您尝试上载的文件名。$SSHSERVER和$RDIR是我们将在脚本开头设置的变量，用于设置user@hostname和前面的远程路径。</p><p>以pwd|sed开头的第一个块采用当前目录路径，并去掉路径中与远程服务器不匹配的前面部分，但保留路径的其余部分。例如，如果您在运行命令时位于/var/www/wp-content/中，sed块将根据我们的LDIR变量去掉/var/www，但保留/wp-content/的一部分。</p><p>第二个代码块只是确保从传递给脚本的文件名中去掉前面的整个路径，这样您就只得到了文件名。</p><p>例如，如果您将脚本命名为up.sh，并从文件的本地目录/var/www/wp-content/plugins/中运行它：</p><p>外壳程序将按如下方式展开它：</p><p>我没有尝试根据本文创建您自己的脚本文件，而是提供了它供您下载。这样就不会出现特殊字符不起作用的问题了，…。是的，我使用脚本上传了自己=)</p><p>下载geek-ploader.sh</p><p>只要把它放在你的路径上的某个地方，然后给它起任何你想要的名字。我将我的文件重命名为“up”，所以我只需输入“up filename.txt”即可上传。还要记住打开它并更改脚本开头的变量以匹配您的环境。</p><p>这个脚本应该可以在任何带有*nix shell和scp实用程序的系统上运行。我使用的是Ubuntu，但它应该可以在安装了Cygwin的Solaris、OS X甚至Windows上运行。</p><div class="item_info"><span class="item_key"><a href="/tag/脚本/">脚本</a></span><span class="item_key"><a href="/tag/文件/">文件</a></span><span class="item_key"><a href="/tag/路径/">路径</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14323.html">如何在Windows上将Caps Lock用作修改键</a><li><a href="/story/14159.html">如何在Bash中使用变量</a><li><a href="/story/13819.html">如何将GUI添加到Linux Shell脚本</a><li><a href="/story/13415.html">如何在Linux上使用yes命令</a><li><a href="/story/13180.html">如何使用脚本编辑器为Google应用程序增压</a><li><a href="/story/13172.html">如何使用Linux睡眠命令暂停Bash脚本</a><li><a href="/story/13147.html">如何在进程退出时自动关闭MacOS终端</a><li><a href="/story/13134.html">如何编写自动热键脚本</a><li><a href="/story/12894.html">如何从Bash脚本获取系统的地理位置</a><li><a href="/story/11595.html">如何使用自动热键创建自定义键盘快捷键</a><li><a href="/story/11555.html">如何在Windows中自动键入带双空格的句点</a><li><a href="/story/11135.html">如何恢复Chromebook的原始BIOS和软件(如果已擦除)</a><li><a href="/story/10454.html">如何在Windows 10上创建和运行Bash Shell脚本</a><li><a href="/story/9334.html">如何使用Geektool自定义您的Mac桌面</a><li><a href="/story/7708.html">如何配置Windows以更轻松地使用PowerShell脚本</a><li><a href="/story/7704.html">如何使用批处理文件使PowerShell脚本更易于运行</a><li><a href="/story/7689.html">作用域如何影响PowerShell脚本</a><li><a href="/story/7581.html">使用Google Sheet和Google Apps脚本可以做的8件非常有用的事情</a><li><a href="/story/7410.html">愚蠢的极客小把戏：如何让你的电脑与你对话</a><li><a href="/story/7370.html">在Windows上使窗口始终在最上面的3种最佳方法</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>