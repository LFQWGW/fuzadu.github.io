<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>极客学校：在PowerShell中学习格式化、过滤和比较</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>极客学校：在PowerShell中学习格式化、过滤和比较</h2></div><div class="content"><img class="content_img" src="/image/20/207ea41ab315096bfcdb3ed62317373a.png" /><p>在本期的“极客学校”中，我们来看看如何格式化、过滤和比较管道中的对象。</p><p>请务必阅读本系列的前几篇文章：</p><p>
了解如何使用PowerShell自动化Windows。
学习在PowerShell中使用Cmdlet。
了解如何在PowerShell中使用对象</p><p>在接下来的一周里，我们将继续关注这一系列的节目。</p><p>默认格式设置</p><p>当我第一次开始使用PowerShell时，我认为一切都很神奇，但事实是，它只是需要一点时间才能理解引擎盖背后发生的事情。PowerShell格式化系统也是如此。事实上，如果运行Get-Service cmdlet，则生成的输出仅显示3个属性：Status、Name和DisplayName。</p><img class="content_img" src="/image/41/41d02d315e8e17d29f6c18a2efc8951a.png" /><p>但是，如果您通过管道将Get-Service传递给Get-Member，您会看到ServiceController对象具有的不仅仅是这三个属性，那么这是怎么回事呢？</p><img class="content_img" src="/image/62/62f6b52a2bdb8a5dc131eab008028c9b.png" /><p>答案就在定义大多数内置cmdlet如何显示其输出的隐藏文件中。要了解情况，请在shell中键入以下内容，然后按Enter键。</p><p>如果我们使用记事本的查找功能，我们可以通过搜索ServiceController类型快速跳到详细介绍Get-Service cmdlet输出的部分。</p><img class="content_img" src="/image/84/847422eb1ac1437f4b9e88ba1840974f.png" /><p>突然，您可以看到PowerShell正在格式化管道中任何ServiceController类型的对象，并创建一个包含三列的表：Status、Name和DisplayName。但是，如果您正在处理的类型在该文件或任何其他格式文件中没有相应的条目，该怎么办呢？那么，实际上这很简单。如果流水线中的对象具有5个或更多属性，则PowerShell将在列表中显示该对象的所有属性；如果该对象的属性少于5个，则将它们显示在表中。</p><p>设置数据格式</p><p>如果您对对象或类型的默认格式不满意，可以滚动您自己的格式。要做到这一点，您需要知道三个cmdlet。</p><p>
格式-列表。
格式-表格。
全格式</p><img class="content_img" src="/image/7b/7b80464df0157ae5de0d837ce8d800ff.png" /><p>Format-Wide只获取一个对象集合，并显示每个对象的单个属性。默认情况下，它将查找Name属性；如果您的对象不包含Name属性，则一旦属性按字母顺序排序，它将使用对象的第一个属性。</p><img class="content_img" src="/image/f1/f17c761287865517fdcdfb2f44affd15.png" /><p>如您所见，它也默认为两列，尽管您可以指定要使用的属性以及要显示的列数。</p><img class="content_img" src="/image/a7/a76ef7e59d2e130cae0f564b4c6fd5ac.png" /><p>如果默认情况下将某些内容格式化为表格，则始终可以使用Format-List cmdlet将其切换到列表视图。让我们来看看Get-Process cmdlet的输出。</p><img class="content_img" src="/image/eb/eb8716c18c4809be1960117ced909c25.png" /><p>这个表格视图实际上非常适合这种信息，但是让我们假设我们想要以列表形式查看它。我们真正需要做的就是通过管道将其转换为format-list。</p><img class="content_img" src="/image/dd/dd60851579ac5dae300421977df0d3ba.png" /><p>如您所见，默认情况下列表中只显示四个项目。要查看对象的所有属性，可以使用通配符。</p><img class="content_img" src="/image/a8/a8fc46a7a4dba7f2f521a12f09ef2cc7.png" /><p>或者，您可以只选择所需的属性。</p><img class="content_img" src="/image/54/543243168f7121b7983625c25a34ae7a.png" /><p>格式(Format)-另一方面，表获取数据并将其转换为表。由于Get-Process中的数据已经是表格的形式，我们可以使用它轻松地选择我们想要在表格中显示的属性。我使用AutoSize参数使所有数据适合单个屏幕。</p><img class="content_img" src="/image/4c/4c423941b8c5c4b89b1df040ea2fe37c.png" /><p>过滤和比较</p><p>使用基于对象的管道最大的好处之一是，您可以在任何阶段使用Where-Object cmdlet将对象筛选出管道。</p><img class="content_img" src="/image/81/81c2f85f3767c8829900346acc1a4bf3.png" /><p>使用WHERE对象实际上非常简单。$_表示当前管道对象，您可以从中选择要过滤的属性。在这里，WE只保留Status属性等于Running的对象。您可以在筛选脚本块中使用几个比较运算符：</p><p>
情商(等于)。
NEQ(不等于)。
GT(大于)。
GE(大于或等于)。
lt(小于)。
LE(小于或等于)。
LIKE(通配符字符串匹配)</p><p>完整的列表和更多信息可以在ABOWO_COMPARISTING概念帮助文件中查看，但是需要一些时间来适应WHERE-OBJECT语法。这次就到这里吧！</p><div class="item_info"><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/属性/">属性</a></span><span class="item_key"><a href="/tag/对象/">对象</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14706.html">如何在Linux上使用uniq命令</a><li><a href="/story/14624.html">解释的Linux文件时间戳：atime、mtime和ctime</a><li><a href="/story/14585.html">如何在Microsoft Excel中兑换货币</a><li><a href="/story/14577.html">如何检查Linux上安装了哪个GPU</a><li><a href="/story/14572.html">如何使用Jouralctl读取Linux系统日志</a><li><a href="/story/14570.html">如何在Linux上使用grep命令</a><li><a href="/story/14555.html">2020年CES最佳：我们今年看到的所有最好的东西</a><li><a href="/story/14550.html">如何在Linux上使用Tail命令</a><li><a href="/story/14542.html">如何从MacOS Catalina向iPhone添加自定义铃声</a><li><a href="/story/14508.html">如何使用键盘快捷键简化流媒体Netflix</a><li><a href="/story/14507.html">如何在Linux上使用HISTORY命令</a><li><a href="/story/14499.html">如何在Linux上使用免费命令</a><li><a href="/story/14467.html">如何在Windows 10上切换到本地用户帐户</a><li><a href="/story/14466.html">如何在Linux上使用at和Batch来调度命令</a><li><a href="/story/14461.html">如何设置您的新Mac</a><li><a href="/story/14450.html">如何在Excel中将一长列变为多列</a><li><a href="/story/14438.html">如何在iPhone上创建和使用Memoji和Animoji</a><li><a href="/story/14434.html">Chrome 79的新特性，现已推出</a><li><a href="/story/14426.html">如何使用Google Sheets中的查询功能</a><li><a href="/story/14424.html">如何向Outlook会议请求添加默认签名</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>