<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>在Microsoft Excel中使用透视表</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>在Microsoft Excel中使用透视表</h2></div><div class="content"><p>数据透视表是Microsoft Excel最强大的功能之一，只需点击几下鼠标，就可以对大量数据进行分析和汇总。在本文中，我们将探索数据透视表，了解它们是什么，并了解如何创建和自定义它们。</p><p>注：本文使用Excel 2010(Beta)编写。这些年来，数据透视表的概念几乎没有变化，但创建数据透视表的方法几乎在Excel的每次迭代中都有所不同。*如果您使用的Excel版本不是2010，请期待与您在本文中看到的不同的屏幕。</p><p>一段小小的历史</p><p>在电子表格程式的早期，莲花1-2-3独占鳌头，它的统治地位是如此完整，以至于人们认为微软费心开发自己的电子表格软件(Excel)来与Lotus竞争是在浪费时间。快闪到2010年，Excel在电子表格市场的主导地位比莲花以往任何时候都要大，而仍在运行Lotus 1-2-3的用户数量却接近于零，这是怎么发生的？是什么造成了如此戏剧性的命运逆转？</p><p>行业分析人士将其归因于两个因素：第一，莲花认为这个名为“Windows”的新GUI平台只是昙花一现，永远不会起飞。第二，他们拒绝创建Lotus 1-2-3的Windows版本(至少在几年内)，预测他们的DOS版本的Lotus 1-2-3是任何人都会需要的。*微软自然只为Windows开发了Excel。第二，微软为Excel开发了Lotus在1-2-3中没有提供的一个功能，即PivotTables。-PivotTables。被认为是如此令人震惊的有用，以至于人们愿意学习一个全新的软件包(Excel)，而不是坚持一个没有它的程序(1-2-3)。这一特性，连同对Windows成功的误判，是Lotus 1-2-3的丧钟，也是Microsoft Excel成功的开始。</p><p>了解数据透视表</p><p>那么，什么是数据透视表呢？</p><p>简而言之，数据透视表是一些数据的摘要，创建该摘要是为了便于对这些数据进行分析。但与手动创建的摘要不同，Excel数据透视表是交互式的。一旦您创建了数据透视表，如果它不能提供您所希望的对数据的准确洞察，您可以很容易地对其进行更改。*只需单击几下鼠标，就可以对摘要进行“旋转”-以列标题变成行标题的方式旋转，反之亦然。此外，还可以做更多的事情。此外，还可以做更多的事情。*只需几次单击，摘要就可以“旋转”-以列标题变成行标题的方式旋转，反之亦然。此外，还可以做更多的事情</p><p>使用数据透视表分析的数据不能只是任何数据-它必须是原始数据，以前未处理(未汇总)-通常是某种列表。例如，公司过去六个月的销售交易列表。</p><p>检查如下所示的数据：</p><img class="content_img" src="/image/0c/0c8f26de15978ed9da637b269ad846ca.png" /><p>请注意，这不是原始数据。事实上，它已经是某种摘要了。在单元格B3中，我们可以看到3万美元，这显然是詹姆斯·库克1月份的总销售额。那么原始数据在哪里？我们是如何得出3万美元这个数字的？生成这个数字的原始销售交易列表在哪里？很明显，肯定有人不厌其烦地将过去六个月的所有销售交易整理成我们上面看到的摘要。如何得出这个数字？很明显，肯定有人不厌其烦地将过去六个月的所有销售交易整理到我们上面看到的摘要中。</p><p>很有可能，是的。如你所见，上面的电子表格实际上不是数据透视表。它是根据存储在其他地方的原始数据手动创建的，确实需要几个小时才能编译。但是，它正是可以使用数据透视表创建的那种摘要，在这种情况下，只需要几秒钟。让我们来看看…是如何创建的</p><p>如果我们跟踪原始的销售交易列表，它可能如下所示：</p><img class="content_img" src="/image/10/10734720898839295e74d450d101dcb4.png" /><p>你可能会惊讶地发现，使用Excel的数据透视表功能，我们可以在几秒钟内创建一个与上面的类似的月度销售总结，只需点击几下鼠标。“我们可以做到这一点-而且还可以做得更多！”</p><p>如何创建数据透视表</p><p>首先，确保在Excel中的工作表中有一些原始数据。财务交易列表是典型的，但它可以是几乎任何内容的列表：员工联系方式、CD收藏或公司车队的燃油消耗数据。</p><p>因此，我们启动Excel…。我们加载这样一个列表…</p><img class="content_img" src="/image/10/10734720898839295e74d450d101dcb4.png" /><p>一旦我们在Excel中打开了列表，我们就可以开始创建数据透视表了。</p><p>单击列表中的任何一个单元格：</p><img class="content_img" src="/image/2d/2d0b05bc00de9f2020eded739f8d83dd.png" /><p>然后，在插入选项卡中，单击数据透视表图标：</p><img class="content_img" src="/image/25/25b065ed7c3cca9a94d8043bf76efbfb.png" /><p>此时将出现“创建数据透视表”框，询问您两个问题：“新的数据透视表应该基于什么数据，应该在哪里创建它？”因为我们已经单击了列表中的一个单元格(在上面的步骤中)，所以该单元格周围的整个列表已经为我们选择了(在此示例中，付款工作表上的$A$1：$G$88)。请注意，我们可以选择任何其他工作表的任何其他区域中的列表，甚至可以选择某些外部数据源(如Access数据库表)中的列表。甚至是MS-SQL Server数据库表。*我们还需要选择是在新工作表上还是在现有工作表上创建新的数据透视表。*在此示例中，我们将选择一个新的透视表：</p><img class="content_img" src="/image/1e/1eb10215f122eecf57e3adaf25559a9f.png" /><p>将为我们创建新工作表，并在该工作表上创建一个空白数据透视表：</p><img class="content_img" src="/image/08/083359e16c5c8c4b0e2cbaabe30c259a.png" /><p>还会出现另一个框：在数据透视表字段列表中。当我们单击数据透视表中的任何单元格(上图)时，都会显示此字段列表：</p><img class="content_img" src="/image/3b/3b856260134cba67d128b905c2285fc3.png" /><p>框顶部的字段列表实际上是原始原始数据工作表中的列标题的集合。屏幕下部的四个空白框允许我们选择希望数据透视表汇总原始数据的方式。*到目前为止，这些框中没有任何内容，所以数据透视表是空白的。我们所需要做的就是将字段从上面的列表拖放到下面的框中。然后会自动创建一个数据透视表来匹配我们的指令。如果我们得到。我们只需将字段拖回其来源位置和/或向下拖动新字段即可替换它们。</p><p>值框可以说是四个框中最重要的一个。拖到此框中的字段表示需要以某种方式汇总的数据(通过求和、求平均值、查找最大值、最小值等)。*它几乎总是数值数据。在我们的示例数据中，此框的一个完美候选者是“Amount”字段/列。*让我们将该字段拖到值框中：</p><img class="content_img" src="/image/e7/e77762148cc0fd6c4e9a2e7b480074ca.png" /><p>请注意，(A)字段列表中的“Amount”字段现在已勾选，并且“Sum of Amount”已添加到“Values”框中，表示已对Amount列进行求和。</p><p>如果我们检查数据透视表本身，我们确实会发现原始数据工作表中所有“数量”值的总和：</p><img class="content_img" src="/image/e6/e68c646f073e92d9c1fb342c7de92304.png" /><p>我们已经创建了我们的第一个数据透视表！非常方便，但并不特别令人印象深刻。我们很可能需要更深入地了解我们的数据。</p><p>参考我们的示例数据，我们需要确定一个或多个列标题，我们可以使用它们来拆分此合计。例如，我们可能决定要查看数据摘要，其中我们希望看到公司中每个不同销售人员的行标题和每个销售人员的合计。要实现这一点，我们只需将“SalesPerson”字段拖到“行标签”框中：</p><img class="content_img" src="/image/aa/aaa218025286755740ed4a328e881300.png" /><p>现在，事情终于开始变得有趣了！我们的数据透视表开始成形了…。。</p><img class="content_img" src="/image/fa/fa2c58633b95f82c5ee55ae2bb448ce0.png" /><p>通过几次单击，我们已经创建了一个需要花费很长时间手动完成的表。</p><p>那么我们还能做些什么呢？嗯，从某种意义上说，我们的数据透视表是完整的。“我们已经创建了源数据的有用摘要。重要的东西已经学到了！”在本文的其余部分，我们将研究一些可以创建更复杂的数据透视表的方法，以及可以自定义这些数据透视表的方法。</p><p>首先，我们可以创建一个二维表。让我们使用“支付方式”作为列标题来实现这一点。*只需将“支付方式”标题拖到列标签框中：</p><img class="content_img" src="/image/fa/fa464dad87bd61068a505cd7dc20210e.png" /><p>它看起来像这样：</p><img class="content_img" src="/image/92/9297a7a849cae77c8963d6ee42aa7a8b.png" /><p>开始变得很酷了！</p><p>让我们把它做成一个三维的桌子。这样的桌子可能是什么样子的呢？嗯，让我们看看…</p><p>将“Package”列/标题拖到报告过滤器框中：</p><img class="content_img" src="/image/7f/7fc172e5497583558b06880d93f10fd9.png" /><p>请注意它在哪里结束了…。。</p><img class="content_img" src="/image/eb/ebde5cd5c93feae438642d05759dbea0.png" /><p>这使我们可以根据购买的是哪个“假日套餐”来筛选我们的报告。例如，我们可以查看所有套餐的销售人员与支付方式的细目，或者只需单击几下，就可以更改它，以显示“SunSeeers”套餐的相同细目：</p><img class="content_img" src="/image/4f/4f639fdab5afcb1f5fbf7ceb024e91c3.png" /><p>所以，如果你想得对的话，我们的数据透视表现在是三维的。“让我们继续定制…吧</p><p>如果结果是，比方说，我们只想看到支票和信用卡交易(即没有现金交易)，那么我们可以从列标题中取消选择“Cash”项。*单击列标签旁边的下拉箭头，并取消勾选“Cash”：</p><img class="content_img" src="/image/bb/bb2fa6cabf0b0ce8c65bc9d54d211e01.png" /><p>让我们看看那是什么样子的…。如你所见，“现金”不见了。</p><img class="content_img" src="/image/08/081defdc3d8e93e966be0445b48d4067.png" /><p>安排 / 设计 / 样式 / 格式</p><p>这显然是一个非常强大的系统，但到目前为止，结果看起来非常简单和乏味。*首先，我们正在求和的数字看起来不像美元金额-只是普通的旧数字。*让我们纠正一下这一点。</p><p>一种诱惑可能是做我们在这种情况下习惯做的事情，简单地选择整个表格(或整个工作表)，然后使用工具栏上的标准数字格式按钮来完成格式设置。这种方法的问题是，如果您将来更改数据透视表的结构(可能性为99%)，那么这些数字格式将会丢失。“我们需要一种使其(半)永久性的方法。”</p><p>首先，我们在值框中找到“Sum of Amount”条目，然后点击它。此时会出现一个菜单。“我们选择Value Field Settings…。从菜单中：</p><img class="content_img" src="/image/40/4048247180f8c08cd273a5a0b23e2848.png" /><p>此时将出现“值字段设置”框。</p><img class="content_img" src="/image/07/07e146bdcfd184b20af4b0069db800c5.png" /><p>单击数字格式按钮，将出现标准格式单元格框：</p><img class="content_img" src="/image/59/59549039a5d596bd12dd08bfdc6a7f27.png" /><p>从类别列表中，选择(比方说)会计，并将小数位数降为0。单击几次确定返回到数据透视表…</p><img class="content_img" src="/image/8d/8d584b2f992ad5fe6bf489c43dc4c375.png" /><p>如您所见，这些数字已正确格式化为美元金额。</p><p>当我们谈到格式化问题时，让我们来格式化整个数据透视表。有几种方法可以做到这一点。让我们使用一个简单的…</p><p>单击数据透视表工具/设计选项卡：</p><img class="content_img" src="/image/b9/b9309c560c0026b66200eb30d882507b.png" /><p>然后向下拉数据透视表样式列表右下角的箭头，查看大量内置样式：</p><img class="content_img" src="/image/f1/f16ed19ae78325acc75700ebb76e34b1.png" /><p>选择任何有吸引力的选项，并在数据透视表中查看结果：</p><img class="content_img" src="/image/62/62d2993b6ab39cdc7a93a8a3fbf5204a.png" /><p>其他选择</p><p>我们也可以使用日期。现在，通常在事务列表中有很多很多日期，比如我们开始时使用的日期。但是Excel提供了按日、周、月、年等将数据项分组在一起的选项。让我们看看这是如何做到的。</p><p>首先，让我们从列标签框中删除“Payment Method”列(只需将其拖回到字段列表中)，并将其替换为“Date Boked”列：</p><img class="content_img" src="/image/91/91afcf76450c048e9df8f50fb79f156b.png" /><p>正如您所看到的，这使得我们的数据透视表立即毫无用处，每个事务发生的日期都会给我们提供一列-一个非常宽的表！</p><img class="content_img" src="/image/d2/d20307a83b4c9503e05838f0c08d8af1.png" /><p>要解决此问题，请右键单击任意日期，然后选择组…。从上下文菜单中：</p><img class="content_img" src="/image/f4/f4ac012167a0b6cf4d35a903c89ca9be.png" /><p>此时将出现分组框。“我们选择月份，然后单击确定：</p><img class="content_img" src="/image/26/26cd6eb659646c12a1ae6d80eee4e221.png" /><p>瞧！一个更有用的表格：</p><img class="content_img" src="/image/6a/6afd542b43147c1f221aa236716b423e.png" /><p>(顺便说一句，此表实际上与本文开头显示的表完全相同-手动创建的原始销售摘要。)</p><p>需要注意的另一件很酷的事情是，您可以有多组行标题(或列标题)：</p><img class="content_img" src="/image/d5/d5a9953bb3f413419138e3810463f136.png" /><p>…。它看起来像这个…。。</p><img class="content_img" src="/image/ab/abd4156402420c545207dd21b7c1ab13.png" /><p>您可以对列标题(甚至是报告筛选器)执行类似的操作。</p><p>同样，为了简单起见，让我们看看如何绘制平均值，而不是求和值。</p><p>首先，点击金额总和，选择值域设置…。从出现的上下文菜单中：</p><img class="content_img" src="/image/40/4048247180f8c08cd273a5a0b23e2848.png" /><p>在值域设置框的汇总值域依据列表中，选择平均值：</p><img class="content_img" src="/image/53/532ff7efe3340a0c839ff9567eccfada.png" /><p>既然我们在这里，让我们将Custom名称从“Average of Amount”更改为更简洁的名称。然后键入类似“Avg”的内容：</p><img class="content_img" src="/image/c6/c64c30caffd654051d0381a78b08b5c6.png" /><p>点击OK，看看是什么样子，注意到所有的值都从总和变成了平均值，表格标题(左上角的单元格)变成了“Avg”：</p><img class="content_img" src="/image/c9/c9d091677c5a55de592579bedbff15d4.png" /><p>如果我们愿意，我们甚至可以在同一数据透视表上显示总和、平均值和计数(计数=有多少销售额)！</p><p>下面是准备好类似内容的步骤(从空白数据透视表开始)：</p><p>
将“SalesPerson”拖到列标签中。
将“Amount”字段向下拖动到值框中三次。
对于第一个“Amount”字段，将其自定义名称更改为“Total”，将其数字格式更改为“Accounting(0个小数位)”
对于第二个“Amount”字段，将其自定义名称更改为“Average”，将其函数更改为Average，将其数字格式更改为Accounting(0个小数位)。
对于第三个“Amount”字段，将其名称更改为“Count”，将其函数更改为Count。
将自动创建的字段从列标签拖到行标签</p><p>以下是我们最终得出的结论：</p><img class="content_img" src="/image/82/82d0fab8a55f5e2bd316dfa994fc5bfd.png" /><p>合计、平均和计数在同一数据透视表上！</p><p>结束 / 结尾 / 结论 / 推论</p><p>Microsoft Excel为数据透视表创建的功能和选项还有很多-太多了，不能在这样的文章中列出。要完全涵盖数据透视表的潜力，需要一本小书(或一个大网站)。勇敢的和/或极客读者可以相当容易地进一步探索数据透视表：只需右键单击几乎所有内容，看看有哪些选项可供您使用。还有两个功能区选项卡：数据透视表工具/选项和设计。*如果您犯了错误，也不要紧-很容易删除数据透视表并重新开始-这是Lotus 1-2-3的旧DOS用户从未有过的可能性。</p><p>如果您使用的是Office2007，您可能需要阅读我们关于如何在Excel2007中创建数据透视表的文章。</p><p>我们提供了一个Excel工作簿，您可以下载该工作簿来练习您的数据透视表技能。从97开始，它应该可以与所有版本的Excel一起使用。</p><p>下载我们的练习Excel工作簿</p><div class="item_info"><span class="item_key"><a href="/tag/数据/">数据</a></span><span class="item_key"><a href="/tag/创建/">创建</a></span><span class="item_key"><a href="/tag/选择/">选择</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14809.html">如何查看(和禁用)Firefox收集的有关您的遥测数据</a><li><a href="/story/14729.html">你的杀毒软件真的在监视你吗？</a><li><a href="/story/14585.html">如何在Microsoft Excel中兑换货币</a><li><a href="/story/14450.html">如何在Excel中将一长列变为多列</a><li><a href="/story/14255.html">多层固态硬盘：什么是SLC、MLC、TLC、QLC和PLC？</a><li><a href="/story/14186.html">如何在Excel中从工作簿中删除智能标记</a><li><a href="/story/14072.html">如何在iPhone上启用低数据模式</a><li><a href="/story/13774.html">每日新闻综述：Google Chrome扩展(再次)跟踪您的浏览历史</a><li><a href="/story/13760.html">如何在Microsoft Excel图表中使用趋势线</a><li><a href="/story/13749.html">如何通过数据验证限制Google Sheet中的数据</a><li><a href="/story/13512.html">谷歌的体育场即将与ISP数据上限相撞</a><li><a href="/story/13444.html">如何在Microsoft Excel中合并或分组饼图</a><li><a href="/story/13412.html">如何在Google Sheet中拆分文本</a><li><a href="/story/13407.html">每日新闻综述：运营商承诺停止销售您的位置…。再一次</a><li><a href="/story/13369.html">如何编辑或删除PowerPoint图表中的数据</a><li><a href="/story/13345.html">“与巢合作”的结局对你意味着什么</a><li><a href="/story/13323.html">如何让Microsoft Excel计算不确定度</a><li><a href="/story/13204.html">亚历克莎，员工为什么要看我的数据？</a><li><a href="/story/13049.html">Google Sheet中的透视表是什么，我如何使用它们</a><li><a href="/story/13036.html">如何在Excel中计算透视表的变动百分比</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>