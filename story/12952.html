<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何对值范围使用VLOOKUP</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何对值范围使用VLOOKUP</h2></div><div class="content"><img class="content_img" src="/image/18/188fdb87b73107ed62322b691de076c5.png" /><p>VLOOKUP是Excel最著名的函数之一。您通常会使用它来查找完全匹配的内容，比如产品或客户的ID，但在本文中，我们将探索如何将VLOOKUP与一系列值一起使用。</p><p>示例一：使用VLOOKUP为考试成绩分配字母分数</p><p>例如，假设我们有一个考试分数列表，并且我们想要为每个分数分配一个分数。在我们的表格中，A列显示实际考试分数，B列将用于显示我们计算的字母分数。我们还在右侧创建了一个表(D和E列)，其中显示了达到每个字母等级所需的分数。</p><img class="content_img" src="/image/85/85d9a21510a1223d1ffe3d3fffca6f00.png" /><p>使用VLOOKUP，我们可以使用D列中的范围值将E列中的字母分数分配给所有实际考试分数。</p><p>VLOOKUP公式</p><p>在我们开始将公式应用到我们的示例之前，让我们快速提醒一下VLOOKUP语法：</p><code>=VLOOKUP(lookup_value, table_array, col_index_num, range_lookup)</code><p>在该公式中，变量的工作方式如下：</p><p>
LOOKUP_VALUE：这是您要查找的值。对于我们来说，这是A列中的分数，从单元格A2开始。
table_array：这通常被非正式地称为查找表。对我们来说，这是包含分数和相关成绩的表(范围D2：E7)。
COL_INDEX_NUM：这是放置结果的列号。在我们的示例中，这是B列，但是因为VLOOKUP命令需要一个数字，所以它是第2列。
RANGE_LOOKUP&gt;这是一个逻辑值问题，因此答案为TRUE或FALSE。您正在执行范围查找吗？对我们来说，答案是肯定的(或者用VLOOKUP术语来说是“真”)。</p><p>我们示例的完整公式如下所示：</p><code>=VLOOKUP(A2,$D$2:$E$7,2,TRUE)</code><img class="content_img" src="/image/80/805975e0ae7dd79f9111412df82c406e.png" /><p>已修复表数组，以便在将公式向下复制到列B的单元格时停止更改。</p><p>要小心的事情</p><p>在使用VLOOKUP查找范围时，表数组的第一列(在此场景中为D列)必须按升序排序。公式根据此顺序将查找值放置在正确的范围内。</p><p>如果我们按成绩字母而不是分数对表数组进行排序，下面是我们将获得的结果的图像。</p><img class="content_img" src="/image/d7/d70878ce6b434e32cbe85a5cd69a01a6.png" /><p>重要的是要清楚，只有在进行范围查找时，顺序才是必要的。当您将False放在VLOOKUP函数的末尾时，顺序就不那么重要了。</p><p>示例二：根据客户花费多少提供折扣</p><p>在本例中，我们有一些销售数据。我们想在销售金额上提供折扣，折扣的百分比取决于花费的金额。</p><p>查找表(列D和E)包含每个支出级别的折扣。</p><img class="content_img" src="/image/e7/e7204d15431860144c485586e50687da.png" /><p>下面的VLOOKUP公式可用于从表中返回正确的折扣。</p><code>=VLOOKUP(A2,$D$2:$E$7,2,TRUE)</code><p>这个例子很有趣，因为我们可以在公式中使用它来减去折扣。</p><p>您会经常看到Excel用户为这种类型的条件逻辑编写复杂的公式，但是这个VLOOKUP提供了一种简明的实现方式。</p><p>下面，将VLOOKUP添加到公式中，以减去从A列的销售额中返回的折扣。</p><code>=A2-A2*VLOOKUP(A2,$D$2:$E$7,2,TRUE)</code><img class="content_img" src="/image/96/96f5a105c5f9975d202f767ead2a5264.png" /><p>VLOOKUP不仅适用于查找员工和产品等特定记录。它比许多人所知道的更加多才多艺，让它从一系列值中返回就是一个例子。您也可以使用它作为其他复杂公式的替代方案。</p><div class="item_info"><span class="item_key"><a href="/tag/vlookup/">vlookup</a></span><span class="item_key"><a href="/tag/查找/">查找</a></span><span class="item_key"><a href="/tag/公式/">公式</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14346.html">如何使用VLOOKUP在Google Sheet中查找数据</a><li><a href="/story/1807.html">Excel中的VLOOKUP，第2部分：在没有数据库的情况下使用VLOOKUP</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>