<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用PowerShell在Server 2008中创建多个用户，第2部分：更多字段</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>使用PowerShell在Server 2008中创建多个用户，第2部分：更多字段</h2></div><div class="content"><p>在上一篇文章中，我们向您展示了从简单的用户列表到在Active Directory中创建用户的最快方法。但是，您经常会得到具有额外数据字段的用户列表。由于我们不能针对所有可能的场景提前编写脚本，因此我们将向您展示如何使用我们的用户创建PowerShell脚本并对其进行修改以满足您的目的。</p><p>在本例中，我们被赋予了新用户的Office属性，因此我们需要确保在创建时将其添加到每个新用户帐户中。</p><img class="content_img" src="/image/5a/5a8079ce563a488c6bf2cb1adf13310f.png" /><p>我们要做的第一件事是将Excel文件另存为.csv文件。</p><img class="content_img" src="/image/50/508eb094056cf5d094c2de9bfc1a34fa.png" /><p>接下来，我们打开“Active Directory用户和计算机”管理单元。我们需要找出Office字段的实际属性名称，因此我们将通过双击当前用户之一的属性来打开这些属性。</p><img class="content_img" src="/image/47/475ea6fd34efc4a075aa7f57ed2c3951.png" /><p>我们可以看到，该用户已在General选项卡上为其Office属性填写了人力资源。</p><img class="content_img" src="/image/66/660ee34dec3a247f25e28a702d8376d8.png" /><p>我们将单击Attribute Editor选项卡来查找该Office字段的技术名称，因为我们需要它立即进入PowerShell。它显示Office字段的属性名称为PhysiicalDeliveryOfficeName。由于属性名称并不总是与其他选项卡中的字段名称相同，因此有时可能很难找到您要查找的内容。如果似乎找不到所需的场，则始终可以创建虚拟用户并仅将该特定字段修改为唯一的字段，然后转到属性编辑器选项卡并向下滚动，直到找到它。</p><img class="content_img" src="/image/0f/0fc0226ec36d4f0a300e240d3549ca80.png" /><p>现在，我们需要编辑PowerShell脚本以反映这个新字段。其格式为“AttributeName=dataRecord”。我们希望确保在“$dataRecord”之后正确输入.csv文件中的字段名。进入。本节将从我们的用户文件中提取数据：</p><p>脚本的这一部分将把它放入新的用户对象中：</p><p>完成的脚本将如下所示：</p><img class="content_img" src="/image/74/74240f51fbf1da14edb0ca81dad3537b.png" /><p>确保将脚本另存为.ps1文件。</p><img class="content_img" src="/image/d5/d5207fdacbf2cad4e3d1923a1e659775.png" /><p>将我们的用户列表和脚本放在C：UsersAdministrator文件夹中，右键单击该脚本并选择Run with PowerShell。</p><img class="content_img" src="/image/08/08fa5d19918ba376a2c86d1727e4df58.png" /><p>当我们跳回AD用户和计算机时，我们可以看到创建的新用户。</p><img class="content_img" src="/image/f8/f8a30b89e2268d69474e760ba2b79ff0.png" /><p>打开我们新创建的一个用户将显示Office字段已由原始用户列表中的数据填充。</p><img class="content_img" src="/image/73/7387991f5bd03baaa5d08446a1442882.png" /><p>使用PowerShell创建多个用户是一项非常简单的任务，掌握了这方面的知识，您就再也不会费力了。</p><div class="item_info"><span class="item_key"><a href="/tag/用户/">用户</a></span><span class="item_key"><a href="/tag/脚本/">脚本</a></span><span class="item_key"><a href="/tag/属性/">属性</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/13420.html">每日新闻综述：T-Mobile和Sprint合并接近批准</a><li><a href="/story/13178.html">如何在Linux中确定当前用户帐户</a><li><a href="/story/13019.html">每日新闻综述：2019年3月12日的头条新闻</a><li><a href="/story/12720.html">如何让其他用户退出Windows 10</a><li><a href="/story/12413.html">这个奇怪的谷歌地图垃圾邮件是怎么回事？</a><li><a href="/story/11902.html">如何在Mac上更改您的用户资料图片</a><li><a href="/story/11837.html">如何在MacOS上设置来宾用户帐户</a><li><a href="/story/11801.html">为什么有些系统用户的Shell是/usr/bin/false？</a><li><a href="/story/11605.html">如何阻止Windows用户更改桌面背景</a><li><a href="/story/11253.html">如何禁用内置的“Windows键”快捷键</a><li><a href="/story/11099.html">为什么Linux允许用户删除根目录？</a><li><a href="/story/10724.html">有没有办法在Mozilla Firefox中强制启用Reader View？</a><li><a href="/story/10446.html">如何在Windows10的Ubuntu Bash Shell中更改您的用户帐户</a><li><a href="/story/10148.html">硬盘上的数据是否可以在不发出损坏警告的情况下降级？</a><li><a href="/story/9882.html">如何防止特定用户关闭Windows</a><li><a href="/story/9867.html">如何将本地组策略调整应用于特定用户</a><li><a href="/story/8052.html">如何安全地与来宾共享您的智能手机、计算机或平板电脑</a><li><a href="/story/7890.html">如何在Google Chrome中隐藏新用户配置文件名称按钮？</a><li><a href="/story/7290.html">为什么在使用Google Chrome浏览时，网站文本大小突然增加？</a><li><a href="/story/7056.html">如何在Chrome的稳定版和测试版频道中重新启用非Web Store扩展？</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>