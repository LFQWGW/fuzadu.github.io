<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何在Windows PowerShell中使用命令历史记录</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何在Windows PowerShell中使用命令历史记录</h2></div><div class="content"><img class="content_img" src="/image/6e/6e8b1f4994d6478c0af7daa3a178360c.png" /><p>Windows PowerShell具有内置的命令历史记录功能，可提供有关您运行的命令的详细信息。与命令提示符一样，PowerShell仅记住当前会话的命令历史记录。</p><p>如何使用命令行缓冲区</p><p>相关：极客学校：了解如何使用PowerShell自动化Windows</p><p>从技术上讲，PowerShell有两种类型的命令历史记录。首先是命令行缓冲区，它实际上是图形PowerShell终端应用程序的一部分，而不是底层Windows PowerShell应用程序的一部分。它提供一些基本功能：</p><p>
向上箭头：重新调用您之前键入的命令。然后重复按键以浏览您的命令历史记录。
向下箭头：回想一下您键入的下一个命令。重复按键可浏览您的命令历史记录。
F8：在命令历史记录中搜索与当前命令行上的文本匹配的命令。因此，如果要搜索以“p”开头的命令，可以在命令行中键入“p”，然后重复按F8在历史记录中以“a”开头的命令之间循环。</p><p>默认情况下，缓冲区会记住您键入的最后50条命令。要更改此设置，请右键单击PowerShell提示符窗口的标题栏，选择“属性”，然后在“命令历史记录”下更改“缓冲区大小”的值。</p><img class="content_img" src="/image/c9/c95d3a301242ae704176e723ec918a2b.png" /><p>如何查看PowerShell历史记录</p><p>Windows PowerShell本身保留您在当前PowerShell会话中键入的命令的历史记录。您可以使用几个附带的cmdlet来查看和处理您的历史记录。</p><p>要查看您键入的命令的历史记录，请运行以下cmdlet：</p><code>Get-History</code><img class="content_img" src="/image/aa/aa401beef5cf7d944fa9e2e61124a0a4.png" /><p>通过将结果输出通过管道传输到Select-string cmdlet并指定要搜索的文本，可以搜索历史记录。将下面cmdlet中的“Example”替换为要搜索的文本：</p><code>Get-History |  Select-String -Pattern "Example"</code><img class="content_img" src="/image/5b/5b8dfd73292b7f659e1bda6622e12acc.png" /><p>要查看显示每个命令的执行状态及其开始和结束时间的更详细的命令历史记录，请运行以下命令：</p><code>Get-History | Format-List -Property *</code><img class="content_img" src="/image/1c/1c687c8554f984afa253f14c1a53be08.png" /><p>默认情况下，Get-History cmdlet仅显示32个最近的历史记录条目。如果要查看或搜索大量历史条目，请使用-count选项指定PowerShell应显示的历史条目数量，如下所示：</p><code>Get-History -Count 1000

Get-History -Count 1000 | Select-String -Pattern "Example"

Get-History -Count 1000 | Format-List -Property *</code><img class="content_img" src="/image/dc/dc1bed8d3089c360065dca7e3ecbd226.png" /><p>如何从您的历史记录中运行命令</p><p>若要从您的历史记录运行命令，请使用以下cmdlet，指定Get-History cmdlet所显示的历史记录项目的ID号：</p><code>Invoke-History #</code><p>要从您的历史记录背靠背运行两个命令，请在同一行上使用Invoke-History两次，并用分号分隔。例如，要快速运行历史记录中的第一个命令，然后运行第二个命令，您可以运行：</p><code>Invoke-History 1;Invoke-History 2</code><img class="content_img" src="/image/e5/e57bc45378f28b3c3d379456c902a1c0.png" /><p>如何清除PowerShell历史记录</p><p>若要清除您键入的命令的历史记录，请运行以下cmdlet：</p><code>Clear-History</code><img class="content_img" src="/image/1e/1eccacb1e4d469531ae56d208b193f31.png" /><p>请注意，命令行缓冲区与PowerShell历史记录是分开的。因此，即使在运行Clear-History之后，您也可以继续按向上和向下箭头键滚动您键入的命令。但是，如果您运行Get-History，您将看到您的PowerShell历史记录实际上是空的。</p><p>PowerShell不会在两次会话之间记住您的历史记录。要擦除当前会话的两个命令历史记录，您只需关闭PowerShell窗口。</p><p>如果要在清除历史记录后清除PowerShell窗口，可以通过运行Clear命令来完成：</p><code>Clear</code><img class="content_img" src="/image/12/121217c2f192dde8decee329da254183.png" /><p>如何保存和导入PowerShell历史记录</p><p>如果要保存当前会话的PowerShell命令历史记录以便以后参考，可以执行此操作。</p><code>Get-History | Export-Clixml -Path c:\users\name\desktop\commands.xml</code><img class="content_img" src="/image/16/16d8a5d7d34e6a0dbbcc25efab522b75.png" /><p>这会将您的命令历史记录导出为一个详细的XML文件，其中包含每个命令的“StartExecutionTime”和“EndExecutionTime”值，它们告诉您命令何时运行以及完成所需的时间。</p><img class="content_img" src="/image/43/43908d9024e7a3754b6c4ab77c344bfe.png" /><p>将PowerShell历史记录导出到此类XML文件后，您(或向其发送XML文件的其他任何人)可以使用Add-History cmdlet将其导入到另一个PowerShell会话中：</p><code>Add-History -InputObject (Import-Clixml -Path C:\users\name\desktop\commands.xml)</code><p>如果在导入此类XML文件后运行Get-History.cmdlet，您将看到来自XML文件的命令已导入到当前PowerShell会话的历史记录中。</p><img class="content_img" src="/image/f4/f4a6873de72efe3e2877ecf170605a0c.png" /><div class="item_info"><span class="item_key"><a href="/tag/powershell/">powershell</a></span><span class="item_key"><a href="/tag/命令/">命令</a></span><span class="item_key"><a href="/tag/历史记录/">历史记录</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/11319.html">如何检查您的PC上是否启用了安全引导</a><li><a href="/story/10708.html">如何在Linux或OS X上安装Microsoft PowerShell</a><li><a href="/story/5949.html">从Microsoft下载免费PowerShell快速参考指南</a><li><a href="/story/5735.html">如何使用PowerShell解压ZIP文件</a><li><a href="/story/5632.html">PowerShell与Windows命令提示符的不同之处</a><li><a href="/story/5297.html">Windows Server 2012中的DCPromo发生了什么变化？</a><li><a href="/story/5274.html">极客学校：学习在PowerShell中使用远程处理</a><li><a href="/story/5261.html">极客学校：学习在PowerShell中使用Cmdlet</a><li><a href="/story/5248.html">极客学校：了解如何使用PowerShell自动化Windows</a><li><a href="/story/5071.html">如何使用PowerShell映射网络驱动器</a><li><a href="/story/2804.html">在PowerShell中添加带别名的快捷方式</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>