<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何使用PowerShell在Server 2008中创建多个用户</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何使用PowerShell在Server 2008中创建多个用户</h2></div><div class="content"><p>通过AD用户和计算机管理单元创建用户是一个非常简单的过程，但您经常会面临需要一次为一整组人创建帐户的情况。不过，这对您来说没有必要是一个耗时的过程，而且我们已经完成了所有繁重的任务，所以您不必这样做。</p><p>我们刚从人力资源部拿到一份新员工名单，他们非常友好地把它以EXCEL格式给了我们。确保您自己的Excel文件与相同的格式匹配，并确保使用名字和姓氏作为列标题。</p><img class="content_img" src="/image/44/44d06e07111ce4a4971f359a468c5366.png" /><p>我们要做的第一件事是将文件另存为.csv，为此，我们单击Office按钮并选择Save As。</p><img class="content_img" src="/image/95/951bcebda8a643185f79e6b96e161b0c.png" /><p>我们将文件命名为users.csv，并确保在Save as type框中选择CSV(逗号分隔)，然后单击Save。</p><img class="content_img" src="/image/e5/e50aeb8cc011625bf844389fd051ea3a.png" /><p>接下来，我们将在服务器上创建一个新的文本文档，我们将在其中创建用户。</p><img class="content_img" src="/image/77/770d3dcd33087a7964d9a2690a16ae35.png" /><p>然后，我们将把以下内容复制到我们的新文本文档中：</p><p>在第一行中，确保为您的域和要在其中创建用户的OU输入正确的信息。您还需要更新@sysadmingeek.com行以匹配您的域。</p><img class="content_img" src="/image/9d/9d23ba373f4697852bd2ed7fa58bec19.png" /><p>然后，我们希望将该文件另存为PowerShell脚本，因此我们将Save As type：更改为All Files(*)，并将其命名为PSusersScript.ps1。</p><img class="content_img" src="/image/b8/b816b2862a1c5dfde1de93a09c74afe9.png" /><p>现在，我们需要准备PowerShell来运行脚本。您可以通过单击任务栏中的快捷方式或在快速搜索框中键入PowerShell来启动PowerShell。</p><img class="content_img" src="/image/77/77cf691ab8b17c6d5cc2f18aed145981.png" /><p>我们需要更改Execution Policy以允许远程运行脚本，因此我们键入</p><p>出现提示时，我们键入Y，然后按Enter键执行。</p><img class="content_img" src="/image/05/05add4c3353cd7f26436d10f463f7815.png" /><p>现在我们已经允许运行脚本，我们需要将users.csv和PSusersScript.ps1文件都放在我们的文件夹中以供执行。由于PowerShell提示符自然会出现在根用户文件夹中，并且我们以管理员身份登录，因此我们将把它们放在C：UsersAdministrator文件夹中。当这两个文件都在文件夹中时，我们右键单击PSusersScript.ps1文件并选择Run with PowerShell。</p><img class="content_img" src="/image/34/34a292e096b12cc2b4ffddf617cb72dc.png" /><p>如果我们查看AD用户和计算机，您现在将看到您刚刚创建的所有新用户。</p><img class="content_img" src="/image/60/607445ea4bdf14d89ccaab72393b0d2f.png" /><p>新用户将以lastname.firstname格式创建，但是可以根据需要轻松更改脚本。既然您已经创建了脚本，将来要做的就是将您的用户列表放在C：UsersAdministrator文件夹中并运行PowerShell脚本。放轻松！</p><div class="item_info"><span class="item_key"><a href="/tag/用户/">用户</a></span><span class="item_key"><a href="/tag/创建/">创建</a></span><span class="item_key"><a href="/tag/powershell/">powershell</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/13420.html">每日新闻综述：T-Mobile和Sprint合并接近批准</a><li><a href="/story/13178.html">如何在Linux中确定当前用户帐户</a><li><a href="/story/13019.html">每日新闻综述：2019年3月12日的头条新闻</a><li><a href="/story/12720.html">如何让其他用户退出Windows 10</a><li><a href="/story/12413.html">这个奇怪的谷歌地图垃圾邮件是怎么回事？</a><li><a href="/story/11902.html">如何在Mac上更改您的用户资料图片</a><li><a href="/story/11837.html">如何在MacOS上设置来宾用户帐户</a><li><a href="/story/11801.html">为什么有些系统用户的Shell是/usr/bin/false？</a><li><a href="/story/11605.html">如何阻止Windows用户更改桌面背景</a><li><a href="/story/11253.html">如何禁用内置的“Windows键”快捷键</a><li><a href="/story/11099.html">为什么Linux允许用户删除根目录？</a><li><a href="/story/10724.html">有没有办法在Mozilla Firefox中强制启用Reader View？</a><li><a href="/story/10446.html">如何在Windows10的Ubuntu Bash Shell中更改您的用户帐户</a><li><a href="/story/10148.html">硬盘上的数据是否可以在不发出损坏警告的情况下降级？</a><li><a href="/story/9882.html">如何防止特定用户关闭Windows</a><li><a href="/story/9867.html">如何将本地组策略调整应用于特定用户</a><li><a href="/story/8052.html">如何安全地与来宾共享您的智能手机、计算机或平板电脑</a><li><a href="/story/7890.html">如何在Google Chrome中隐藏新用户配置文件名称按钮？</a><li><a href="/story/7290.html">为什么在使用Google Chrome浏览时，网站文本大小突然增加？</a><li><a href="/story/7056.html">如何在Chrome的稳定版和测试版频道中重新启用非Web Store扩展？</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>