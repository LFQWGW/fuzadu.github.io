<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何使用PowerShell在Server 2008中创建多个用户</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何使用PowerShell在Server 2008中创建多个用户</h2></div><div class="content"><p>通过AD用户和计算机管理单元创建用户是一个非常简单的过程，但您经常会面临需要一次为一整组人创建帐户的情况。不过，这对您来说没有必要是一个耗时的过程，而且我们已经完成了所有繁重的任务，所以您不必这样做。</p><p>我们刚从人力资源部拿到一份新员工名单，他们非常友好地把它以EXCEL格式给了我们。确保您自己的Excel文件与相同的格式匹配，并确保使用名字和姓氏作为列标题。</p><img class="content_img" src="/image/44/44d06e07111ce4a4971f359a468c5366.png" /><p>我们要做的第一件事是将文件另存为.csv，为此，我们单击Office按钮并选择Save As。</p><img class="content_img" src="/image/95/951bcebda8a643185f79e6b96e161b0c.png" /><p>我们将文件命名为users.csv，并确保在Save as type框中选择CSV(逗号分隔)，然后单击Save。</p><img class="content_img" src="/image/e5/e50aeb8cc011625bf844389fd051ea3a.png" /><p>接下来，我们将在服务器上创建一个新的文本文档，我们将在其中创建用户。</p><img class="content_img" src="/image/77/770d3dcd33087a7964d9a2690a16ae35.png" /><p>然后，我们将把以下内容复制到我们的新文本文档中：</p><p>在第一行中，确保为您的域和要在其中创建用户的OU输入正确的信息。您还需要更新@sysadmingeek.com行以匹配您的域。</p><img class="content_img" src="/image/9d/9d23ba373f4697852bd2ed7fa58bec19.png" /><p>然后，我们希望将该文件另存为PowerShell脚本，因此我们将Save As type：更改为All Files(*)，并将其命名为PSusersScript.ps1。</p><img class="content_img" src="/image/b8/b816b2862a1c5dfde1de93a09c74afe9.png" /><p>现在，我们需要准备PowerShell来运行脚本。您可以通过单击任务栏中的快捷方式或在快速搜索框中键入PowerShell来启动PowerShell。</p><img class="content_img" src="/image/77/77cf691ab8b17c6d5cc2f18aed145981.png" /><p>我们需要更改Execution Policy以允许远程运行脚本，因此我们键入</p><p>出现提示时，我们键入Y，然后按Enter键执行。</p><img class="content_img" src="/image/05/05add4c3353cd7f26436d10f463f7815.png" /><p>现在我们已经允许运行脚本，我们需要将users.csv和PSusersScript.ps1文件都放在我们的文件夹中以供执行。由于PowerShell提示符自然会出现在根用户文件夹中，并且我们以管理员身份登录，因此我们将把它们放在C：UsersAdministrator文件夹中。当这两个文件都在文件夹中时，我们右键单击PSusersScript.ps1文件并选择Run with PowerShell。</p><img class="content_img" src="/image/34/34a292e096b12cc2b4ffddf617cb72dc.png" /><p>如果我们查看AD用户和计算机，您现在将看到您刚刚创建的所有新用户。</p><img class="content_img" src="/image/60/607445ea4bdf14d89ccaab72393b0d2f.png" /><p>新用户将以lastname.firstname格式创建，但是可以根据需要轻松更改脚本。既然您已经创建了脚本，将来要做的就是将您的用户列表放在C：UsersAdministrator文件夹中并运行PowerShell脚本。放轻松！</p><div class="item_info"><span class="item_key"><a href="/tag/用户/">用户</a></span><span class="item_key"><a href="/tag/创建/">创建</a></span><span class="item_key"><a href="/tag/powershell/">powershell</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/13983.html">如何在Linux上使用chown命令</a><li><a href="/story/13801.html">每日新闻综合报道：微软意外向内部人士发送未经测试的Windows版本</a><li><a href="/story/13705.html">什么是松弛，为什么人们喜欢它？</a><li><a href="/story/13696.html">每日新闻综述：山寨三星更新App安装量达1000万</a><li><a href="/story/13436.html">如何在Linux上使用WALL命令</a><li><a href="/story/13420.html">每日新闻综述：T-Mobile和Sprint合并接近批准</a><li><a href="/story/13202.html">每日新闻综述，4/11/19：黑洞</a><li><a href="/story/13185.html">Stringify在五年后关闭</a><li><a href="/story/13182.html">每日新闻综合，4/8/19：Netflix扼杀AirPlay支持</a><li><a href="/story/13178.html">如何在Linux中确定当前用户帐户</a><li><a href="/story/13019.html">每日新闻综述：2019年3月12日的头条新闻</a><li><a href="/story/12720.html">如何让其他用户退出Windows 10</a><li><a href="/story/12515.html">PSA：伪造的App Store收据欺骗人们提供所有个人信息</a><li><a href="/story/12509.html">Windows10的10月份更新现已广泛发布，以下是获取更新的方法</a><li><a href="/story/12451.html">新的Android特洛伊木马使用贝宝的官方应用窃取你的钱</a><li><a href="/story/12413.html">这个奇怪的谷歌地图垃圾邮件是怎么回事？</a><li><a href="/story/12315.html">如何启用或禁用Windows 10用户帐户</a><li><a href="/story/11989.html">堡垒之夜安卓版已经过了测试版，所有兼容的手机都可以使用</a><li><a href="/story/11924.html">为什么网络隧道被称为“隧道”？</a><li><a href="/story/11902.html">如何在Mac上更改您的用户资料图片</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>