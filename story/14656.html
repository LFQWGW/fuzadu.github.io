<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何在Windows 10中自动连接到特定应用的VPN</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何在Windows 10中自动连接到特定应用的VPN</h2></div><div class="content"><img class="content_img" src="/image/74/749f5bd7b28c0395ed266205241d46c9.png" /><p>使用Windows 10的PowerShell cmdlet，您可以轻松添加应用程序，以便在它们启动时自动触发VPN连接。自动执行此任务意味着在使用某些应用程序时，您甚至不必考虑连接到VPN。</p><p>要利用PowerShell中的此功能，您必须首先向您的计算机添加VPN服务(如果您还没有VPN服务)。</p><p>相关：如何在Windows中连接到VPN</p><p>如何添加VPN自动触发</p><p>在Windows 10上设置VPN连接后，您需要打开提升的PowerShell实例。要执行此操作，请单击开始按钮，然后键入“powershell”。右键单击“Windows PowerShell”，然后从菜单中选择“以管理员身份运行”。</p><img class="content_img" src="/image/8b/8b0be33539ef7498b83d766b853377ef.png" /><p>在出现的允许访问您的计算机的提示中单击“是”。</p><p>在PowerShell窗口中，键入以下内容，并将&lt;VPNConnection&gt;和&lt;AppPath&gt;分别替换为VPN连接的名称和要使用的应用程序的文件路径：</p><p>Add-VpnConnectionTriggerApplication-Name“&lt;VPNConnection&gt;”-ApplicationID“”&lt;AppPath&gt;“</p><img class="content_img" src="/image/34/3451eb6d5830631190de48415ec5f051.png" /><p>确保在命令中包含引号。</p><p>按Enter键运行该命令。PowerShell会警告您默认情况下禁用拆分隧道。要继续，您必须在自动触发该功能之前确认并启用该功能。</p><p>出现提示时键入“Y”，然后再次按Enter键完成。</p><img class="content_img" src="/image/7a/7a6b30d94ea6a5fb2cc4fd68d315cbf6.png" /><p>您必须启用拆分隧道，自动触发器才能在没有人工干预的情况下连接到VPN。</p><p>当应用程序触发VPN启动时，拆分隧道会阻止Windows通过VPN路由所有网络流量。相反，它会拆分流量，只有来自列出的应用程序的数据才会流经VPN。</p><p>在PowerShell中键入Set-VpnConnection-Name“&lt;VPNConnection&gt;”-SplitTunnling$True，并将其替换为您的VPN名称(同样，请保留引号)，然后按Enter键。</p><img class="content_img" src="/image/4c/4c8f7d3439e9581f124967b093184ee5.png" /><p>接下来，如果您不小心关闭了应用程序，并且不想让连接终止，您可以设置一个超时缓冲区来重新启动应用程序。</p><p>在PowerShell中键入Set-VpnConnection-Name“&lt;VPNConnection&gt;”-IdleDisconnectSeconds&lt;IdleSeconds&gt;，然后按Enter键。将&lt;VPNConnection&gt;替换为您的连接名称，将&lt;IdleSeconds&gt;替换为连接终止前等待的秒数。</p><img class="content_img" src="/image/04/04a17ad801f9f1632c1d5db2008305f0.png" /><p>现在，当应用程序关闭时，Windows将等待10秒才会终止VPN连接。您可以随心所欲地设置此数字，也可以完全省略此步骤。</p><p>如何查看哪些应用程序会自动触发VPN</p><p>有几种方法可以检查您设置了哪些应用程序来触发VPN连接的启动。您可以在PowerShell中使用cmdlet，也可以在文件资源管理器中编辑电话簿文件。</p><p>相关：PowerShell与Windows命令提示符有何不同</p><p>如果VPN突然启动，并且您不确定原因，您可以使用以下任一方法来确定是哪个应用程序触发了它。</p><p>使用PowerShell Cmdlet</p><p>要使用此方法，请单击Start按钮并键入“powershell”。右键单击“Windows PowerShell”，然后从菜单中选择“以管理员身份运行”。</p><img class="content_img" src="/image/8b/8b0be33539ef7498b83d766b853377ef.png" /><p>在出现的允许访问您的计算机的提示中单击“是”。</p><p>在PowerShell窗口中，键入以下命令，但将&lt;VPNConnection&gt;替换为VPN连接的名称，然后按Enter键：</p><p>Get-VpnConnectionTrigger-ConnectionName&lt;VPNConnection&gt;</p><img class="content_img" src="/image/4b/4b33359e1dc0d2b7602168733f41c89b.png" /><p>在我们的示例中，该命令检索了VPN连接“vpn Canada”的触发器属性，并将其显示在下面。</p><p>使用文件资源管理器</p><p>另一种选择是在文件资源管理器中查找拨号电话簿文件。您可以在文本编辑器中打开它并查看触发VPN的应用程序列表。</p><p>电话簿文件为Windows提供了一种标准方式来收集和指定建立远程访问连接(RAS)所需的信息。该文件包含IP地址、端口、调制解调器设置以及(我们正在查找的)触发连接的应用程序等信息。</p><p>要开始使用，请打开文件资源管理器，将以下目录粘贴到地址栏中，但将&lt;user&gt;替换为当前用户名，然后按Enter键：</p><p>C：\Users\&lt;User&gt;\AppData\Roaming\Microsoft\Network\Connections\Pbk</p><img class="content_img" src="/image/0e/0e5fcfa645023acb6721a7f9348f8a82.png" /><p>右键单击“rkasphone.pbk”，然后选择要在其中打开文件的文本编辑器。</p><img class="content_img" src="/image/05/058d9804b60ac604a518accfdc0ab3f5.png" /><p>这一个文件包含您计算机上的所有VPN连接，因此如果您有多个VPN，您可能需要仔细检查才能找到您想要的应用程序。每个应用程序都存储在函数“ClassicApplicationIDs”下，作为其直接文件路径。</p><img class="content_img" src="/image/d8/d84fbdc0d4c17cf6516aeec71eec5146.png" /><p>幸运的是，如果您不想滚动查找每个应用程序，大多数文本编辑器都有查找功能。按Ctrl+F，在文本字段中键入“ClassicApplicationIds”，然后按Enter。</p><img class="content_img" src="/image/5d/5de0ec0b39ee3aec00c9b301f9716334.png" /><p>如何删除VPN自动触发</p><p>如果您意外添加了错误的应用程序，或者不再希望在启动特定应用程序时触发VPN，您可以使用PowerShell中的类似cmdlet将其删除。</p><p>相关：极客学校：学习在PowerShell中使用Cmdlet</p><p>要删除VPN自动触发，请单击开始按钮，然后键入“powershell”。右键单击“Windows PowerShell”，然后从菜单中选择“以管理员身份运行”。</p><img class="content_img" src="/image/8b/8b0be33539ef7498b83d766b853377ef.png" /><p>在出现的允许访问您的计算机的提示中单击“是”。</p><p>在PowerShell窗口中，键入以下内容，但将&lt;VPNConnection&gt;和&lt;AppPath&gt;分别替换为VPN连接的名称和应用程序的路径：</p><p>Remove-VpnConnectionTriggerApplication-Name“&lt;VPNConnection&gt;”-ApplicationID“”&lt;AppPath&gt;“</p><img class="content_img" src="/image/49/49c7595828f3a40d3f96ea421931e2df.png" /><p>对要从列表中删除的每个应用程序重复此步骤。</p><p>现在，当您启动指定的应用程序时，Windows将启动VPN连接并通过它发送流量-不需要第三方软件。</p><div class="item_info"><span class="item_key"><a href="/tag/应用程序/">应用程序</a></span><span class="item_key"><a href="/tag/vpn/">vpn</a></span><span class="item_key"><a href="/tag/lt/">lt</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14813.html">为什么你的iPhone一直询问后台位置使用情况</a><li><a href="/story/14697.html">如何在Windows 10中自动连接到特定应用的VPN</a><li><a href="/story/14655.html">如何在Windows 10中自动连接到特定应用的VPN</a><li><a href="/story/14632.html">如何将您的Apple Card交易导出到电子表格</a><li><a href="/story/14631.html">如何将您的Apple Card交易导出到电子表格</a><li><a href="/story/14630.html">如何将您的Apple Card交易导出到电子表格</a><li><a href="/story/14629.html">如何将您的Apple Card交易导出到电子表格</a><li><a href="/story/14578.html">如何在iPhone或iPad上“隐藏”应用程序</a><li><a href="/story/14520.html">如何在三星手机上启用安全文件夹</a><li><a href="/story/14402.html">假期的12条家庭技术支持小贴士</a><li><a href="/story/14352.html">我的iPhone或iPad会感染病毒吗？</a><li><a href="/story/14277.html">如何在Ubuntu上创建桌面快捷方式</a><li><a href="/story/14212.html">MacOS Catalina的新安全功能如何工作</a><li><a href="/story/14198.html">如何在Android上设置应用时限和拦截应用</a><li><a href="/story/14180.html">什么是Windows 10X，它有什么不同？</a><li><a href="/story/14134.html">如何让iPhone应用始终请求位置访问</a><li><a href="/story/14132.html">如何自定义iPhone或iPad上的共享表</a><li><a href="/story/14113.html">如何为Twitter启用双因素身份验证</a><li><a href="/story/14110.html">如何在iPad上使用一个应用程序的多个窗口</a><li><a href="/story/14101.html">如何更新iPhone和iPad应用程序</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>