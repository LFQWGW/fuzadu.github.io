<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何将SQL数据库备份到网络共享</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何将SQL数据库备份到网络共享</h2></div><div class="content"><p>必须定期备份SQL数据库。我们已经介绍了可以轻松将所有SQL Server数据库备份到本地硬盘的方法，但这不能防止驱动器和/或系统出现故障。作为针对此类灾难的额外保护层，您可以在网络共享上复制或直接创建备份。</p><p>本地备份，然后复制到网络共享</p><p>完成此任务的首选且最直接的方法是创建数据库的本地备份，然后将相应的备份文件复制到网络共享。您可以通过创建如下所示的批处理脚本来执行此操作：</p><p>此脚本执行以下操作(逐行)：</p><p>
将变量设置为本地SQL备份目录。
创建MyDB的SQL备份(使用Windows身份验证)到本地SQL备份目录。
将本地备份文件复制到网络共享。
删除本地备份文件。</p><p>同样，这是首选方法，因为它开箱即用，而且备份失败的可能性最小，因为备份是在本地磁盘上创建的。但是，如果没有足够的磁盘空间来存储备份文件的本地副本，则此操作将失败。在这种情况下，您将需要将额外的磁盘空间或备份直接添加到网络共享。</p><p>直接备份到网络共享</p><p>通常，当您尝试使用以下命令直接创建到网络共享的备份时：</p><p>您很可能会收到类似以下内容的错误：</p><p>尽管您使用Windows身份验证(-E开关)运行SQL备份命令，并且Windows帐户能够通过Windows资源管理器访问文件并将文件拷贝到共享，但仍会发生此错误。</p><img class="content_img" src="/image/a2/a260523bfd7a7ef084e8b3cfd804280a.png" /><p>此操作失败的原因是因为SQL命令是在运行SQL Server服务的帐户范围内执行的。当您查看计算机上的“服务”列表时，很可能会看到SQL Server服务以本地系统帐户或网络服务帐户(“登录身份”列)的身份运行，它们是没有网络访问权限的系统帐户。</p><p>在我们的系统上，备份到网络共享命令失败，因为我们以本地系统身份运行SQL Server服务，该服务同样无法访问任何网络资源。</p><img class="content_img" src="/image/b2/b2d654dc480a11f65cd5cfbe88d252ba.png" /><p>为了允许SQL直接备份到网络共享，我们必须以具有网络资源访问权限的本地帐户运行SQL Server服务。</p><p>编辑SQL Server服务的属性，并在“登录”选项卡上，将该服务配置为以具有网络访问权限的备用帐户运行。</p><img class="content_img" src="/image/b7/b71b21c9d78eb25b39df1da47ff4aaf8.png" /><p>单击“确定”后，系统将提示您在重新启动服务后设置才会生效。</p><img class="content_img" src="/image/74/74525a43db91b3674bf234d3ea626746.png" /><p>重新启动该服务。</p><img class="content_img" src="/image/f9/f91c80ed38daaed3249f9feaa97c230b.png" /><p>服务列表现在应该显示SQL Server服务正在以您配置的帐户运行。</p><img class="content_img" src="/image/42/42ebc7eb96ef371d4c46ff4e11c799cf.png" /><p>现在，当您运行命令直接备份到网络共享时：</p><p>您应该会看到一条成功消息：</p><p>备份文件现在位于网络共享目录中：</p><img class="content_img" src="/image/b0/b0d9754d80b55dbf8772f43602d6d92d.png" /><p>网络共享注意事项</p><p>请务必注意，备份命令希望能够直接连接到网络共享，而无需提示输入凭据。您已将SQL Server服务配置为以其身份运行的帐户必须与相应凭据允许访问的网络共享具有可信连接，否则可能会发生如下错误：</p><p>此错误表示网络共享未接受帐户的用户名和密码，命令失败。</p><p>另一个要记住的问题是，备份直接执行到网络资源，因此网络连接中的任何故障都可能导致备份失败。因此，您应该只备份到稳定的网络位置(即可能不是VPN)。</p><p>安全影响</p><p>如前所述，首选使用本地备份然后复制到网络共享的方法，因为它允许您以仅具有本地系统访问权限的帐户运行SQL服务。</p><p>通过将服务作为备用帐户运行，您就为潜在的安全问题打开了大门。例如，恶意SQL脚本可能在备用帐户下执行并攻击网络资源。此外，对各个帐户的任何更改(密码更改/过期或帐户删除/禁用)都将导致SQL Server服务无法启动。</p><p>如果您确实使用备用帐户运行SQL Server实例，请牢记这些要点，这一点很重要。如果采取了适当的预防措施，虽然这些不会停止显示，但您应该考虑添加额外的硬盘空间，然后实施本地备份和复制，以便可以使用本地帐户运行SQL服务。</p><div class="item_info"><span class="item_key"><a href="/tag/备份/">备份</a></span><span class="item_key"><a href="/tag/帐户/">帐户</a></span><span class="item_key"><a href="/tag/网络共享/">网络共享</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14769.html">如何使用Google One备份和恢复Android</a><li><a href="/story/14354.html">如何在没有iTunes的情况下备份和恢复iPhone或iPad</a><li><a href="/story/14104.html">为什么您需要此软件将数据迁移到新iPhone[赞助帖子]</a><li><a href="/story/13918.html">想要在勒索软件中幸存下来吗？以下是如何保护您的PC</a><li><a href="/story/13820.html">如何将应用程序和游戏恢复到iPhone或iPad</a><li><a href="/story/12997.html">如何使用Google Drive备份和恢复WhatsApp消息</a><li><a href="/story/12803.html">如何恢复iPhone或iPad上删除的照片</a><li><a href="/story/12151.html">如何使用恢复模式修复Mac启动问题</a><li><a href="/story/12150.html">如何将Mac的图片库备份到外部驱动器</a><li><a href="/story/12110.html">备份Mac的最佳方式</a><li><a href="/story/11963.html">不要在第一天就升级到最新的操作系统</a><li><a href="/story/11733.html">通过从备份中排除这些文件夹来节省Time Machine Drive上的空间</a><li><a href="/story/11725.html">如何从iPhone或iPad恢复已删除的iMessage</a><li><a href="/story/11648.html">如何验证您的Mac的Time Machine备份是否正常工作</a><li><a href="/story/11312.html">如何在Windows中备份和恢复便签</a><li><a href="/story/11165.html">如何在外部驱动器上创建整个Mac的可引导备份</a><li><a href="/story/11127.html">永不再丢失照片：完整的防弹照片备份指南</a><li><a href="/story/11033.html">PSA：即使您的备份驱动器没有插入，您也可以使用Time Machine</a><li><a href="/story/11015.html">如何将数据从旧iPhone迁移到新iPhone</a><li><a href="/story/10867.html">如何在Android上将短信备份到Dropbox或Google Drive</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>