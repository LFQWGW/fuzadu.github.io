<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Shell脚本初学者指南：基础知识</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>Shell脚本初学者指南：基础知识</h2></div><div class="content"><img class="content_img" src="/image/ea/eac713f3f0a79e579a7c53a78afb499e.png" /><p>术语“shell脚本”在Linux论坛中经常被提及，但许多用户并不熟悉它。学习这种简单而强大的编程方法可以帮助您节省时间，更好地学习命令行，并消除乏味的文件管理任务。</p><p>什么是Shell脚本？</p><p>作为Linux用户意味着您可以使用命令行。不管你喜不喜欢，有些事情通过这个界面比通过点击和点击要容易得多。您使用和学习命令行的次数越多，就越能看到它的潜力。嗯，命令行本身就是一个程序：shell。现在大多数Linux发行版都使用Bash，这才是您真正要向其中输入命令的地方。</p><p>现在，你们中一些在使用Linux之前使用Windows的人可能还记得批处理文件。这些都是小的文本文件，您可以用要执行的命令填充它们，Windows将依次运行它们。这是一种巧妙而整洁的方式来完成一些事情，比如当你不能打开系统文件夹或创建快捷方式时，在高中计算机实验室里运行游戏。Windows中的批处理文件虽然有用，但却是对shell脚本的廉价模仿。</p><img class="content_img" src="/image/1d/1d63525448b3896076924d9f2c6efb0e.png" /><p>shell脚本允许我们以链形式编写命令，并让系统将它们作为脚本事件执行，就像批处理文件一样。它们还允许更有用的功能，例如命令替换。您可以调用命令，如date，并将其输出用作文件命名方案的一部分。您可以自动执行备份，每个复制的文件都可以将当前日期附加到其名称的末尾。脚本也不仅仅是命令的调用。它们本身就是程序。脚本允许您直接在操作系统界面中使用编程函数，如‘for’循环、if/Then/Else语句等。而且，您不必学习另一种语言，因为您使用的是您已经知道的东西：命令行。</p><p>我认为这就是脚本的力量所在。您可以使用您已经知道的命令进行编程，同时学习大多数主要编程语言的主要功能。需要做一些重复和乏味的事情吗？把它写下来！对于一个非常复杂的命令，需要一条捷径吗？把它写下来！想要为某些东西构建一个真正易于使用的命令行界面吗？把它写下来！</p><p>在你开始之前</p><p>在开始我们的脚本编写系列之前，让我们先介绍一些基本信息。我们将使用bash shell，这是大多数Linux发行版本机使用的。Mac OS用户可以使用Bash，Windows上也可以使用Cygwin。既然它是如此通用，那么您应该能够编写脚本，而不管您的平台是什么。此外，只要引用的所有命令都存在，脚本就可以在多个平台上运行，几乎不需要任何调整。</p><p>脚本编写可以很容易地利用“管理员”或“超级用户”权限，因此最好在将脚本投入使用之前对其进行测试。还要使用常识，比如确保您有要对其运行脚本的文件的备份。使用正确的选项(如rm命令的-i)也非常重要，这样就需要进行交互。这可以防止一些严重的错误。因此，请通读您下载的脚本，并小心处理您拥有的数据，以防出错。</p><p>就其核心而言，脚本只是纯文本文件。您可以使用任何文本编辑器来编写它们：gedit、emacs、vim、Nano…。这份清单不胜枚举。只需确保将其另存为纯文本，而不是富文本或Word文档。因为我喜欢Nano提供的易用性，所以我将使用它。</p><p>脚本权限和名称</p><p>脚本的执行方式与程序类似，要实现这一点，脚本需要具有适当的权限。您可以通过在脚本上运行以下命令使其成为可执行脚本：</p><p>这将允许任何人运行该特定脚本。如果要将其限制为仅供您的用户使用，则可以改用以下命令：</p><p>要运行此脚本，您必须通过cd进入正确的目录，然后按如下方式运行该脚本：</p><p>为方便起见，您可以将脚本放在主目录的“bin”文件夹中：</p><p>在许多现代发行版中，默认情况下不再创建此文件夹，但您可以创建它。这通常是存储属于您的用户而不是其他用户的可执行文件的位置。通过将脚本放在这里，您可以像其他命令一样，通过键入它们的名称来运行它们，而不是必须四处转悠并使用“./”前缀。</p><p>不过，在命名脚本之前，您应该使用以下命令检查是否安装了使用该名称的程序：</p><p>很多人将他们早期的脚本命名为“test”，当他们试图在命令行中运行它时，什么都没有发生。这是因为它与test命令冲突，后者在没有参数的情况下什么也不做。始终确保您的脚本名称不与命令冲突，否则您可能会发现自己正在做您不想做的事情！</p><p>脚本编写指南</p><img class="content_img" src="/image/27/2776be8f87c840c9227a3ecc0d389fd0.png" /><p>正如我前面提到的，每个脚本文件本质上都是纯文本。不过，这并不意味着你可以随心所欲地写下你想写的东西。当试图执行文本文件时，Shell将解析它们，以寻找它们是否是脚本以及如何正确处理所有内容的线索。正因为如此，有几条准则你需要知道。</p><p>
每个脚本都应该带有“#！/bin/bash”
每一个新行都是一个新命令。
注释行以#开头。
命令用()括起来</p><p>Hash-Bang黑客</p><p>当Shell解析文本文件时，将该文件标识为脚本的最直接方法是在第一行：</p><p>如果您使用另一个shell，请在此处替换其路径。注释行以散列(#)开头，但添加bang(！)。之后的shell路径是一种黑客攻击，它将绕过此注释规则，并强制脚本使用此行所指向的shell执行。</p><p>新行=新建命令</p><p>每一个新行都应该被视为一个新命令，或者是一个更大系统的组件。例如，IF/THEN/ELSE语句将占据多行，但该系统的每个组件都在新行中。不要让命令溢出到下一行，因为这可能会截断前一个命令，并在下一行给您一个错误。如果您的文本编辑器正在执行此操作，则出于安全考虑，您应该关闭文本换行。按ALT+L可以关闭纳比特换行。</p><p>评论时经常使用#s</p><p>如果以#开始行，则该行将被忽略。这会将其转换为注释行，您可以在其中提醒自己上一条命令的输出是什么，或者下一条命令将执行什么操作。同样，关闭文本换行，或者将您的注释分成多行，这些行都以散列开头。使用大量注释是一个很好的做法，因为它可以让您和其他人更容易地调整您的脚本。唯一的例外是前面提到的Hash-Bang黑客攻击，所以不要在#s后面加上！s；-)</p><p>命令用括号括起来</p><p>在以前，命令替换使用单个勾号(`，共享~键)。我们还不打算触及这一点，但是由于大多数人在学习了基础知识之后就离开去探索了，所以提到您应该使用括号来代替可能是个好主意。这主要是因为当您将命令嵌套放入其他命令中时，括号效果更好。</p><p>你的第一个剧本</p><p>让我们从一个简单的脚本开始，该脚本允许您复制文件并将日期附加到文件名的末尾。我们就叫它“DateCP”吧。首先，让我们检查一下该名称是否与某些内容冲突：</p><img class="content_img" src="/image/62/622d93e26b8d58ff8f646d243753704b.png" /><p>您可以看到Which命令没有输出，因此我们都设置为使用此名称。</p><p>让我们在~/bin文件夹中创建一个空文件：</p><img class="content_img" src="/image/b7/b79d5d7483aef24d5e0e9b9e6c82084c.png" /><p>现在，让我们在忘记之前更改权限：</p><img class="content_img" src="/image/f7/f77461e10050e6f679ab2f3022a72303.png" /><p>那么让我们开始构建我们的脚本吧。在您选择的文本编辑器中打开该文件。就像我说的，我喜欢纳米的简单。</p><p>接下来，让我们将先决条件放入第一行，并对此脚本的功能进行注释。</p><img class="content_img" src="/image/66/660c0217500971d8ed4cb380148c16da.png" /><p>接下来，让我们声明一个变量。如果你学过代数，你可能知道那是什么。变量允许我们存储信息并对其进行操作。在其他地方引用变量时，变量可以“展开”。也就是说，他们将显示他们存储的内容，而不是显示他们的名字。您可以稍后告诉同一变量存储不同的信息，之后发生的任何指令都将使用新信息。这是个非常花哨的占位符。</p><p>我们将在输出变量中放入什么？那么，让我们存储日期和时间吧！为此，我们将调用date命令。</p><p>请看下面的屏幕截图，了解如何构建date命令的输出：</p><img class="content_img" src="/image/43/438e523c400a75afea7b8587135d4551.png" /><p>您可以看到，通过添加以%开头的不同变量，可以将命令的输出更改为您想要的。有关详细信息，您可以查看DATE命令的手册页。</p><p>让我们使用date命令最后一次迭代“date+%m_%d_%y-%h%m%S”，并在脚本中使用它。</p><img class="content_img" src="/image/42/42c73d74578540be69810cf62b318274.png" /><p>如果我们现在保存这个脚本，我们可以运行它，它会像我们预期的那样给出date命令的输出：</p><img class="content_img" src="/image/b1/b1cf2f4e468111590833c4da0187da81.png" /><p>但是，让我们做一些不同的事情。让我们给这个命令指定一个变量名，比如DATE_FORMACTED。此操作的正确语法如下所示：</p><p>对我们来说，我们会这样建造它：</p><img class="content_img" src="/image/59/5921d2360279258e75c8b28fb4e4909e.png" /><p>这就是我们所说的命令替换。我们实际上是告诉bash，无论何时出现变量“DATE_FORMACTED”，都要在括号内运行该命令。然后，应该显示命令给出的任何输出，而不是变量的名称“DATE_FORMACTED”。</p><p>以下是示例脚本及其输出：</p><img class="content_img" src="/image/3a/3a33382ec06a7949567e494e596a278f.png" /><img class="content_img" src="/image/1b/1bb9cc85596d64362178567d3d482514.png" /><p>请注意，输出中有两个空格。ECHO命令引号内的空格和变量前面的空格都会显示。如果您不想让他们出现，请不要使用空格。还要注意，如果没有添加的“echo”行，脚本绝对不会给出任何输出。</p><p>让我们回到我们的剧本上。接下来，让我们添加该命令的复制部分。</p><img class="content_img" src="/image/92/9244be45908a68d6c0d3fb669b4c36ee.png" /><p>这将调用带有-i和-v选项的copy命令。前者将在覆盖文件之前要求您进行验证，而后者将在命令行上显示正在关闭的内容。</p><p>接下来，您可以看到我添加了“$1”选项。在编写脚本时，美元符号($)后跟一个数字将表示调用脚本时该脚本的编号参数。例如，在以下命令中：</p><p>第一个参数是“trogdor2.mp3”，第二个参数是“ringtone.mp3”。</p><p>回过头来看我们的脚本，我们可以看到我们引用了两个参数：</p><img class="content_img" src="/image/b7/b76410d6164c123bc3b07f76bfc7cd2d.png" /><p>这意味着当我们运行脚本时，需要提供两个参数才能使脚本正确运行。第一个参数$1是将被复制的文件，并被替换为“cp-iv”命令的第一个参数。</p><p>第二个参数$2将充当同一命令的输出文件。但是，你也可以看到它是不同的。我们添加了一个句点，并引用了上面的“DATE_FORMACTED”变量。好奇这是做什么用的吗？</p><p>以下是脚本运行时发生的情况：</p><img class="content_img" src="/image/b9/b9289d08e10140d0dae4fd45ea93b231.png" /><p>您可以看到，输出文件按照我为$2输入的内容列出，后跟一个句点，然后是date命令的输出！很有道理，对吧？</p><p>现在，当我运行datecp命令时，它将运行此脚本，并允许我将任何文件复制到新位置，并自动将日期和时间添加到文件名的末尾。对存档东西很有用！</p><p></p><p>shell脚本是让您的操作系统为您工作的核心。您也不必学习一门新的编程语言来实现它。试着在家里用一些基本命令编写脚本，然后开始想一想你可以用它来做什么。</p><p></p><p>你有剧本吗？对新手有什么建议吗？在评论中分享你的想法！本系列还会有更多内容！</p><div class="item_info"><span class="item_key"><a href="/tag/脚本/">脚本</a></span><span class="item_key"><a href="/tag/命令/">命令</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14323.html">如何在Windows上将Caps Lock用作修改键</a><li><a href="/story/14159.html">如何在Bash中使用变量</a><li><a href="/story/13819.html">如何将GUI添加到Linux Shell脚本</a><li><a href="/story/13415.html">如何在Linux上使用yes命令</a><li><a href="/story/13180.html">如何使用脚本编辑器为Google应用程序增压</a><li><a href="/story/13172.html">如何使用Linux睡眠命令暂停Bash脚本</a><li><a href="/story/13147.html">如何在进程退出时自动关闭MacOS终端</a><li><a href="/story/13134.html">如何编写自动热键脚本</a><li><a href="/story/12894.html">如何从Bash脚本获取系统的地理位置</a><li><a href="/story/11595.html">如何使用自动热键创建自定义键盘快捷键</a><li><a href="/story/11555.html">如何在Windows中自动键入带双空格的句点</a><li><a href="/story/11135.html">如何恢复Chromebook的原始BIOS和软件(如果已擦除)</a><li><a href="/story/10454.html">如何在Windows 10上创建和运行Bash Shell脚本</a><li><a href="/story/9334.html">如何使用Geektool自定义您的Mac桌面</a><li><a href="/story/7708.html">如何配置Windows以更轻松地使用PowerShell脚本</a><li><a href="/story/7704.html">如何使用批处理文件使PowerShell脚本更易于运行</a><li><a href="/story/7689.html">作用域如何影响PowerShell脚本</a><li><a href="/story/7581.html">使用Google Sheet和Google Apps脚本可以做的8件非常有用的事情</a><li><a href="/story/7410.html">愚蠢的极客小把戏：如何让你的电脑与你对话</a><li><a href="/story/7370.html">在Windows上使窗口始终在最上面的3种最佳方法</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>