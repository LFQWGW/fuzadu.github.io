<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>极客学校：使用PowerShell获取计算机信息</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>极客学校：使用PowerShell获取计算机信息</h2></div><div class="content"><img class="content_img" src="/image/20/207ea41ab315096bfcdb3ed62317373a.png" /><p>WMI和它的新兄弟CIM都可以用来管理您环境中的Windows计算机。但是你知道它们之间的区别吗？请加入我们的行列，一起来看一看。</p><p>请务必阅读本系列的前几篇文章：</p><p>
了解如何使用PowerShell自动化Windows。
学习在PowerShell中使用Cmdlet。
了解如何在PowerShell中使用对象。
在PowerShell中学习格式化、筛选和比较。
学习在PowerShell中使用远程处理</p><p>在接下来的一周里，我们将继续关注这一系列的节目。</p><p>采用 / 介绍 / 引进</p><p>WMI代表Windows Management Instrumentation。“仪器”一词指的是这样一个事实，即WMI允许您获取有关计算机内部状态的信息，就像您汽车中的仪表板仪器可以检索和显示有关汽车内部组件状态的信息一样。</p><p>WMI由一个存储库组成，该存储库包含表示可以在您的计算机中管理的组件的类。我们的意思是，仅仅因为WMI有一个Win32_Battery类并不意味着您的机器包含电池。然后，可以使用一种与SQL非常相似的查询语言(称为WQL)在本地甚至跨网络查询这些类的信息。然而，众所周知，WMI非常不可靠，这主要是因为它是基于RPC(远程过程调用)的事实，RPC(远程过程调用)会用它们选择的通信端口做一些疯狂的事情。</p><p>从Windows 8和Server 2012开始，WMI逐渐被淘汰，取而代之的是通用信息模型(Common Information Model，简称CIM)。WMI和CIM之间的唯一区别是它们使用的传输协议。WMI使用远程过程调用执行查询，而CIM使用HTTP，这似乎有很大的不同。在后端，他们仍然在与同一个信息库对话。</p><p>使用WMI</p><p>通过WMI浏览可用的信息的最快捷、最简单的方法是获取任何免费的WMI对象浏览器的副本。我们喜欢这件。下载后，启动它，您将有一个图形界面来浏览WMI类。</p><img class="content_img" src="/image/e8/e80f1eba56c16044cba6a755e758d291.png" /><p>如果您要查找有关计算机磁盘配置的信息，请按Ctrl+F组合键调出搜索框，然后键入“logicaldisk”并按Enter键。</p><img class="content_img" src="/image/5f/5fef69b0aa9f9ec6a8fcb2992a70958f.png" /><p>这将立即将您带到Win32_LogicalDisk类。</p><img class="content_img" src="/image/f0/f04cd5e226fe25cd266bb629fd26f63b.png" /><p>在应用程序的下半部分，您可以看到我们有两个类实例。</p><img class="content_img" src="/image/76/762a1dd0ace37acdd4739961befbbffd.png" /><p>一旦我们有了我们要找的类，从PowerShell查询就很简单了。</p><img class="content_img" src="/image/e9/e91e0f87f7b37a0c272c4942658aed39.png" /><p>我已经有一段时间没有看到这种语法了，因为最近人们更喜欢使用新的参数化语法。</p><img class="content_img" src="/image/ed/ed376c6b5b232063621b90760901b10f.png" /><p>如果要从网络上的另一台计算机获取信息，只需使用ComputerName参数即可。</p><img class="content_img" src="/image/dc/dcbaee028723afaeeda69b709886bc08.png" /><p>使用CIM</p><p>请记住，CIM仅在Windows 8和Server 2012上可用，前进这一步绝对是大势所趋。</p><img class="content_img" src="/image/b9/b9022af061d0bff15edfcf0be1439f5c.png" /><p>在使用Get-CimInstance时，还有-ClassName参数的制表符补全，这表明今后这将是微软的工作重点。</p><p>事实上，WMI是由微软内部一个完全不同的团队开发的，但后来被PowerShell的负责人接管。正是他们注意到，要清理WMI留下的烂摊子将是非常困难的。为了纠正这种情况，他们试图通过编写在引擎盖下使用WMI和CIM的包装器cmdlet来使WMI和CIM更可用。检查cmdlet是否为包装的唯一方法是查看文档。例如，Get-hotfix cmdlet是Win32_QuickFixEngineering类的包装，如文档中所示。</p><img class="content_img" src="/image/16/16bcf2d8de8cb00f1251687e27062c59.png" /><p>这意味着您可以使用Get-hotfix cmdlet而不是WMI查询来获取远程计算机上的修补程序。</p><img class="content_img" src="/image/63/63d327c2207b1e6e5f65e48fe3580848.png" /><p>所以你找到了。只需记住，如果有专用的cmdlet，您将始终想要使用它，如果cmdlet不存在，则紧随其后的是CIM。最后，如果所有其他方法都失败了，或者您的环境中有较旧的计算机，您将需要使用WMI。这就是我这次所有的东西。明天见，更多的PowerShell乐趣。</p><div class="item_info"><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/wmi/">wmi</a></span><span class="item_key"><a href="/tag/计算机/">计算机</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14706.html">如何在Linux上使用uniq命令</a><li><a href="/story/14624.html">解释的Linux文件时间戳：atime、mtime和ctime</a><li><a href="/story/14585.html">如何在Microsoft Excel中兑换货币</a><li><a href="/story/14577.html">如何检查Linux上安装了哪个GPU</a><li><a href="/story/14572.html">如何使用Jouralctl读取Linux系统日志</a><li><a href="/story/14570.html">如何在Linux上使用grep命令</a><li><a href="/story/14555.html">2020年CES最佳：我们今年看到的所有最好的东西</a><li><a href="/story/14550.html">如何在Linux上使用Tail命令</a><li><a href="/story/14542.html">如何从MacOS Catalina向iPhone添加自定义铃声</a><li><a href="/story/14508.html">如何使用键盘快捷键简化流媒体Netflix</a><li><a href="/story/14507.html">如何在Linux上使用HISTORY命令</a><li><a href="/story/14499.html">如何在Linux上使用免费命令</a><li><a href="/story/14467.html">如何在Windows 10上切换到本地用户帐户</a><li><a href="/story/14466.html">如何在Linux上使用at和Batch来调度命令</a><li><a href="/story/14461.html">如何设置您的新Mac</a><li><a href="/story/14450.html">如何在Excel中将一长列变为多列</a><li><a href="/story/14438.html">如何在iPhone上创建和使用Memoji和Animoji</a><li><a href="/story/14434.html">Chrome 79的新特性，现已推出</a><li><a href="/story/14426.html">如何使用Google Sheets中的查询功能</a><li><a href="/story/14424.html">如何向Outlook会议请求添加默认签名</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>