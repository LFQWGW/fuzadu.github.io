<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何在Linux或MacOS终端中使用Bash历史记录</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何在Linux或MacOS终端中使用Bash历史记录</h2></div><div class="content"><img class="content_img" src="/image/cf/cf2de5c37f9734335370aae6701443d0.png" /><p>bash shell是大多数Linux发行版附带的标准终端环境，包含在MacOS中，可用于在Windows 10上安装。它会记住您键入的命令并将其存储在历史文件中。您可能知道一些bash历史的基础知识，但它的功能比您可能意识到的要强大得多。</p><p>键盘快捷键</p><p>相关：Bash的最佳键盘快捷键(也就是Linux和MacOS终端)</p><p>要滚动浏览bash历史记录，您可以使用bash的许多有用的键盘快捷键中的几个。按下这些快捷键，您以前使用过的命令将出现在提示符下。</p><p>
向上箭头或Ctrl+P：转到历史记录中的上一个命令。多次按键可倒退浏览您使用过的命令。
向下箭头或Ctrl+N：转到历史记录中的下一个命令。多次按键向前浏览您使用过的命令。
Alt+R：如果在当前行上编辑了历史记录中的命令，则恢复对该命令所做的任何更改。</p><p>Bash还有一个特殊的“调用”模式，您可以使用它来搜索以前运行过的命令，而不是逐个滚动它们。</p><p>
Ctrl+R：调用与您提供的字符匹配的最后一个命令。按此快捷键并开始键入以在bash历史记录中搜索命令。
Ctrl+O：使用Ctrl+R运行找到的命令。
Ctrl+G：在不运行命令的情况下退出历史搜索模式。</p><img class="content_img" src="/image/43/433b546a6cc4264c95f4c76b763766a6.png" /><p>查看您的Bash历史记录</p><p>您可以通过运行以下命令将整个bash历史记录打印到屏幕上：</p><code>history</code><p>您将看到bash历史记录中所有命令的列表，每个命令的左侧都有一个数字。旁边带有“1”的命令是bash历史记录中最旧的命令，而编号最高的命令是最新的。</p><img class="content_img" src="/image/1a/1a23687b2d93c3dc3075d1ef37b77dc8.png" /><p>相关：使用以下8个技巧成为Linux终端高级用户</p><p>您可以随心所欲地处理输出。例如，您可以通过管道将其传递给grep命令，以搜索您的命令历史记录。</p><code>history | grep your_search</code><img class="content_img" src="/image/28/28fdc178da06fcafe8f0f15e876612b2.png" /><p>您还可以通过管道将其传递给Tail命令，以便只查看您最近运行的一小部分命令。例如，以下命令将显示历史记录中的最后5个条目。</p><code>history | tail -5</code><img class="content_img" src="/image/d3/d33ad79525bb819abaca8fb7b2d4d579.png" /><p>从您的历史记录中运行命令</p><p>Bash可以快速“扩展”之前的命令，或者对它们进行扩展和修改。此功能称为“历史扩展”，并使用一个感叹号，称为“bang”。只需在提示符下键入它们，然后按Enter键就可以像运行任何其他命令一样运行它们。</p><p>要从历史记录中按其编号运行特定命令，请使用以下命令：</p><code>!#</code><p>例如，假设您想从bash历史记录运行第12个命令。这就是当您运行HISTORY命令时，左边带有“12”的命令。您可以键入以下命令。</p><code>!12</code><img class="content_img" src="/image/a8/a8a4f3858e558cf376a97a6d17b963d7.png" /><p>要重新运行您上次运行的命令，请键入以下命令。这与按一次向上箭头查看上一个命令，然后按Enter键的效果相同。</p><code>!!</code><p>您还可以向后引用某个命令的特定行数。例如，！-2将运行您运行的倒数第二个命令。！！意思和！-1一样。</p><img class="content_img" src="/image/11/11f6f9e4c4477daf9d471ebacf6e2c75.png" /><p>此扩展适用于生产线上的任何位置。您可以在本节中的！！或任何其他表达式之前或之后添加您喜欢的任何内容。例如，您可以键入以下命令来重新运行您通过sudo运行的最后一个命令，并赋予它root权限。如果您在运行命令之前忘记添加.sudo，这将特别有用。</p><code>sudo !!</code><p>或者，例如，您可以重新运行前面的命令，并通过管道将其输出传递给grep以搜索一些文本。</p><code>!! | grep text</code><img class="content_img" src="/image/01/01ecb04d5351b8937523d0bffef2b736.png" /><p>要在您的历史记录中搜索命令并运行它，请键入以下内容。这将运行与您指定的文本匹配的最后一个命令：</p><code>!text</code><p>因此，如果您最近运行了一个以ping开头的命令，您可以运行以下命令来搜索它。这将向后搜索您的历史记录，找到以“pi”开头的最新命令，并立即运行它：</p><code>!pi</code><img class="content_img" src="/image/ba/ba442aef9df211968cfc951f7618d3d3.png" /><p>您可以将：p附加到上面的任何扩展中，bash会将命令打印到终端，而不会运行它。如果您想在运行之前确认选择的命令是正确的，这将非常有用。</p><code>!12:p</code><code>!!:p</code><code>!text:p</code><img class="content_img" src="/image/a3/a30f2f75fce17ea6a21c0e76318012f5.png" /><p>重用历史记录中的参数</p><p>Bash还允许您运行新命令，但使用历史记录中以前命令中的参数。这可以帮助您快速重用长参数或复杂参数，而不必重新键入它们。</p><code>command !$</code><p>例如，假设您运行命令Touch/home/chris/some_long_file_name_you_dont_want_to_type_again。现在您想要运行命令Nano/home/chris/some_long_file_name_you_dont_want_to_type_again.。您可以运行以下命令，而不是从头开始键入整个代码：</p><code>nano !$</code><p>$将使bash自动填充上一个命令的最后一个参数。</p><img class="content_img" src="/image/8d/8dee05982ca05d97d4558258b4d03e92.png" /><p>这只填充了最后一个参数。因此，如果您运行ping google.com-c4，然后运行ping！$，这将扩展为“ping 4”。</p><p>要解决这种情况，可以使用以下技巧来展开该行上的第一个参数，而不是最后一个参数：</p><code>command !^</code><p>因此，如果您运行ping google.com-c4，然后运行ping！^，bash会将其扩展为“ping google.com”。</p><img class="content_img" src="/image/71/71f41b552bc9389ba433641b778c9faa.png" /><p>要填充前面命令中使用的所有参数，而不仅仅是单个参数，您可以使用以下命令：</p><code>command !*</code><p>因此，如果您运行ping！*0，bash将自动填充您在前一个命令中使用的所有参数。</p><img class="content_img" src="/image/42/4231424a57a733943ace80cf136df79d.png" /><p>您可以使用与从历史记录中运行命令相同的技巧来获取参数。只要使用下面的表格就可以了。</p><code>command !abc:#</code><p>例如，我们在前面运行了命令sudo hostname ubuntu。如果我们运行以下命令，bash将向后搜索历史记录，以查找最后一个命令，该命令以我们键入的字母开头，并填写我们指定的参数。因此，如果我们运行echo！su：2，bash将向后搜索以“su”开头的最后一个命令，并填充其第二个参数“ubuntu”。</p><p>其他花招的效果可能与您的预期不谋而合。例如，用星号(称为通配符)替换数字会导致bash填充命令中的所有参数：</p><code>command !abc:*</code><img class="content_img" src="/image/4c/4c21ca89b8f9ba65cfd42624a3830ebd.png" /><p>重新运行上一个命令并对其进行修改</p><p>bash还允许您重新运行前面的命令并指定应该更改的内容。这对于更正命令中的拼写错误很有用。例如，以下命令将重新运行前面的命令，将其中的文本“abc”替换为文本“xyz”。</p><code>^abc^xyz</code><p>例如，如果您不小心运行了ping gogle.com，那么您可以运行^gog^GOOG，而bash将运行命令ping google.com。</p><img class="content_img" src="/image/7b/7bdd0dcbb9a282b3a24931e45845ab8b.png" /><p>您的历史记录存储在哪里，以及如何清除它</p><p>默认情况下，bash shell将您在用户帐户的历史文件中运行的命令的历史记录存储在~/.bash_History中。例如，如果您的用户名是bob，您将在/home/bob/.bash_History中找到此文件。</p><p>因为您的历史记录存储在一个文件中，所以它在会话之间保持不变。您可以运行一些命令，注销，第二天再回来，这些命令仍将保存在您的历史文件中，随时可供查看和使用。每个用户帐户都有自己的历史文件和单独的命令历史记录。</p><code>history -c</code><img class="content_img" src="/image/60/603dbdb95f12046acb9f9408c56ee12b.png" /><p>默认情况下，Bash只记住有限数量的命令，以防止历史文件变得过大。bash记忆的历史条目数由HISTSIZE变量控制。默认值通常为500或1000个条目。您可以运行以下命令来查看系统上bash历史记录的大小。</p><code>echo $HISTSIZE</code><p>要将您的历史记录设置为零，请运行以下命令。</p><code>HISTSIZE=0</code><p>对于当前会话，bash不会存储任何历史条目，除非您运行类似HISTSIZE=1000的命令将其设置回一定数量的历史条目。</p><img class="content_img" src="/image/38/385d476d2c416fab565c9df6dc01a60e.png" /><p>如何忽略空格和重复项</p><p>如果将HISTCONTROL变量设置为IGNORE RESPACE，则BASH允许您忽略以空格开头的历史记录条目。</p><code>HISTCONTROL=ignorespace</code><p>在bash shell中运行命令之前，在命令前键入一个空格，该命令将正常运行，但如果您启用了此变量，则该命令不会出现在您的历史记录中。这使您可以保持历史记录的清晰度，选择在历史记录中不出现命令的情况下运行命令。</p><img class="content_img" src="/image/1e/1e43cc20e615f73db48a6deca9eab354.png" /><p>Bash还允许您忽略可能会扰乱您的历史记录的重复命令。要执行此操作，请将HISTCONTROL设置为Ignore redups。</p><code>HISTCONTROL=ignoredups</code><img class="content_img" src="/image/f7/f7f65079b378408c93dcca9d848312f3.png" /><p>要同时使用IGNONORESPACE和IGNOREDUPS功能，请将HISTCONTROL变量设置为Ignore reBoth。</p><code>HISTCONTROL=ignoreboth</code><p>请注意，您设置的bash变量将仅在当前会话中持续存在。如果您愿意，您需要将这些值添加到用户帐户的.bashrc文件中，以便在每次启动bash会话时自动设置这些值。</p><img class="content_img" src="/image/f9/f948879128d6dafae78a1d9390a4ae0c.png" /><p>bash shell是一个复杂的工具，具有比这些更多的选项。请参考官方bash手册中的Bash History Builtins和History Expansion部分，了解更详细的信息和其他您可以使用的高级技巧。</p><div class="item_info"><span class="item_key"><a href="/tag/命令/">命令</a></span><span class="item_key"><a href="/tag/bash/">bash</a></span><span class="item_key"><a href="/tag/运行/">运行</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14507.html">如何在Linux上使用HISTORY命令</a><li><a href="/story/14466.html">如何在Linux上使用at和Batch来调度命令</a><li><a href="/story/14448.html">如何在Linux上使用Which命令</a><li><a href="/story/14302.html">如何在Linux上使用Echo命令</a><li><a href="/story/14121.html">如何在Linux上使用chroot命令</a><li><a href="/story/14091.html">如何在Linux上运行和控制后台进程</a><li><a href="/story/14037.html">如何在Linux上创建别名和Shell函数</a><li><a href="/story/14013.html">Bash你需要知道的15个特殊字符</a><li><a href="/story/14001.html">如何在Linux上使用管道</a><li><a href="/story/13823.html">如何在Linux上使用xargs命令</a><li><a href="/story/13779.html">如何在Linux上使用rev命令</a><li><a href="/story/13739.html">如何监控Linux命令的进度(使用pv和Progress)</a><li><a href="/story/13621.html">如何从Linux终端列出您的计算机设备</a><li><a href="/story/13610.html">如何使用Linux type命令</a><li><a href="/story/13585.html">如何使用Linux的所有搜索命令</a><li><a href="/story/13474.html">如何在Linux上使用重命名命令</a><li><a href="/story/13312.html">如何从Linux终端杀死进程</a><li><a href="/story/13258.html">37个您应该知道的重要Linux命令</a><li><a href="/story/13253.html">如何使用命令行重新启动或关闭Linux</a><li><a href="/story/13218.html">如何在Linux上使用“Install”命令复制文件</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>