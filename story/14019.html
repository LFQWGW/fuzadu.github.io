<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何在Microsoft Excel中使用XLOOKUP函数</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何在Microsoft Excel中使用XLOOKUP函数</h2></div><div class="content"><img class="content_img" src="/image/db/dbe3c80ba8f58af71fd150810dac28d3.png" /><p>Excel的新XLOOKUP将取代VLOOKUP，为Excel最流行的功能之一提供强大的替代。这个新功能解决了VLOOKUP的一些限制，并且有额外的功能。</p><p>什么是XLOOKUP？</p><p>新的XLOOKUP函数为VLOOKUP的一些最大限制提供了解决方案。此外，它还取代了HLOOKUP。例如，XLOOKUP可以向左查看，默认为完全匹配，并允许您指定单元格范围而不是列号。VLOOKUP不是那么容易使用，也不是那么多才多艺。我们将向您展示它是如何工作的。</p><p>目前，XLOOKUP只对Insiers计划的用户可用。只要最新的Excel功能可用，任何人都可以加入Insiers计划，以访问这些功能。微软将很快开始向所有Office 365用户推出这项服务。</p><p>如何使用XLOOKUP函数</p><p>让我们直接开始讨论XLOOKUP的实际操作示例。以下面的示例数据为例。我们希望为A列中的每个ID返回F列中的部门。</p><img class="content_img" src="/image/ea/ea1cfb9d0893cdce3e96c5017336a821.png" /><p>这是一个经典的精确匹配查找示例。XLOOKUP函数只需要三条信息。</p><p>下图显示了具有六个参数的XLOOKUP，但只有前三个参数是精确匹配所必需的。所以让我们把重点放在他们身上：</p><p>
LOOKUP_VALUE：这是您要查找的内容。
lookup_array：在哪里查找。
RETURN_ARRAY：返回包含要返回值的范围。</p><img class="content_img" src="/image/ed/edb0ab6a10c3cdef257d3afa900c234f.png" /><p>以下公式适用于此示例：=XLOOKUP(A2，$E$2：$E$8，$F$2：$F$8)</p><img class="content_img" src="/image/71/71be7cd598fd1ca9c64cc0f65521bf0e.png" /><p>现在让我们探索XLOOKUP相对于VLOOKUP的几个优势。</p><p>不再有列索引号</p><p>VLOOKUP臭名昭著的第三个参数是指定要从表数组返回的信息的列号。*这不再是问题，因为XLOOKUP允许您选择要返回的范围(本例中为F列)。</p><img class="content_img" src="/image/8b/8b0c3aa8d6c9cc96ede08467e24d373a.png" /><p>别忘了，与VLOOKUP不同，XLOOKUP可以查看选定单元格的左侧数据。下面是关于这一点的更多信息。</p><p>插入新列时，也不再存在公式损坏的问题。如果在您的电子表格中发生这种情况，返回范围将自动调整。</p><img class="content_img" src="/image/b1/b170fc71d423f0d8c60a15e13eece8cf.png" /><p>完全匹配是默认设置</p><p>在学习VLOOKUP时，总是感到困惑的是，为什么需要指定一个精确的匹配。</p><p>幸运的是，XLOOKUP缺省为完全匹配-这是使用查找公式的更常见原因)。这减少了回答第五个论点的需要，并确保了公式新手犯的错误更少。</p><p>因此，简而言之，XLOOKUP比VLOOKUP问的问题更少，更人性化，也更耐用。</p><p>XLOOKUP可以向左看</p><p>能够选择查找范围使XLOOKUP比VLOOKUP更通用。使用XLOOKUP，表列的顺序并不重要。</p><p>VLOOKUP通过搜索表最左侧的列，然后从指定数量的列向右返回来进行约束。</p><p>在下面的示例中，我们需要查找ID(列E)并返回人名(列D)。</p><img class="content_img" src="/image/65/657711831e3ffe8c199da020102c5bfa.png" /><p>以下公式可实现此目的：=XLOOKUP(A2，$E$2：$E$8，$D$2：$D$8)</p><img class="content_img" src="/image/ce/cec745a527e83949ecde23e96794c984.png" /><p>如果找不到怎么办？</p><p>查找函数的用户非常熟悉#N/A错误消息，当他们的VLOOKUP或匹配函数找不到所需内容时，该消息会向他们问候。这通常是有逻辑的原因。</p><p>因此，用户很快就会研究如何隐藏这个错误，因为它不正确或不有用。当然，有很多方法可以做到这一点。</p><p>XLOOKUP附带了自己的内置“if not find”参数来处理此类错误。让我们通过前面的示例来看看它的实际情况，但是输入的ID是错误的。</p><p>下面的公式将显示文本“错误ID”，而不是错误消息：=XLOOKUP(A2，$E$2：$E$8，$D$2：$D$8，“错误ID”)</p><img class="content_img" src="/image/47/474560238eef07f8d6f0edb587415d02.png" /><p>使用XLOOKUP进行范围查找</p><p>虽然不像精确匹配那样常见，但是查找公式的一个非常有效的用法是在范围内查找值。以下面的例子为例。我们想根据花费的金额退还折扣。</p><p>这一次，我们不是在寻找特定的值。我们需要知道B列的值在E列的范围内的位置，这将确定赚取的折扣。</p><img class="content_img" src="/image/a9/a9a88c6d83edb230f35e0451ba3af83e.png" /><p>XLOOKUP有一个可选的第五个参数(记住，它缺省为完全匹配)，名为Match mode。</p><img class="content_img" src="/image/32/32295fe092e3574bc20135422ee6f610.png" /><p>您可以看到，XLOOKUP具有比VLOOKUP更大的近似匹配能力。</p><p>可以选择查找小于(-1)或最接近大于(1)所查找的值的最接近匹配项。还可以选择使用通配符(2)，如？或*。默认情况下，此设置不像VLOOKUP那样处于打开状态。</p><p>本例中的公式返回的值小于找不到完全匹配时查找的值：=XLOOKUP(B2，$E$3：$E$7，$F$3：$F$7，，-1)</p><img class="content_img" src="/image/ec/ecf1e03924840de311e2c87b9526d945.png" /><p>但是，单元格C7中有一个错误，其中返回了#N/A错误(没有使用‘If Not Found’参数)。这应该返回0%的折扣，因为花费64不符合任何折扣的标准。</p><p>XLOOKUP函数的另一个优点是它不要求查找范围像VLOOKUP那样按升序排列。</p><p>在查阅表格底部输入新行，然后打开公式。通过单击并拖动角来扩展使用的范围。</p><img class="content_img" src="/image/6e/6e39f9f8cfa8a2be4c1705fd16474510.png" /><p>该公式会立即更正该错误。“0”在范围的底部不是问题。</p><img class="content_img" src="/image/a3/a336ac63bd07c895463eb4d6510ead6a.png" /><p>就我个人而言，我仍然会按查阅列对表进行排序。底部有“0”会让我发疯的。但事实上，这个公式没有打破，这是一件很棒的事情。</p><p>XLOOKUP也取代了HLOOKUP函数</p><p>如前所述，XLOOKUP函数也是用来取代HLOOKUP的。一个函数代替两个函数。好极了！</p><p>HLOOKUP函数是水平查找，用于沿行搜索。</p><p>不像它的兄弟VLOOKUP那样广为人知，但对于下面这样的示例很有用，其中标题在A列，数据在第4行和第5行。</p><p>XLOOKUP可以双向查找-向下的列，也可以沿行查找。我们不再需要两种不同的功能。</p><p>在本例中，公式用于返回与单元格A2中的名称相关的销售值。它沿着第4行查找名称，然后返回第5行的值：=XLOOKUP(A2，B4：E4，B5：E5)</p><img class="content_img" src="/image/4e/4e4f98e60e0015fddcc5aedb3d4a607c.png" /><p>XLOOKUP可以自下而上查看</p><p>通常，您需要查找列表才能找到值的第一个(通常是唯一的)匹配项。XLOOKUP有一个名为搜索模式的第六个参数。这使我们能够将查找切换为从底部开始，并查找列表以查找某个值的最后一个匹配项。</p><p>在下面的示例中，我们希望在A列中找到每个产品的库存水平。</p><p>查找表按日期顺序排列，并且每个产品都有多个库存检查。我们希望返回上次检查的库存水平(产品ID的最后一次出现)。</p><img class="content_img" src="/image/25/258522c59406e521ea2b59d9b7eef5b3.png" /><p>XLOOKUP函数的第六个参数提供四个选项。我们对使用“从最后到第一个搜索”选项很感兴趣。</p><img class="content_img" src="/image/37/37b24b686be061cd9590d3511590da80.png" /><p>完成的公式如下所示：=XLOOKUP(A2，$E$2：$E$9，$F$2：$F$9，-1)</p><img class="content_img" src="/image/f1/f1e31058bf3757c6298cdad33733a542.png" /><p>在此公式中，忽略了第四个和第五个参数。这是可选的，我们想要完全匹配的默认值。</p><p>聚拢 / 搜集 / 概要 / 综合报道</p><p>XLOOKUP函数是人们热切期待的VLOOKUP和HLOOKUP函数的继任者。</p><p>本文使用了各种示例来演示XLOOKUP的优势。其中之一是XLOOKUP可以跨工作表、工作簿和表格使用。为了帮助我们理解，文章中的例子尽量简单。</p><p>由于动态数组很快就会引入Excel，因此它还可以返回一系列值。这绝对是一件值得进一步探讨的事情。</p><p>VLOOKUP的日子屈指可数了。XLOOKUP就在这里，很快就会成为事实上的查找公式。</p><div class="item_info"><span class="item_key"><a href="/tag/xlookup/">xlookup</a></span><span class="item_key"><a href="/tag/查找/">查找</a></span><span class="item_key"><a href="/tag/vlookup/">vlookup</a></span></div></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>