<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>极客学校：学习如何在PowerShell中使用对象</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>极客学校：学习如何在PowerShell中使用对象</h2></div><div class="content"><img class="content_img" src="/image/20/207ea41ab315096bfcdb3ed62317373a.png" /><p>了解对象是“获取”PowerShell的基本概念之一。和我们一起探索对象，以及它们如何让PowerShell变得比当今任何其他外壳都更好。</p><p>请务必阅读本系列的前几篇文章：</p><p>
了解如何使用PowerShell自动化Windows。
学习在PowerShell中使用Cmdlet</p><p>在接下来的一周里，我们将继续关注这一系列的节目。</p><p>客体</p><p>您有没有想过PowerShell与传统的Linux shell(如Bash，甚至传统的命令提示符)有什么不同？答案非常简单：传统的shell输出文本，这使得格式化和过滤等操作变得困难。当然，有一些工具可以帮助您完成工作(浮现在脑海中的是sed和grep)，但归根结底，如果您想要进行任何类型的繁重文本解析，您需要对正则表达式了如指掌。</p><p>PowerShell利用了底层的.Net框架，并采取了一种不同的方法，使用对象而不是文本。对象只是某物的一种表现形式。它们是部件和使用它们的动作的集合。让我们来看看自行车的部件以及我们可能如何使用它们。</p><img class="content_img" src="/image/cc/ccfc1eeb8d6c3042b130d191aba8a45c.png" /><p>Net中的对象基本相同，除了两个小区别：“部分”称为属性，“指令”称为方法。如果我们希望将Windows服务表示为对象，我们可能会决定使用三个属性来描述它是合适的：服务名称、状态和描述。我们还需要与服务交互，因此我们可能会为对象提供Start、Stop和Pause方法。</p><img class="content_img" src="/image/97/97fd3a5832127d3c186b40179f2a772b.png" /><p>通过将对象传递给Get-Member cmdlet，可以查看对象的属性和方法。PowerShell cmdlet输出的对象在很大程度上是.Net Framework的基础类型，但如果需要使用C#之类的语言或使用PSObject类型，您可以创建自己的对象。</p><p>“管道”(The Pipeline)</p><p>有很多带有管道的Linux shell，允许您将一个命令输出的文本作为输入发送到管道中的下一个命令。PowerShell允许您获取一个cmdlet输出的对象，并将它们作为输入传递给管道中的下一个cmdlet，从而使这一点更上一层楼。诀窍在于了解cmdlet返回的对象类型，这在使用Get-Member cmdlet时非常容易。</p><img class="content_img" src="/image/40/408f48cdbbe17accb90a2dbf7f8e4dcb.png" /><p>由于超出本文范围的原因，属性和方法被联合称为类成员，这解释了您为什么使用Get-Member cmdlet来获取对象具有的所有方法和属性的列表。但是，Get成员cmdlet还返回另一条重要信息，即基础对象类型。在上面的屏幕截图中，我们可以看到Get-Service返回以下类型的对象：</p><p>由于PowerShell处理的是对象而不是文本，因此并不是所有的cmdlet都可以使用管道链接在一起[1]。这意味着我们需要查找要从管道接受System.ServiceProcess.ServiceController对象的cmdlet。</p><img class="content_img" src="/image/9e/9e992a9a2369f8579e66e220e616109a.png" /><p>请注意，有一个名为Stop-Service的cmdlet；让我们来看看它的帮助。</p><img class="content_img" src="/image/e4/e478dfac4ead5be63a6ae047783637c8.png" /><p>看起来InputObject参数接受ServiceController对象数组作为输入。通常，如果您看到一个名为InputObject的参数，它将接受来自管道的输入，但为了确保让我们看看该参数的完整帮助。</p><img class="content_img" src="/image/46/4696d1d0b85598d3b870117e4b8bda16.png" /><p>我们的怀疑是正确的。因此，在这一点上，我们知道以下内容：</p><p>
Get-Service返回ServiceController对象。
Stop-Service有一个名为InputObject的参数，该参数接受一个或多个ServiceController作为输入。
InputObject参数接受管道输入。</p><p>使用此信息，我们可以执行以下操作：</p><img class="content_img" src="/image/de/dede119b766e0f34e35c505fec8b264f.png" /><p>各位，这次就到这里吧。下一次我们将了解如何格式化、筛选和比较管道中的对象。</p><p>家庭作业 / 准备工作 / 预先所做的研究 / 在家里做的工作</p><p>
阅读对象管道</p><p>如果你有任何问题，可以发tweet给我@taabgibb，或者直接留言。</p><div class="item_info"><span class="item_key"><a href="/tag/对象/">对象</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/powershell/">powershell</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14446.html">如何向Google幻灯片中的对象添加替代文本</a><li><a href="/story/14444.html">如何在Google Docs中向对象添加替代文本</a><li><a href="/story/13520.html">如何在Microsoft Word中向对象添加可选文本</a><li><a href="/story/12583.html">如何使用指导原则排列PowerPoint对象</a><li><a href="/story/3424.html">取得Windows 7中注册表项的所有权</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>