<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>定义和创建公式</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>定义和创建公式</h2></div><div class="content"><img class="content_img" src="/image/8f/8fc4490a902c1bbd7ffa378aacf8d6a3.png" /><p>在本课中，我们将向您介绍创建公式和使用函数的基本规则。我们觉得最好的学习方法之一是通过练习，所以我们提供了几个例子，并详细解释了它们。我们将涵盖的主题包括：</p><p>
行和列。
数学函数示例：SUM()。
运营者。
运算符优先级。
示例财务函数：PMT()，贷款支付。
在公式和嵌套函数中使用“string”函数(“string”是“string of text”的简写</p><p>公式是“函数”、“运算符”和“操作数”的混合体。在我们编写几个公式之前，我们需要创建一个函数，但是在创建函数之前，我们首先需要了解行和列的表示法。</p><p>行和列</p><p>要了解如何编写公式和函数，您需要了解行和列。</p><p>行水平排列，列垂直排列。要记住哪根是哪根，想像一根支撑屋顶的柱子--柱子上下移动，因此行从左向右移动。</p><img class="content_img" src="/image/c8/c8229b9995a58d2410f84d868a4d2dbc.png" /><p>列用字母标注，行用数字标注。电子表格中的第一个单元格是A1，表示A列、第1行。列标记为A-Z。当字母表用完时，EXCEL会在前面放置另一个字母：AA，AB，AC…。AZ、BA、BC、BC等</p><p>示例：函数Sum()</p><p>现在让我们演示如何使用函数。</p><p>您可以通过直接在其中键入函数或使用函数向导来使用函数。当您从“函数库”的“公式”菜单中选取一个函数时，函数向导将打开。否则，您可以在单元格中键入=，一个方便的下拉菜单将允许您选择一个函数。</p><img class="content_img" src="/image/69/69fb3bf94390d89e5a7d626833a6dac4.png" /><p>向导会告诉您需要为每个函数提供哪些参数。如果您需要帮助理解该函数的功能以及如何使用，它还提供指向联机说明的链接。例如，如果您在单元格中键入=SUM，内联向导将向您显示SUM函数需要哪些参数。</p><img class="content_img" src="/image/4b/4bd9e0ed5a2ae994f09238d74bcc0202.png" /><p>当您键入函数时，向导是内联的或就在您的手指之间。当您从“公式”菜单中选择一个函数时，向导是一个弹出框。下面是sum()函数的弹出向导。</p><img class="content_img" src="/image/21/21825ef66933db15623a0fb76c8ce73e.png" /><p>对于我们的第一个函数，让我们使用sum()，它添加一个数字列表。</p><p>假设我们有一个电子表格，其中包含为您的家人编制假期预算的计划：</p><img class="content_img" src="/image/00/00ed92413e3e6007c91eaf4c75242be8.png" /><p>要计算总成本，可以写成=b2+b3+b4+b5，但是使用sum()函数更容易。</p><p>在EXCEL中，查找EXCEL屏幕左上角的符号Σ以找到“自动求和”按钮(数学家使用希腊字母Σ来添加一系列数字)。</p><img class="content_img" src="/image/f3/f316c98bdd404c4eadf755a7ed84d007.png" /><p>如果光标位于家庭预算数字下方，Excel会足够智能，知道您要将数字列表加到光标放置的位置上方，因此它会高亮显示这些数字。</p><img class="content_img" src="/image/b5/b5cbe037a3ce96d85ab2a1f658cc3665.png" /><p>按“Enter”接受Excel选择的范围或使用光标更改选定的单元格。</p><p>如果您查看Excel放入电子表格中的内容，您会发现它编写了此函数：</p><img class="content_img" src="/image/52/52c4b344b487e80d15ad4361e1e569c0.png" /><p>在此公式中，Excel对从B2到B9的数字求和。注意，我们在第5排下面留了一些空间，这样你就可以增加家庭度假预算-随着孩子们想做什么和想去哪里的清单越来越长，费用肯定会上升！</p><p>数学函数不能处理字母，因此如果您在列中输入字母，结果将显示为“#name？”如下所示。</p><img class="content_img" src="/image/63/632a4a39ab0211cd4a42c29d164955b7.png" /><p>#姓名？表示存在某种错误。它可以是任何数量的东西，包括：</p><p>
错误的单元格引用。
在数学函数中使用字母。
省略必需的参数。
拼写函数名称错误。
非法的数学运算，如除以0</p><p>选择计算中的参数的最简单方法是使用鼠标。当您移动鼠标或在另一个单元格中单击时，通过放大或缩小Excel绘制的框，可以向函数的参数列表添加或从函数的参数列表中删除。</p><p>我们点击Excel绘制的方块顶部，将“机票”从预算中删除。您可以看到可以绘制的十字线符号，以使选定范围变大或变小。</p><img class="content_img" src="/image/40/4063f2f3869178bd4636e573f01f95a7.png" /><p>按“Enter”确认结果。</p><p>计算运算符</p><p>有两种类型的运算符：数学运算符和比较运算符。</p><p>还有其他与数学无关的运算符，如“&”，它表示连接(端到端连接)两个字符串。例如，=“Excel”&“Is Fun”等于“Excel is Fun”。</p><p>现在我们来看一下比较运算符。</p><p>正如您在上面看到的，比较运算符用于数字和文本。</p><p>注意，如果您在单元格中输入=“a”&gt;“b”，它将显示为“false”，因为“a”不大于“b”。“b”在字母表中在“a”之后，所以“a”&gt;“b”或“b”&gt;“a”。</p><p>运算符顺序优先</p><p>顺序优先是数学中的一个概念。Excel必须遵循与数学相同的规则。这个话题比较复杂，所以深吸一口气，让我们开始潜水吧。</p><p>顺序优先是指计算机计算答案的顺序。正如我们在第1课中所解释的，圆的面积是πr2，它与π*r*r相同，而不是(πr)2。</p><p>所以当你写公式时，你必须了解顺序优先顺序。</p><p>通常，您可以这样说：</p><p>
Excel首先计算圆括号中的项目，从里到外工作。
然后，它使用数学中的顺序优先规则。
当两个项目具有相同的优先级时，Excel从左到右工作。</p><p>数学运算符的优先顺序如下所示，按降序排列。</p><p>还有其他与字符串和引用运算符相关的优先规则。目前，我们只会坚持我们刚刚介绍的内容。现在，我们来看一些例子。</p><p>示例：计算圆的面积</p><p>圆的面积是=PI()*半径^2。</p><p>看上面的表格，我们看到指数在乘法之前。所以计算机首先计算半径^2，然后将结果乘以PI。</p><p>示例：计算加薪</p><p>比方说，你的老板认为你的工作做得很好，他或她会给你加薪10%！你将如何计算你的新工资？</p><p>首先，记住乘法先于加法。</p><p>是=工资+工资*10%还是=工资+(工资*10%)？</p><p>假设你的薪水是100美元。加薪10%，你的新工资将是：</p><p>=100+100*10%=100+10=110</p><p>您也可以这样写它：</p><p>=100+(100*10%)=100+10=110</p><p>在第二种情况下，我们使用括号明确了优先顺序。请记住，括号是在任何其他操作之前计算的。</p><p>顺便说一下，更简单的写法是=薪水*110%</p><p>括号可以相互嵌套。因此，当我们写(3+(4*2))时，从内到外，首先计算4*2=8，然后加上3+8得到11。</p><p>再举几个例子</p><p>这里有另一个例子：=4*3/2。答案是什么？</p><p>我们从上表中的规则中看到，*和/具有同等的优先级。所以Excel从左到右工作，4*3=12，然后除以2得到6。</p><p>同样，您可以通过编写=(4*3)/2来明确说明这一点</p><p>=4+3*2怎么样？</p><p>计算机可以看到*和+运算符。因此，遵循优先规则(乘法先于加法)，它首先计算3*2=6，然后再加4得到10。</p><p>如果您想更改优先顺序，您可以写为=(4+3)*2=14。</p><p>这个怎么样=-1^3？</p><p>那么答案是-3，因为计算机计算=(-1)^3=-1*-1*-1=-1。</p><p>记住负乘以负就是正，负乘以正就是负。您可以这样看到(-1*-1)*-1=1*-1=-1。</p><p>这里有几个数学顺序和优先顺序的例子，我们希望这有助于澄清一些关于Excel如何执行计算的问题(对于你们中的一些人来说，这可能足以用一辈子的数学)。</p><p>示例：功能贷款支付(PMT)</p><p>让我们看一个计算贷款还款额的示例。</p><p>首先创建一个新工作表。</p><p>用美元符号格式化数字，并使用零个小数位，因为我们现在对美分不感兴趣，因为当你谈论美元时，它们并不重要(在下一章中，我们将详细探讨如何格式化数字)。例如，要格式化利率，请右键单击单元格，然后单击“格式化单元格”。选择百分比并使用2位小数位。</p><p>同样，将其他单元格的格式设置为“Currency”而不是Percent，并选择“Number”作为贷款期限。</p><img class="content_img" src="/image/56/56c5c47e17957e93eb9624d9c2346fdf.png" /><p>现在我们有：</p><img class="content_img" src="/image/13/13965572d661d178da1459a206bd46d7.png" /><p>将sum()函数添加到“总”每月费用中。</p><img class="content_img" src="/image/ed/ed2720d48354a9bb85bbafaa8c6993dd.png" /><p>注意，抵押单元格不包括在总数中。Excel不知道您要包括该数字，因为那里没有值。因此，要小心将sum()函数扩展到顶部，方法是使用光标或键入E2，其中它显示E3以将抵押贷款包括在总和中。</p><p>将光标放在支付单元格中(B4)。</p><img class="content_img" src="/image/e3/e3ebe5b1d45218ef43774a4aa239a454.png" /><p>在公式菜单上，选择“财务”下拉菜单，然后选择付款功能。向导弹出：</p><img class="content_img" src="/image/0f/0f4af1bf983ce579aef7f69378af34d6.png" /><p>使用光标选择“Rate.”、“nper”(贷款期限)、“PV”(“现值”或贷款金额)。请注意，您必须将利率除以12，因为利息是按月计算的。此外，您需要将数年的贷款期限乘以12，才能获得数月的贷款期限。按“确定”将结果保存到电子表格中。</p><p>请注意，付款显示为负数：-1013.37062。要使其为正值并将其添加到每月费用中，请指向抵押贷款单元格(E2)。键入“=-”，然后使用光标指向付款字段。得到的公式是=-B4。</p><img class="content_img" src="/image/15/15164e6835eb3a0a8b9f7d2b47b25e0c.png" /><p>现在，电子表格如下所示：</p><img class="content_img" src="/image/99/99054c4a96a35b22d59d709736ed113b.png" /><p>你每个月的开销是1，863美元-哎呀！</p><p>示例：文本函数</p><p>在这里，我们演示如何在公式内使用函数和文本函数。</p><p>假设您有一个学生列表，如下所示。名字和姓氏在一个字段中，用逗号分隔。我们需要把姓氏和公司的名字放在不同的单元格里。我们该怎么做呢？</p><img class="content_img" src="/image/4b/4bb16a2c745a0872073ce376230f136e.png" /><p>要解决此问题，您需要使用算法-即，执行此操作的分步过程。</p><p>例如，看看“华盛顿，乔治”。将其拆分为两个单词的步骤如下：</p><p>
计算字符串的长度。
找到逗号的位置(这显示了一个单词的结束位置和另一个单词的开始位置)。
向上复制字符串的左侧，直到逗号。
将字符串的右侧从逗号复制到末尾。</p><p>让我们讨论一下如何在Excel中使用“乔治·华盛顿”一步一步地做到这一点。</p><p>
使用函数=LEN(A3)计算字符串的长度-结果是18。
现在通过输入此函数=find(“，”，A3“)来查找逗号的位置-结果是11。
现在向上移动字符串的左侧直到逗号，并使用步骤1中的结果创建此嵌套公式：=Left(A3，find(“，”，A3)-1)。注意，我们必须从长度中减去1，因为find给出了逗号的位置。</p><p>下面是将所有函数放在一个公式中时的情况。在单元格B3中，您可以看到此公式从单元格A3中提取所有信息，并向其中输入“Washington”。</p><img class="content_img" src="/image/be/be4cef480bebec0059fd02ece86b6703.jpg" /><p>所以我们有“华盛顿”，现在我们需要有“乔治”。我们该怎么做呢？</p><p>请注意，我们可以将步骤1的结果单独保存在单元格中，比如B6，然后编写一个更简单的公式=LEFT(A3，B6-1)。但这会耗尽间歇性步骤的一个细胞。</p><p>
记住逗号的位置或重新计算。
计算字符串的长度。
计算从字符串末尾到逗号的字符数。</p><p>取步骤3中的字符数并减去1以省略逗号和空格。</p><p>让我们一步一步来做这件事。</p><p>
从上面看，这是=find(“，”，A3“)。
字符串的长度为=LEN(A3)。
您需要使用一些数学运算来确定要使用的字符数：=LEN(A3)-Find(“，”，A3)-1。
我们需要的字符串的右侧为=right(A3，LEN(A3)-find(“，”，A3)-1)</p><p>您的电子表格现在应该与下面的屏幕截图类似。我们将公式作为文本复制到电子表格的底部，以便于阅读和查看。</p><img class="content_img" src="/image/12/123a56e42b7bb77ad771008f238d8d0b.jpg" /><p>这个有点难，但是你只需要写一次这些公式。</p><p>接下来是下一个…</p><p>今天的课到此结束。现在，您应该对公式和函数、行和列有了相当深刻的理解，并通过几个具体的例子说明了这些内容的使用方法。</p><p>接下来的第3课，我们将讨论单元格引用和格式设置，以及移动和复制公式，这样您就不必一遍又一遍地重写每个公式！</p><div class="item_info"><span class="item_key"><a href="/tag/函数/">函数</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/公式/">公式</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14349.html">使用Google Sheet的模式函数查找频繁出现的值</a><li><a href="/story/14343.html">如何在Google Sheets中使用Medium函数</a><li><a href="/story/14263.html">如何在Google Sheets中生成随机数</a><li><a href="/story/12696.html">如何在Excel中使用逻辑函数：IF、AND、OR、XOR、NOT</a><li><a href="/story/12577.html">如何(以及为什么)使用Excel中的离群值功能</a><li><a href="/story/12485.html">如何使用Excel中的频率函数</a><li><a href="/story/11151.html">如何在Excel中将多个单元格中的文本合并为一个单元格</a><li><a href="/story/6576.html">您应该了解的有用函数</a><li><a href="/story/6572.html">为什么需要公式和函数？</a><li><a href="/story/5705.html">如何使用函数在Excel 2013中快速轻松地更改大小写</a><li><a href="/story/171.html">Ruby函数(方法)语法</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>