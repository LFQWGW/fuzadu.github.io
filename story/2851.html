<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>用BGInfo建立网络计算机系统信息数据库</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>用BGInfo建立网络计算机系统信息数据库</h2></div><div class="content"><p>在系统管理员中，Sysinterals套件中比较流行的工具之一是BGInfo，它可以在您第一次登录时将实时系统信息粘贴到您的桌面墙纸上。由于显而易见的原因，当您管理多个系统时，将系统内存、可用硬盘空间和系统正常运行时间等信息(以及其他信息)放在您面前是非常方便的。</p><p>这个方便实用程序的一个鲜为人知的功能是能够将系统信息自动保存到SQL数据库或其他数据文件中。只需几分钟的安装工作，您就可以轻松地将BGInfo配置为将所有网络计算机的系统信息记录在一个集中存储位置。然后，您可以使用此数据来监视或报告您认为合适的这些系统。</p><p>BGInfo设置</p><p>如果您熟悉BGInfo，可以跳过本部分。但是，如果您从未使用过此工具，则只需几分钟进行设置即可捕获您要查找的数据。</p><p>当您第一次打开BGInfo时，一个计时器将在右上角倒计时。单击倒计时按钮使界面保持打开状态，以便我们可以编辑设置。</p><img class="content_img" src="/image/ef/efeceb6799c85fb01ea928414a8c4957.png" /><p>现在，从右侧的可用字段中编辑要捕获的信息。由于所有输出都将重定向到中心位置，因此不必担心配置布局或格式。</p><img class="content_img" src="/image/e4/e46631e51aabe513ca1decbf0cdbf196.png" /><p>配置存储数据库</p><p>BGInfo支持以多种数据库格式存储信息：SQL Server数据库、Access数据库、Excel和文本文件。要配置此选项，请打开文件&gt;数据库。</p><img class="content_img" src="/image/8d/8d43e80a34b22b09107ab394e6e49da5.png" /><p>使用文本文件</p><p>最简单也可能是最实用的选择是将BGInfo数据存储在逗号分隔的文本文件中。此格式允许在Excel中打开文件或将其导入数据库。</p><p>要使用文本文件或任何其他文件系统类型(Excel或MS Access)，只需向相应文件提供UNC即可。运行写入此文件的任务的帐户将需要对共享和NTFS文件权限具有读/写访问权限。</p><img class="content_img" src="/image/19/19d1ab4a9fe37c0a59632bbdc431abda.png" /><p>使用文本文件时，唯一的选择是让BGInfo在每次运行捕获进程时创建一个新条目，这将向相应的CSV文本文件添加一个新行。</p><img class="content_img" src="/image/31/3114044473afdcb110aefb0db456481b.png" /><p>使用SQL数据库</p><p>如果您更喜欢将数据直接放入SQL Server数据库，BGInfo也支持此功能。这需要一些额外的配置，但总体来说非常简单。</p><p>第一步是创建存储信息的数据库。此外，您还需要创建一个用户帐户来将数据填充到此表中(且仅限于此表)。为方便起见，此脚本创建一个新的数据库和用户帐户(在您的SQL Server计算机上以管理员身份运行此帐户)：</p><p>注意：SQL用户帐户必须对数据库具有‘db_owner’权限，才能使BGInfo正常工作。这就是为什么您应该有一个专门用于此数据库的SQL用户帐户。</p><img class="content_img" src="/image/32/326cc3c49ded01e612b728f16e4645e6.png" /><p>接下来，通过单击SQL按钮将BGInfo配置为连接到此数据库。</p><img class="content_img" src="/image/07/0713f1f65a361b205525dbcc1bbf704e.png" /><p>根据您的数据库设置填写连接属性。</p><img class="content_img" src="/image/2a/2a471961a4699a1a93ee1165a31b3d95.png" /><p>选择是每台计算机只有一个条目还是保留每个系统的历史记录的选项。</p><img class="content_img" src="/image/e2/e28ba95db5263dbf26767311907e31dc.png" /><p>然后，数据将被直接放入相应数据库中名为“BGInfoTable”的表中。</p><img class="content_img" src="/image/bf/bf3f516ff87bf08d93e65606acdd3dce.png" /><p>配置用户桌面选项</p><p>虽然BGInfo的主要功能是通过将系统信息添加为墙纸的一部分来更改用户的桌面，但对于我们这里的使用，我们希望让用户的墙纸单独运行，这样这个过程就不会更改用户的任何设置。</p><p>单击桌面按钮。</p><img class="content_img" src="/image/9a/9a7f1b41ed6d7a4605924fb24eb352da.png" /><p>将墙纸修改配置为不更改任何内容。</p><img class="content_img" src="/image/94/945047981d73bbd9b82605a213c8f1a6.png" /><p>准备展开</p><p>现在，我们已经为将配置部署到各个机器做好了准备，这样我们就可以开始捕获系统数据了。</p><p>如果您尚未执行此操作，请单击Apply按钮在数据存储库中创建第一个条目。如果全部配置正确，您应该能够打开数据文件或数据库并看到相应计算机的条目。</p><img class="content_img" src="/image/04/0455022686d849a20892d968ceb98923.png" /><p>现在单击File&gt;Save As菜单选项并将配置保存为“BGInfoCapture.bgi”。</p><img class="content_img" src="/image/5b/5b2012acc86f23941c38d6a1b9bb9edb.png" /><p>部署到客户端计算机</p><p>部署到各自的客户端机器相当简单。不需要安装，因为您只需要将BGInfo.exe和BGInfoCapture.bgi复制到每台计算机，并将它们放在同一目录中。</p><p>就位后，只需运行以下命令：</p><p>当然，您可能希望计划捕获进程按计划运行。此命令创建一个计划任务，以在每天上午8点运行捕获进程，并假定您已将所需文件复制到C盘的根目录：</p><p>根据需要进行调整，但最终结果是计划任务命令应该如下所示：</p><img class="content_img" src="/image/e9/e9dad1a001856038e8a13b1851af0f4e.png" /><p></p><p>从系统内部下载BGInfo</p><div class="item_info"><span class="item_key"><a href="/tag/数据库/">数据库</a></span><span class="item_key"><a href="/tag/bginfo/">bginfo</a></span><span class="item_key"><a href="/tag/配置/">配置</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/5365.html">如何显示MySQL Server的系统变量</a><li><a href="/story/2862.html">轻松查看数据库中各个SQL表的磁盘空间使用情况</a><li><a href="/story/2859.html">用于简化SQL Server数据库维护的批处理脚本</a><li><a href="/story/2811.html">使用SQL Server Management Studio恢复SQL数据库备份</a><li><a href="/story/2809.html">用于备份所有SQL Server数据库的批处理脚本</a><li><a href="/story/2079.html">在Access 2010中使用通配符条目</a><li><a href="/story/302.html">快速提示：自动压缩Access数据库</a><li><a href="/story/5.html">将MySQL数据库备份到文件</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>