<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>极客学校：学习Windows 7-远程管理</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>极客学校：学习Windows 7-远程管理</h2></div><div class="content"><img class="content_img" src="/image/a1/a17ef2899040c2a9ec7e57cda4b9a0d5.png" /><p>在此极客学校的安装中，我们将了解如何使用远程协助、远程桌面、Windows远程管理(也称为WinRM)和PowerShell远程管理我们的计算机。</p><p>请务必阅读Windows7上这个极客学校系列之前的文章：</p><p>
介绍How-to Geek学校。
升级和迁移。
配置设备。
管理磁盘。
管理应用程序。
管理Internet Explorer。
IP寻址基础知识。
联网。
无线联网。
Windows防火墙</p><p>本周我们将继续关注这一系列剩下的节目。</p><p>远程协助</p><p>远程协助是在Windows XP中首次亮相的一项功能，除此之外，删除语音聊天功能没有变化。使用远程协助时，有两个用户连接到一台计算机，同时使用该计算机。首先是需要帮助的人，也称为主人，以及帮助用户的人，称为帮助者。远程协助围绕虚拟服务台之类的场景展开。</p><p>为了让某人请求帮助，他们需要向您发送帮助他们的邀请。您可以通过三种方式生成邀请：</p><p>
如果主机和帮助器都在同一网络上，则可以将文件保存到网络位置。
如果他们不在同一网络中，您可以向他们发送电子邮件邀请。
如果您的网络运行的是IPv6(目前不太可能)，您可以使用Easy Connect。</p><p>主持人对会话中发生的事情也有最终决定权，例如，他们可以选择帮助者是否可以控制鼠标和键盘，甚至可以在对帮助者正在做的事情感到不舒服的情况下随时断开会话。</p><p>启用远程协助</p><p>要启用远程协助，请打开“开始”菜单，右键单击“计算机”，然后从上下文菜单中选择“属性”。</p><img class="content_img" src="/image/6e/6e8b8d8e14616d4c2f36340b628a790a.png" /><p>当System Information(系统信息)对话框打开时，单击位于左侧的Remote Settings(远程设置)链接。</p><img class="content_img" src="/image/a3/a3f55bf1be931c608400238a74ae9ccc.png" /><p>在这里，您需要选中允许远程协助连接到您的计算机的复选框。</p><img class="content_img" src="/image/37/379bdcbcd5f02750554f5a54df53342a.png" /><p>如果你点击高级按钮，你可以改变一些事情，比如是否允许帮助者控制你的鼠标和键盘，以及你生成的邀请的有效期有多长。</p><img class="content_img" src="/image/6f/6fe8771b698c12968029beaeda8b3b64.png" /><p>使用远程协助</p><p>为了请求某人帮助您，您需要发出邀请。为此，请打开“开始”菜单，展开“维护”，然后选择“Windows远程协助”。</p><img class="content_img" src="/image/3a/3a7ffa91e06044e2783ed4dd70a082ba.png" /><p>然后选择邀请你信任的人来帮助你。</p><img class="content_img" src="/image/70/7009122f441b205a8206d8195937b028.png" /><p>出于演示目的，我将把邀请保存到一个文件中，但是您可以随意使用您想要的任何方法。</p><img class="content_img" src="/image/33/337330a917e3fdca0dd70869182bfd36.png" /><p>我已与网络上的另一台PC共享了我的文档库，因此将邀请保存在此处非常完美。</p><img class="content_img" src="/image/1b/1b86537f6e59e89717c3e01c7cac0381.png" /><p>一旦您保存了邀请，系统将为您提供密码。这一点非常重要，因为助手在尝试连接到您的电脑时需要输入此信息。</p><img class="content_img" src="/image/ea/eaaabc3862efb90cc7a16331963f6a1a.png" /><p>我已切换到运行Windows 8的计算机。我选择这样做是为了让您不会混淆我在哪台电脑上。在Windows8机器上，我只需双击邀请即可。</p><img class="content_img" src="/image/c5/c5fe4956b8ae081773552394ca23db10.png" /><p>然后，我在主机上输入我的伙伴发送给我的密码，然后单击OK。</p><img class="content_img" src="/image/f1/f162867e5ed92f29cc8e8df490d0d311.png" /><p>然后将询问主机是否允许我连接到他们的计算机。在这种情况下，我知道谁在尝试连接，因此我可以单击是。</p><img class="content_img" src="/image/2c/2c4e930b01b8f504eaf7207f18011271.png" /><p>非那样做不行。我现在可以实时看到您在Windows7计算机上正在做什么。如果您允许用户控制您的PC(如高级选项部分所示)，您将看到一个请求控制按钮，如下所示。然后，主机将被允许允许或拒绝您的请求。如果您愿意，您也可以使用聊天功能。</p><img class="content_img" src="/image/09/099c9169643ffe4a8104b964e99caa2a.png" /><p>远程桌面</p><p>远程协助侧重于两个用户的方案，而远程桌面侧重于单个用户。远程协助和远程桌面之间最大的区别是，当我连接到远程桌面会话时，我要连接的计算机会被锁定，以便任何路过的人都看不到我在该计算机上做什么。正如您现在可能已经猜到的那样，远程桌面关注的是工作效率。例如，如果我在下班前忘了编辑文档，当我回到家时，我可以使用远程桌面连接到那台机器，就像我坐在办公桌前一样。</p><p>注意：这非常有用，我甚至每天都在家里使用它，家里有几台没有屏幕的服务器；事实上，它们甚至没有键盘或鼠标。他们只有一根电源线和一根网线，仅此而已。当我想要访问服务器上的内容时，我只需使用远程桌面。</p><p>启用远程桌面</p><p>要启用远程桌面，请打开“开始”菜单，右键单击“计算机”，然后从上下文菜单中选择“属性”。</p><img class="content_img" src="/image/9e/9ee6c91503295f9d8fcac66044db3fe9.png" /><p>当System Information(系统信息)对话框打开时，单击位于左侧的Remote Settings(远程设置)链接。</p><img class="content_img" src="/image/20/20265324f6438d7e222a29b3f53cee65.png" /><p>在这里，您需要选中允许远程桌面连接到您的计算机的复选框。启用远程桌面有两个选项：</p><p>
简单地允许从任何实施远程桌面协议的设备连接。这不太安全，但允许您从不运行Windows的设备(例如，iOS设备，甚至是运行Linux的另一台计算机)连接到您的PC。
或者，您可以选择允许来自Windows 7或更高版本计算机的连接，这些计算机使用网络级身份验证实现RDP。</p><p>我们可以选择更安全的选项，因为我的环境中只有运行Windows 7和更高版本的计算机。</p><img class="content_img" src="/image/04/042ca726d3cdff4e36bb070c8cd6a169.png" /><p>使用远程桌面</p><p>一旦您在计算机上启用了远程桌面，就很容易连接到它。为此，请打开“开始”菜单，展开“附件”，然后单击“远程桌面连接”。</p><img class="content_img" src="/image/62/627b6597d5d32ef37b6f8ba89d892d93.png" /><p>现在，您需要输入启用了远程桌面的计算机的名称或IP地址，然后单击连接。</p><img class="content_img" src="/image/99/997342bbb6f93c3d2b54a5d02a4d7da2.png" /><p>系统将提示您输入凭据。请记住：您将需要输入远程计算机上用户的凭据，而不是您正在连接的计算机上的用户凭据。</p><img class="content_img" src="/image/2b/2bea9147089ce0bd56ac005ede02bedd.png" /><p>非那样做不行。现在，它会感觉您就像坐在远程机器前一样。</p><img class="content_img" src="/image/a0/a01f938de3059bed5d46a9e4b3a8f269.png" /><p>有一件事你会注意到，当你使用RDP时，你会失去很多视觉效果。如果您在LAN上，并且有千兆位以太网，则可能需要更改此设置。为此，在连接之前，请单击Options(选项)下拉菜单。</p><img class="content_img" src="/image/8e/8e65fdff6a1274e870f3488a158b3084.png" /><p>然后切换到“体验”选项卡。您可以在此选择连接速度，这将为您确定最佳设置。</p><img class="content_img" src="/image/d6/d64b1ef13d37dfbebab974e6661409d4.png" /><p>WinRM</p><p>注意：WinRM是一个可靠的管理工具，但是您很快就会看到，它已经被令人惊叹的PowerShell远程处理功能所取代。</p><p>Windows远程管理是一种基于命令行的管理协议。WinRM真正想要做的是，它基于可靠的HTTP协议，该协议允许通过许多公司防火墙，因此不需要打开特殊的端口。WinRM未在Windows 7上启用，您必须在要远程管理的工作站和服务器上手动启用它。要启用它，请打开提升的命令提示符并运行：</p><img class="content_img" src="/image/b8/b8dd1df227607dd8d231d23e4032054d.png" /><p>启用WinRM时，会发生以下系统更改：</p><p>
Windows远程管理服务更改为延迟自动启动。
它将在所有本地IP地址上创建HTTP侦听器。
将创建防火墙例外</p><p>这就是为WinRM设置您的计算机的全部内容。</p><p>连接到启用WinRM的计算机</p><p>要使用WinRM连接到计算机，您必须将该计算机添加到您的受信任主机列表。要执行此简单操作，请在以下命令中键入：</p><p>注意：您需要将下面命令中的IP更改为您尝试连接的计算机的IP。</p><p>将计算机添加到您的TrudHosts后，您可以在远程计算机上连接并运行所需的任何命令。为此，您可以使用Windows远程外壳(WinRS)命令。</p><p>您需要替换以下值：</p><p>
192.168.174.130，用于启用WinRM的计算机的IP地址。
Taylor表示远程计算机上本地管理员的用户名。
Pa$$w0rd作为上面指定的用户帐户的密码。
netsat用于您要运行的命令。当然，如果您真的想查看远程机器上的监听端口，请随意使用netsat。</p><img class="content_img" src="/image/0c/0c6308b6ff9d25cc938de2b4b5691576.png" /><p>PowerShell远程处理</p><p>正如我前面提到的，PowerShell的远程处理功能构建在WinRM之上。因此，让我们确定它与遗留shell的不同之处。</p><p>对象定向</p><p>有一件事让PowerShell变得如此强大，那就是面向对象。面向对象编程，也就是众所周知的OOP，是一种支持代码重用的编程风格。它用来实现这一点的方法之一是允许您创建由原始数据类型(如数字和字符串)以及其他复合结构组成的复合数据结构。这些复合数据结构称为对象。</p><p>简而言之，对象是某物的一种表现形式。对象包含描述事物的属性，以及告诉对象它可以做什么的方法。例如，您可能有一个名为Person的对象。Person对象将具有：</p><p>
描述人眼睛颜色的属性。
描述人员头发颜色的属性。
它可能有一种叫做睡眠的方法。
它可能有一种名为Walk的方法。</p><p>OOP实际上远不止于此，但这将暂时作为一个有效的定义。由于PowerShell中的所有内容都是对象，因此处理数据非常容易。例如，Get-Service cmdlet获取有关本地计算机上运行的服务的信息。要查看它输出的对象类型，只需通过管道将其发送到get-Member：</p><img class="content_img" src="/image/a8/a88f0658b8caa2aa22a523ad7654df0a.png" /><p>在这里，您可以看到它输出一种称为ServiceController的对象类型。您还可以查看ServiceController对象支持的方法和属性。有了这些信息，很容易就知道可以通过调用表示要停止的服务的对象上的Kill方法来停止服务。</p><p>远程处理</p><p>由于我们已经安装了WinRM，因此我们的Windows 7计算机已经能够通过PowerShell进行远程控制。要在远程计算机上运行Powershell cmdlet，请使用Invoke-Command cmdlet：</p><img class="content_img" src="/image/72/7271982a5502204137dcb0e3d2b27f97.png" /><p>非那样做不行。</p><p>如果你有任何问题，可以发tweet给我@taabgibb，或者直接留言。</p><div class="item_info"><span class="item_key"><a href="/tag/计算机/">计算机</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/远程/">远程</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/13209.html">什么是算法，为什么它们会让人不舒服？</a><li><a href="/story/13186.html">什么是老鼠恶意软件，为什么它如此危险？</a><li><a href="/story/12621.html">巨大的超级计算机仍然存在。这就是他们今天要用到的东西</a><li><a href="/story/11358.html">如何在不重新安装Windows的情况下升级到更大的硬盘</a><li><a href="/story/10810.html">如何在Windows 10中禁用锁屏</a><li><a href="/story/10625.html">如何使用Windows Defender Offline查找和删除恶意软件</a><li><a href="/story/10215.html">PSA：不要关机，只需使用睡眠(或休眠)</a><li><a href="/story/10071.html">如何从Windows家庭组中删除旧计算机</a><li><a href="/story/9537.html">您可以将Windows安装移到另一台计算机上吗？</a><li><a href="/story/8387.html">使用隐藏的PowerCfg工具优化Windows的电池续航时间</a><li><a href="/story/7825.html">如何查找丢失的Windows或Office产品密钥</a><li><a href="/story/7743.html">如何按计划启动或关闭任何计算机</a><li><a href="/story/7410.html">愚蠢的极客小把戏：如何让你的电脑与你对话</a><li><a href="/story/7192.html">什么是Windows域？它对我的PC有什么影响？</a><li><a href="/story/6999.html">如何保护和管理亲属的计算机</a><li><a href="/story/6990.html">8种常见网络实用程序说明</a><li><a href="/story/6894.html">初学者极客：如何通过互联网访问您的桌面</a><li><a href="/story/6868.html">不要被吓倒：构建自己的计算机比你想象的要容易</a><li><a href="/story/6833.html">如何从Windows外部扫描和修复受感染的计算机</a><li><a href="/story/6832.html">为什么我的计算机过早唤醒？</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>