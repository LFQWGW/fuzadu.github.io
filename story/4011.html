<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>充分利用Wireshark的5个杀手级技巧</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>充分利用Wireshark的5个杀手级技巧</h2></div><div class="content"><img class="content_img" src="/image/52/52b0575fb6254c1723581faca03d8642.png" /><p>Wireshark有相当多的诀窍，从捕获远程流量到基于捕获的数据包创建防火墙规则。如果您想要像专业人士一样使用Wireshark，请继续阅读，了解更多高级提示。</p><p>我们已经介绍了Wireshark的基本用法，因此请务必阅读我们最初的文章，了解这个功能强大的网络分析工具的介绍。</p><p>网络名称解析</p><p>捕获数据包时，您可能会对Wireshark仅显示IP地址感到恼火。您可以自己将IP地址转换为域名，但这不太方便。</p><img class="content_img" src="/image/2c/2c2148b22a5f4fe2317f16be8ef33165.png" /><p>Wireshark可以自动将这些IP地址解析为域名，尽管默认情况下未启用此功能。启用此选项后，只要有可能，您就会看到域名而不是IP地址。缺点是Wireshark将不得不查找每个域名，从而用额外的DNS请求污染捕获的流量。</p><img class="content_img" src="/image/7e/7ec709be4f2b7bd18f8a3d7408a194da.png" /><p>您可以启用此设置，方法是从Edit-&gt;Preferences打开Preferences窗口，单击Name Resolution面板，然后单击“Enable Network Name Resolution”复选框。</p><img class="content_img" src="/image/7a/7aa867d0d468f9b0161330a5ad1eedb8.png" /><p>自动开始捕获</p><p>如果您想立即开始捕获数据包，可以使用Wirshark的命令行参数创建一个特殊的快捷方式。根据Wireshark显示接口的顺序，您需要知道要使用的网络接口的编号。</p><img class="content_img" src="/image/91/91e4056bbac8f4fc20f415946bf94f30.png" /><p>创建Wireshark快捷方式的副本，右键单击它，进入其属性窗口并更改命令行参数。将-i#-k添加到快捷方式的末尾，用要使用的接口号替换#。i选项指定接口，而-k选项告诉Wireshark立即开始捕获。</p><img class="content_img" src="/image/c3/c3310fbb29066b1a30e05b275fe0abe3.png" /><p>如果您使用的是Linux或其他非Windows操作系统，只需使用以下命令创建快捷方式，或从终端运行即可立即开始捕获：</p><p>有关更多命令行快捷方式，请查看Wireshark手册页面。</p><p>捕获来自远程计算机的流量</p><p>默认情况下，Wireshark从系统的本地接口捕获流量，但这并不总是您想要捕获的位置。例如，您可能想要捕获来自网络上不同位置的路由器、服务器或另一台计算机的流量。这就是Wireshark的远程捕获功能发挥作用的地方。该功能目前仅在Windows上可用-Wireshark的官方文档建议Linux用户使用SSH通道。</p><p>首先，您必须在远程系统上安装WinPcap。WinPcap附带Wireshark，因此如果您已经在远程系统上安装了Wireshark，则不必安装WinPCap。</p><p>安装后，打开远程计算机上的服务窗口-单击开始，在开始菜单的搜索框中键入services.msc，然后按Enter键。在列表中找到Remote Packet Capture Protocol(远程数据包捕获协议)服务并启动它。默认情况下，此服务处于禁用状态。</p><img class="content_img" src="/image/f4/f4dc9f683b18bb843063318718e04956.png" /><p>单击Wireshark中的Capture Options(捕获选项)链接，然后从Interface(接口)框中选择Remote(远程)。</p><img class="content_img" src="/image/0b/0b2efbca153afac40daafe737d7db891.png" /><p>输入远程系统的地址，端口为2002。您必须有权访问远程系统上的端口2002才能连接，因此您可能需要在防火墙中打开此端口。</p><img class="content_img" src="/image/4b/4bf61f5ee99382097e9f4d433bdd323e.png" /><p>连接后，您可以从接口下拉框中选择远程系统上的接口。选择接口后单击Start启动远程捕获。</p><img class="content_img" src="/image/65/65a65d71f744f197130e790ef606d258.png" /><p>终端中的Wireshark(TShark)</p><p>如果您的系统上没有图形界面，您可以在终端上通过TShark命令使用Wireshark。</p><p>首先，发出tshark-D命令。此命令将为您提供网络接口号。</p><img class="content_img" src="/image/b6/b6ceec47f2238e4c183da78f64b19a69.png" /><p>完成后，运行tshark-i#命令，将#替换为要捕获的接口号。</p><img class="content_img" src="/image/96/963aa7746976c7c80d81cc351338d105.png" /><p>TShark的行为类似于Wireshark，它将捕获的流量打印到终端。如果要停止捕获，请使用Ctrl-C组合键。</p><p>将数据包打印到终端不是最有用的行为。如果我们想更详细地检查流量，可以让TShark将其转储到一个文件中，以便稍后检查。请改用以下命令将流量转储到文件：</p><img class="content_img" src="/image/1c/1cabfee0954c8e27aece1a971fd0bde6.png" /><p>TShark不会在捕获数据包时向您显示它们，但它会在捕获数据包时对它们进行计数。您可以使用Wireshark中的File(文件)-&gt;Open(打开)选项稍后打开捕获文件。</p><p>有关TShark的命令行选项的更多信息，请查看其手册页。</p><p>创建防火墙ACL规则</p><p>如果您是负责防火墙的网络管理员，并且您正在使用Wireshark四处查看，那么您可能想要根据您看到的通信量采取行动--也许是为了阻止一些可疑的通信量。Wireshark的防火墙ACL规则工具生成在防火墙上创建防火墙规则所需的命令。</p><p>首先，通过单击选择要基于其创建防火墙规则的数据包。之后，单击Tools(工具)菜单并选择Firewall ACL Rules(防火墙ACL规则)。</p><img class="content_img" src="/image/dd/dd9673f49ae28b19aed9e96db3af422e.png" /><p>使用产品菜单选择您的防火墙类型。Wireshark支持Cisco IOS、不同类型的Linux防火墙(包括iptables)和Windows防火墙。</p><img class="content_img" src="/image/79/790c1953bb24b723bc7f2ee308533544.png" /><p>您可以使用过滤器框根据系统的MAC地址、IP地址、端口或同时基于IP地址和端口创建规则。您可能会看到较少的筛选器选项，具体取决于您的防火墙产品。</p><img class="content_img" src="/image/9e/9ea04ce04bc27668440cab4798faa14d.png" /><p>默认情况下，该工具创建拒绝入站流量的规则。您可以通过取消选中入站或拒绝复选框来修改规则的行为。创建规则后，使用复制按钮复制它，然后在防火墙上运行它以应用规则。</p><p>您想让我们在未来写一些关于Wireshark的具体内容吗？如果您有任何要求或想法，请在评论中告诉我们。</p><div class="item_info"><span class="item_key"><a href="/tag/wireshark/">wireshark</a></span><span class="item_key"><a href="/tag/捕获/">捕获</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/3942.html">如何使用Wireshark捕获、过滤和检查数据包</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>