<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何使用Linux睡眠命令暂停Bash脚本</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何使用Linux睡眠命令暂停Bash脚本</h2></div><div class="content"><p>睡眠命令使您的Linux计算机什么也不做。也许这与直觉不符，但有时需要一段时间的不活动。本文将向您展示如何有效地使用此Bash shell命令。</p><p>使用睡眠很简单。在命令行中键入睡眠、空格、数字，然后按Enter键。</p><code>sleep 5</code><p>光标将消失五秒钟，然后返回。发生了什么？在命令行上使用睡眠指示Bash在您提供的持续时间内暂停处理。在我们的示例中，这是5秒。</p><img class="content_img" src="/image/6e/6e7643cfddd4263420ac0ae8a58f1144.png" /><p>我们可以按天数、小时数和分钟数传递睡眠持续时间，也可以以秒为单位传递睡眠持续时间。要做到这一点，需要在持续时间中加上d、h、m或s的后缀。要使睡眠暂停1天4小时7分5秒，请使用如下命令：</p><code>sleep 1d 4h 7m 5s</code><p>后缀s(表示秒)是可选的。没有后缀，睡眠将把任何持续时间视为秒。假设你想让睡眠暂停5分20秒。此命令的一种正确格式是：</p><code>sleep 5m 20</code><p>如果您忘记在分钟持续时间上提供m后缀，您将不会指示睡眠暂停5秒，然后再次暂停20秒。所以睡眠会暂停25秒。</p><p>许多命令要求您以特定的顺序提供参数，但是休眠是非常宽容的。你可以按任何顺序提供它们，睡眠会让它们变得有意义。您还可以提供浮点数作为参数。例如，0.5h是表明您希望睡眠暂停半小时的有效方式。</p><p>以下所有(越来越古怪的)命令告诉睡眠暂停10秒。</p><code>sleep 10</code><code>sleep 5 5s</code><code>Sleep 1 1 1s 1 1 1s 1 2</code><code>sleep 0.16667m</code><p>使用休眠在命令前暂停</p><p>休眠命令可用于在执行命令之前暂停。此命令将暂停15秒，然后发出嘟嘟声。</p><code>sleep 15 && echo -en '\007'</code><p>使用睡眠在两个命令之间暂停</p><p>您可以使用SLEEP在两个命令之间进行暂停。此命令将列出Documents目录中的文件，暂停5秒钟，然后将当前工作目录更改为您的主目录：</p><code>ls -R ~/Documents && sleep 5 && cd ~</code><img class="content_img" src="/image/28/2804a7c7c69b349f375d2c5a6d93a01d.png" /><p>使用休眠暂停脚本的执行</p><p>您可以在shell脚本中使用睡眠命令来暂停脚本的执行一段精确的时间。通常，这样做是为了让一些进程在脚本继续处理之前有足够的时间完成。您还可以使用它来限制脚本向其他资源发出的请求的速率。</p><p>为了准确演示这一点，这里有一个使用cURL调用google web服务的脚本。当您使用图书的ISBN号查询Web服务时，它会使用有关该图书的JSON数据的转储进行响应。我们可以通过JQ实用程序传递数据来解析该数据，以检索书名。这样脚本就不会给Web服务带来压力，它会在Web请求之间休眠一秒钟。</p><p>创建一个包含以下文本的文件，并将其另存为.check_book.sh。</p><code>#!/bin/bash

for book in `cat $1`
do
 echo $book":"
 curl -s https://www.googleapis.com/books/v1/volumes?q=isbn:$book | jq '.items | .[] | .volumeInfo.title'
 echo ""
 sleep 1
done

echo "All done."</code><p>键入以下命令以设置执行权限并使脚本可执行。</p><code>chmod +x check_book.sh</code><p>该脚本需要curl和jq实用程序。如果您使用的是Ubuntu或其他基于Debian的发行版，请使用apt-get将这些软件包安装到您的系统上。在其他Linux发行版上，请改用您的Linux发行版的包管理工具。</p><code>sudo apt-get install curl</code><code>sudo apt-get install jq</code><p>创建一个包含以下数字的文本文件，并将其另存为books.txt。</p><code>9781565921276
9781874416685
9781565921672
9780521431088
9781491941591</code><p>运行check_book.sh脚本并将books.txt文件作为参数传入。</p><code>./check_book.sh books.txt</code><img class="content_img" src="/image/70/702e6253e333b29ada9c172dc067358e.png" /><p>每隔一秒向Google web服务发出请求。在查询每个ISBN编号后不久，书名就会出现。</p><p>这就是我们要睡觉的全部。check_book.sh脚本的内部工作原理超出了本文的范围。选择该脚本纯粹是为了说明睡眠命令的有效用法。如果您希望了解更多关于脚本的两个主要组成部分的信息，请参考CURL项目页面和JQ在线手册。</p><div class="item_info"><span class="item_key"><a href="/tag/睡眠/">睡眠</a></span><span class="item_key"><a href="/tag/脚本/">脚本</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14506.html">如何使用Apple Watch进行睡眠跟踪</a><li><a href="/story/10856.html">如何在iOS 10中启用睡前提醒、温和唤醒和睡眠跟踪</a><li><a href="/story/9740.html">人造灯光正在破坏你的睡眠，是时候做点什么了</a><li><a href="/story/9210.html">如何防止您的Apple TV进入睡眠状态</a><li><a href="/story/8557.html">如何在手机上设置音乐睡眠计时器</a><li><a href="/story/8506.html">如何使用智能手机或智能手表重新配置睡眠周期</a><li><a href="/story/489.html">阻止Windows Update劫持休眠/关机按钮</a><li><a href="/story/272.html">在Windows Vista中禁用混合睡眠模式</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>