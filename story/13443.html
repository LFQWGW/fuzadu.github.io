<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何在Linux上使用最后一个命令</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何在Linux上使用最后一个命令</h2></div><div class="content"><p>谁，什么时候，从哪里来的？良好的安全实践表明，您应该知道谁一直在访问您的Linux计算机。我们教你怎么做。</p><p>wtmp文件</p><p>Linux和其他类似Unix的操作系统，如MacOS，都非常擅长记录日志。在系统内部的某个地方，您能想到的几乎所有东西都有一个日志。我们感兴趣的日志文件名为wtmp。“w”可能代表“何时”或“谁”--似乎没有人同意。“tmp”部分可能代表“临时”，但也可能代表“时间戳”。</p><p>我们所知道的是，wtmp是一个日志，它捕获并记录每个登录和注销事件。检查wtmp日志中的数据是对系统管理员职责采取有安全意识的方法的基本步骤。对于一台典型的家用计算机，从安全的角度来看可能不是那么重要，但是能够检查您对计算机的综合使用是很有趣的。</p><p>与Linux中的许多基于文本的日志文件不同，wtmp是一个二进制文件。要访问其中的数据，我们需要使用为该任务设计的工具。</p><p>那个工具是最后的命令。</p><p>最后一条命令</p><p>最后一个命令从wtmp日志中读取数据并将其显示在终端窗口中。</p><p>如果您键入last并按Enter，它将显示日志文件中的所有记录。</p><code>last</code><img class="content_img" src="/image/e7/e78f1ce89af5c6a4322d369189802328.png" /><p>来自WTMP的每条记录都显示在终端窗口中。</p><p>从左到右，每行包含：</p><p>
登录者的用户名。
他们登录的终端。终端条目：0表示他们登录到Linux计算机本身。
他们登录的计算机的IP地址。
登录时间和日期戳。
会话的持续时间。</p><img class="content_img" src="/image/d5/d57ec151be99d79c669f2a3144783ad1.png" /><p>最后一行告诉我们日志中最早记录的会话的日期和时间。</p><p>每次启动计算机时，都会将虚拟用户“reboot”的登录条目输入到日志中。终端字段将替换为内核版本。这些条目的已登录会话的持续时间代表计算机的正常运行时间。</p><p>显示特定行数</p><p>单独使用最后一个命令会产生整个日志的转储，其中大部分会快速通过终端窗口。保持可见的部分是日志中最早的数据。这可能不是你想看到的。</p><p>您可以告诉LAST给出特定的输出行数。这可以通过在命令行上提供您想要的行数来实现。请注意连字符。要查看五行，您需要键入-5，而不是5：</p><code>last -5</code><img class="content_img" src="/image/c5/c58c3ac83a27d2918fee970f5d047aba.png" /><p>这给出了日志的前五行，这是最新的数据。</p><img class="content_img" src="/image/56/56b14a18d5392205836fa56c0dcc627b.png" /><p>显示远程用户的网络名称</p><p>-d选项(域名系统)告诉LAST尝试将远程用户的IP地址解析为计算机或网络名称。</p><code>last -d</code><img class="content_img" src="/image/aa/aa1d5f8b05c1a804651f937199608148.png" /><p>LAST并不总是可以将IP地址转换为网络名称，但该命令会在可以的情况下这样做。</p><img class="content_img" src="/image/49/49ad803942ed2585f3849662a88e5b21.png" /><p>隐藏IP地址和网络名称</p><p>如果您对IP地址或网络名称不感兴趣，请使用-R(无主机名)选项取消显示此字段。</p><img class="content_img" src="/image/fb/fb206ce259d19e4f1e07c5320451b78f.png" /><p>因为这样输出更整洁，没有难看的换行，所以在下面的所有示例中都使用了这个选项。如果您使用LAST来尝试识别异常或可疑活动，则不会取消显示此字段。</p><img class="content_img" src="/image/9f/9fa5bcc1145aef4b09a5f5a3d4e6dd41.png" /><p>按日期选择记录</p><p>您可以使用-s(自)选项将输出限制为仅显示自特定日期以来发生的登录事件。</p><p>如果您只想查看2019年5月26日发生的登录事件，您可以使用以下命令：</p><code>last -R -s 2019-05-26</code><img class="content_img" src="/image/b1/b1e6d124dbc2e32664be51c88ee98a97.png" /><p>输出显示从指定日期的00：00到日志文件中的最新记录之间发生的登录事件的记录。</p><img class="content_img" src="/image/ea/ea8501c876cd54b1d20c3299a54535ac.png" /><p>搜索到结束日期</p><p>您可以使用-t(直到)指定结束日期。这允许您选择发生在两个感兴趣的日期之间的一组登录记录。</p><img class="content_img" src="/image/87/87c4b9a042b61aa5ab2efa003e62fc5c.png" /><p>此命令要求LAST检索并显示从26日00：00(黎明)到27日00：00(黎明)的登录记录。这将列表范围缩小到仅在26日发生的登录会话。</p><img class="content_img" src="/image/6e/6ee27c8f9d703179aa7b72e84b969cbe.png" /><p>时间和日期格式</p><p>您可以将时间和日期与-s和-t选项一起使用。</p><p>可以与使用日期和时间的最后一个选项一起使用的不同时间格式有(据称)：</p><p>
YYYYMMDDhhmmss。
YYYY-MM-DD HH：MM：SS。
YYYY-MM-DD HH：MM-秒设置为00。
YYYY-MM-DD-TIME设置为00：00：00。
hh：mm：ss-日期设置为今天。
HH：MM-日期将设置为今天，秒设置为00。
现在。
昨天-时间设置为00：00：00。
今天-时间设置为00：00：00。
明天-时间定为00：00：00。
+5分钟。
-5天</p><p>为什么“据称”？</p><p>在本文的研究期间，列表中的第二种和第三种格式不起作用。这些命令在Ubuntu、Fedora和Manjaro发行版上进行了测试。它们分别是Debian、RedHat和Arch发行版的派生版本。这涵盖了Linux发行版的所有主要系列。</p><code>last -R -s 2019-05-26 11:00 -t 2019-05-27 13:00</code><img class="content_img" src="/image/a1/a17c5197c5a4f07c33dee4b61bc8a5ff.png" /><p>如您所见，该命令根本没有返回任何记录。</p><p>使用列表中的第一个日期和时间格式，并且日期和时间与上一个命令相同，则会返回记录：</p><code>last -R -s 20190526110000 -t 20190527130000</code><img class="content_img" src="/image/43/43d5bc6b9ad92f4037b3d7b9faf21d11.png" /><p>按相对单位搜索</p><p>您还可以指定相对于当前日期和时间以分钟或天为单位的时间段。我们在这里要两天前到一天前的记录。</p><code>last -R -s -2days -t -1days</code><img class="content_img" src="/image/e4/e40d5cb6baadb9b14a7fc5f69de3fe33.png" /><p>昨天、今天和现在</p><p>你可以用昨天和明天作为昨天日期和今天日期的缩写。</p><code>last -R -s yesterday -t today</code><img class="content_img" src="/image/70/70feac084104121f5230b865de548d6f.png" /><p>这并不是说这将不包括今天的任何记录。这是预期的行为。该命令要求提供从开始日期到结束日期的记录。它不包括结束日期内的记录。</p><img class="content_img" src="/image/93/93e52106ec7ca67181ca7e5d6d6107d3.png" /><p>NOW选项是“当前时间的今天”的缩写。要查看从00：00(黎明)到发出命令为止发生的登录事件，请使用以下命令：</p><code>last -R -s today -t now</code><img class="content_img" src="/image/cf/cf0e9f47e5d3dcc3540f67e0a6a46e59.png" /><p>这将直接显示当前时间的所有登录事件，包括仍在登录的事件。</p><img class="content_img" src="/image/cd/cd9ed26030a4d392b2fc888a8f97fc4e.png" /><p>目前的选择</p><p>p(当前)选项允许您找出在某个时间点登录的用户。</p><p>他们何时登录或注销并不重要，但如果他们是在您指定的时间登录到计算机的，则他们将包括在列表中。</p><p>如果您指定的时间没有日期，则假定您的意思是“今天”。</p><code>last -R -p 09:30</code><img class="content_img" src="/image/6b/6b4c85436fd42eb7bbb09aaac920da01.png" /><p>仍在登录的人(显然)没有注销时间；他们被描述为仍在登录。如果计算机在您指定的时间之后没有重新启动，它将被列为仍在运行。</p><img class="content_img" src="/image/ad/add760a621cf41264ac414f7fa39eb31.png" /><p>如果将NOW速记与-p(当前)选项配合使用，则可以找出发出命令时登录的用户。</p><code>last -R -p now</code><img class="content_img" src="/image/4c/4c180d4853cd08a45fac963542425832.png" /><p>这是一种有点冗长的方式来实现使用WHO命令可以完成的任务。</p><img class="content_img" src="/image/f2/f25c9e4501fec1affeb64e6b4f958721.png" /><p>相关：如何在Linux中确定当前用户帐户</p><p>lastb命令</p><p>lastb命令值得一提的是。它从名为btmp的日志中读取数据。“b”代表“不好”，但“tmp”部分仍有争议。</p><p>lastb列出错误(失败)的登录尝试。它接受与上次相同的选项。因为它们都是失败的登录尝试，所以它们的条目都将具有00：00的持续时间。</p><p>您必须对lastb使用sudo。</p><code>sudo lastb -R</code><img class="content_img" src="/image/37/3779ed4c727e59fb0b92dfbce844dcf2.png" /><p>关于这件事的最后一句话</p><p>了解谁登录了您的Linux计算机，以及何时从何处登录，这是非常有用的信息。结合失败登录尝试的详细信息，您可以掌握调查可疑行为的第一步。</p><div class="item_info"><span class="item_key"><a href="/tag/登录/">登录</a></span><span class="item_key"><a href="/tag/日期/">日期</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14193.html">如何启用或禁用Windows 10的安全登录</a><li><a href="/story/14142.html">为什么您应该登录Google、Facebook或Apple</a><li><a href="/story/13987.html">不管怎么说，你为什么要登录你的家用电脑呢？</a><li><a href="/story/13856.html">科技行业想要破解密码。还是真的是这样？</a><li><a href="/story/13653.html">如何在Linux上使用PINKY命令</a><li><a href="/story/12947.html">Android获得FIDO2认证，实现快速、安全的网络登录</a><li><a href="/story/12622.html">微软希望从Windows10开始取消密码</a><li><a href="/story/12349.html">如何在Chromebook上更改密码</a><li><a href="/story/12032.html">如何阻止Chrome自动让您登录浏览器</a><li><a href="/story/12018.html">为什么网站让你登录这么多？</a><li><a href="/story/10785.html">如何查看登录到您的Facebook帐户的其他设备</a><li><a href="/story/10365.html">如何在Windows登录屏幕上查看以前的登录信息</a><li><a href="/story/8745.html">如何在Windows 10上更改登录屏幕背景</a><li><a href="/story/7913.html">如何使用Google Authenticator登录Linux桌面</a><li><a href="/story/7158.html">如何在使用多个Google帐户时设置默认帐户？</a><li><a href="/story/6823.html">如何在Quora上查看所有答案并绕过他们讨厌的登录</a><li><a href="/story/5166.html">如何在Windows 10中设置图片密码</a><li><a href="/story/4782.html">2012年9月的最佳使用方法极客文章</a><li><a href="/story/4721.html">如何查看登录到计算机的用户(以及登录时间)</a><li><a href="/story/3553.html">使用调整UI自动登录XP</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>