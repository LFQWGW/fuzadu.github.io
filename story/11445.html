<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何创建所有Windows用户帐户及其设置的纯文本列表</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何创建所有Windows用户帐户及其设置的纯文本列表</h2></div><div class="content"><img class="content_img" src="/image/95/95332ba7d611d6da020110d398b05d07.png" /><p>您总是可以使用设置界面在Windows系统上查找用户帐户，但是如果您想要保存包含该信息的漂亮的、打印机友好的文件，最简单的方法是转到命令提示符。</p><p>Windows提供了几种在命令提示符下与用户帐户交互的方式。您可能已经熟悉了第一个选项：net user命令。这里，我们将转向第二个选项：Windows Management Instrumentation Command-line(WMIC)，它实际上只是用于执行各种类型的系统管理的扩展命令行结构。您可以使用WMIC命令做各种事情，甚至可以做一些很酷的硬件事情，比如检查您的主板型号。我们将使用WMIC的useraccount命令部分，因为它提供了比net user命令更多的细节和选项。</p><p>相关：如何在Windows 10上设置和配置用户帐户</p><p>要开始使用WMIC命令，您需要使用管理权限打开命令提示符。按键盘上的Windows+X，然后从高级用户菜单中选择“命令提示符(管理员)”。</p><img class="content_img" src="/image/ae/ae6959d27463d2bfc818839fe8d0d1ec.png" /><p>注意：如果您在高级用户菜单上看到的是PowerShell而不是命令提示符，这是在Windows 10的创建者更新中产生的一个开关。如果您愿意，可以很容易地切换回在高级用户菜单上显示命令提示符，或者您也可以尝试一下PowerShell。您可以在PowerShell中执行命令提示符中可以执行的几乎所有操作，另外还有许多其他有用的功能。</p><p>相关：如何将命令提示符放回Windows+X Power Users菜单</p><p>获取仅包含用户帐户名的快速列表</p><p>如果您只需要帐户名列表而没有任何其他详细信息，请在提示符下键入以下命令，然后按Enter键：</p><code>wmic useraccount get name</code><img class="content_img" src="/image/af/af45fa5e12e194625aff600fbfd4ceeb.png" /><p>如您所见，您将获得一个仅包含用户帐户名的简单列表。列出的前三个名称将始终是内置管理员帐户、用于创建新用户帐户的默认帐户和Guest帐户。之后，您将看到列出了您在系统上创建的所有本地或Microsoft帐户。</p><p>如果您只需要更多的信息，您可以使用以下命令列出用户帐户名和用户的全名(如果已输入系统)：</p><code>wmic useraccount get name,fullname</code><img class="content_img" src="/image/59/59a2013ca30ac8086f33290d9bb2b6e5.png" /><p>在本例中，您可以看到“Michelle”和“Simon”帐户没有关联的全名，但是我的“wjgll”帐户有我的全名。</p><p>获取包含更多详细信息的用户帐户列表</p><p>如果要创建具有全套帐户详细信息的用户帐户列表，请在提示符下键入以下命令，然后按Enter键：</p><code>wmic useraccount list full</code><img class="content_img" src="/image/e0/e026e7460b319b423cfa714a68447108.png" /><p>该图像仅显示列表中的一个用户帐户及其所有详细信息。您可以看到用户帐户名和全名，以及如下所示的其他详细信息：</p><p>
AccountType。如果您使用的PC不是域的一部分-如果您使用的是家用或小型企业PC，几乎肯定会出现这种情况-您将始终看到帐户类型为512。如果PC是域的一部分，您将在此处看到表示它是哪种类型的域帐户的其他值。
描述。如果已输入帐户，则此值将显示帐户的说明。
禁用。这指示用户帐户是活动的还是禁用的。如果此值设置为False，则帐户处于活动状态。
域。这表示PC所属的域的名称。如果PC不是域的一部分，您将在此处看到一个以计算机类型开头的分配名称。
InstallDate。在域上，此值将显示用户帐户的创建日期。
本地帐户。该值指示帐户是存在于本地计算机上，还是存在于域服务器(如果计算机加入到域中)。
停摆。该值显示用户帐户当前是否被锁定，如果安全选项在多次密码尝试失败后锁定帐户，则会发生这种情况。
PasswordChangable、PasswordExpires和PasswordRequired。这些选项表示可能已为用户帐户设置的密码的安全选项。
希德。该值显示帐户的安全标识符(SID)。
SIDType。这是一个显示帐户使用的SID类型的数值。您可能会看到用户帐户的条目为1，组帐户的条目为2，域帐户的条目为3。
状况。这是用户帐户的当前状态。如果帐户可操作，您将看到帐户状态为“OK”或“Degraded”，这只是表示普通用户可用于登录系统的帐户。</p><p>顺便说一句，您可以使用任何用逗号分隔的详细名称来获得修改后的列表，这与我们在上一节中仅使用名称和全名的方法非常相似。例如，如果您只想查看帐户的名称、全名和状态，则可以使用以下命令：</p><code>wmic useraccount get name,fullname,status</code><img class="content_img" src="/image/32/321ed710a7a26dde2af7b3a0fa7880ab.png" /><p>因此，如果您只想动态查看用户帐户信息，这是很好的，但是当您将结果重定向到文本文件时，它会变得更加有用。</p><p>将命令结果重定向到文件</p><p>能够在命令提示符下查看用户帐户详细信息列表是非常棒的，但是这些命令的真正用处在于您可以将结果直接输送到文件中，然后可以保存或打印该文件。要使用任何wmic命令执行此操作，您只需将/output开关以及文件的路径直接添加到wmic命令之后即可。</p><p>例如，如果要使用前面的命令获取包含完整详细信息的用户帐户列表，并将输出重定向到C：\logs文件夹中名为useraccount ts.txt的文件，则应首先确保c：\logs文件夹已存在，然后使用以下命令：</p><code>wmic /output:C:\logs\useraccounts.txt useraccount list full</code><p>使用此命令时，在命令提示符下根本看不到任何结果，但如果打开您创建的文件，列表将显示在那里。</p><img class="content_img" src="/image/4e/4ebc33e95c7b1e8e950b5dfa4e3dc961.png" /><p>如果您想要更漂亮，还可以将输出定向到逗号分隔值(CSV)文件，然后可以轻松地将该文件导入到电子表格应用程序或数据库中。其中的诀窍在于，您还必须在命令的末尾添加/format：csv开关。因此，例如，如果您想要将我们上面使用的同一命令的输出重定向到CSV文件，您可以使用类似于以下命令的命令：</p><code>wmic /output:C:\logs\useraccounts.txt useraccount list full /format:csv</code><p>同样，在命令提示符下没有输出，但是您可以通过打开文件本身来查看结果。</p><img class="content_img" src="/image/4e/4e4b0410c151be2abc730557c0112c31.png" /><p>如果您将其导入到Microsoft Excel之类的文件中，只需少量工作即可获得格式化良好的表格。</p><img class="content_img" src="/image/fa/fa25ba1b2ac21fa01c2edf38378a8e13.png" /><p>当然，使用wmicuseraccount命令可以做更多的事情，包括更改一些用户帐户详细信息，比如帐户是锁定的还是解锁的。您可以通过键入wmic/？获取更多有关这方面的信息。在命令提示下。一般而言，您还可以使用wic命令执行更多操作。有关这方面的更多信息，请查看Microsoft的WMIC官方页面和Microsoft Performance Team博客中有用的WMIC查询列表。</p><div class="item_info"><span class="item_key"><a href="/tag/帐户/">帐户</a></span><span class="item_key"><a href="/tag/命令/">命令</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14483.html">如何在Windows 10的登录屏幕上更改您的姓名</a><li><a href="/story/14436.html">如何在Windows 10上设置iCloud电子邮件和日历访问</a><li><a href="/story/14366.html">如何将所有设备从您的松弛帐户中注销</a><li><a href="/story/14362.html">如何从您的Twitter帐户注销所有设备</a><li><a href="/story/14200.html">如何从Windows 10中删除PIN和其他登录选项</a><li><a href="/story/14181.html">如何在安装Windows 10时创建本地帐户</a><li><a href="/story/13065.html">如何在Mail for Mac中添加或删除电子邮件帐户</a><li><a href="/story/12607.html">Windows更新中断管理员帐户、FLAC音频和Windows沙盒</a><li><a href="/story/12315.html">如何启用或禁用Windows 10用户帐户</a><li><a href="/story/11848.html">如何在您的Nest帐户上启用双因素身份验证</a><li><a href="/story/11513.html">如何修复Apple Mail在Mac上从错误的电子邮件地址发送电子邮件</a><li><a href="/story/11320.html">如何在Windows 10中以本地用户帐户使用Cortana</a><li><a href="/story/11232.html">如何删除您的亚马逊帐户</a><li><a href="/story/11184.html">如何在Windows 10中创建来宾帐户</a><li><a href="/story/11183.html">如何删除您的Twitter帐户</a><li><a href="/story/11173.html">如何删除您的雅虎邮箱帐户</a><li><a href="/story/10502.html">如何在开始菜单上为Windows 10 Mail中的每个帐户制作动态磁贴</a><li><a href="/story/10143.html">如何在Xbox One上启用家长控制</a><li><a href="/story/9793.html">如何在PlayStation4上启用家长控制</a><li><a href="/story/9152.html">如何在Windows 10中设置和自定义电子邮件帐户</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>