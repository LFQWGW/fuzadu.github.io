<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何在Microsoft Excel中将文本转换为日期值</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何在Microsoft Excel中将文本转换为日期值</h2></div><div class="content"><img class="content_img" src="/image/65/65f9e548ada8393d8e339342d505a06a.png" /><p>分析业务数据通常需要使用Excel中的日期值来回答诸如“我们今天赚了多少钱”或“与上周同一天相比如何”之类的问题。当Excel不能将这些值识别为日期时，这可能会很困难。</p><p>不幸的是，这并不罕见，特别是当多个用户键入此信息、从其他系统复制和粘贴以及从数据库导入时。</p><p>在本文中，我们将描述四种不同的场景和将文本转换为日期值的解决方案。</p><p>包含句号/句点的日期</p><p>初学者在Excel中键入日期时最常见的错误之一可能是使用句号字符分隔日、月和年。</p><p>Excel不会将其识别为日期值，并将其存储为文本。但是，您可以使用“查找和替换”工具解决此问题。通过将句号替换为斜杠(/)，Excel将自动将这些值标识为日期。</p><p>选择要对其执行查找和替换的列。</p><img class="content_img" src="/image/dc/dcce9c06b2c71d595003fae448dfece6.png" /><p>单击主页&gt;查找和选择&gt;替换-或按Ctrl+H。</p><img class="content_img" src="/image/6b/6b2361f6ca2ae78a54076ddebd386b07.png" /><p>在“查找和替换”窗口中，键入句号(.)。在“查找内容”字段中添加一个斜杠(/)，在“替换为”字段中添加一个斜杠(/)。然后，单击“全部替换”。</p><img class="content_img" src="/image/1f/1fd2c3e5595e118c103f5319b185c377.png" /><p>所有句号都转换为斜杠，Excel会将新格式识别为日期。</p><img class="content_img" src="/image/22/221e5b0e720a7a3a3fde36e36f893142.png" /><p>如果您的电子表格数据定期更改，并且您需要针对此方案的自动解决方案，则可以使用替换功能。</p><code>=VALUE(SUBSTITUTE(A2,".","/"))</code><p>替换函数是文本函数，因此无法将其本身转换为日期。VALUE函数将文本值转换为数字值。</p><p>结果如下所示。需要将该值格式化为日期。</p><img class="content_img" src="/image/66/666b4875366638be1d7f03fe94a6045a.png" /><p>您可以使用“主页”选项卡上的“数字格式”列表来完成此操作。</p><img class="content_img" src="/image/e1/e1200b6998d78b2d4f2e857c5bf56b01.png" /><p>这里的句号分隔符示例是典型的。但是您可以使用相同的技术替换或替换任何分隔符。</p><p>转换yyyymmdd格式</p><p>如果您收到如下所示格式的日期，则需要使用不同的方法。</p><img class="content_img" src="/image/6e/6e03c9f091491993c65ae54a6beaceec.png" /><p>这种格式在技术上是相当标准的，因为它消除了关于不同国家如何存储其日期值的任何模棱两可的地方。但是，Excel最初不会理解它。</p><p>对于快速手动解决方案，您可以使用文本到列。</p><p>选择需要转换的值范围，然后单击数据&gt;文本到列。</p><img class="content_img" src="/image/4d/4d4f82d573a3753ffec843c46f491647.png" /><p>此时将出现“文本到列”向导。在前两个步骤中单击“下一步”，进入第三步，如下图所示。选择日期，然后从列表中选择单元格中使用的日期格式。在本例中，我们处理的是一种YMD格式。</p><img class="content_img" src="/image/44/442bd1277d8e2d456d289ef70b414ca4.png" /><p>如果您想要公式解，那么您可以使用DATE函数来构造日期。</p><p>这将与文本函数Left、Mid和Right一起使用，从单元格内容中提取日期的三个部分(日、月、年)。</p><p>下面的公式使用我们的样本数据显示了此公式。</p><code>=DATE(LEFT(A2,4),MID(A2,5,2),RIGHT(A2,2))</code><img class="content_img" src="/image/f6/f61b959a3c6e2480f59fb68cd3f5dd72.png" /><p>使用这两种技术中的任何一种，都可以转换任何八位数值。例如，您可能会收到ddmmyyyy格式或mmddyyyy格式的日期。</p><p>DATEVALUE和VALUE函数</p><p>有时，问题不是由分隔符字符引起的，而是因为它存储为文本而具有尴尬的日期结构。</p><p>下面是各种结构的日期列表，但我们都可以将它们识别为日期。不幸的是，它们已存储为文本，需要转换。</p><img class="content_img" src="/image/4f/4fbb1411cf5e01a3be6329610edca775.png" /><p>对于这些场景，很容易使用各种技术进行转换。</p><p>在本文中，我想提到两个处理这些场景的函数。它们是DATEVALUE和VALUE。</p><p>DATEVALUE函数将文本转换为日期值(可能已经看到)，而VALUE函数将文本转换为通用数字值。它们之间的差别微乎其微。</p><p>在上图中，其中一个值也包含时间信息。这将是两个功能之间细微差异的展示。</p><p>下面的DATEVALUE公式会将每个值转换为日期值。</p><code>=DATEVALUE(A2)</code><img class="content_img" src="/image/d0/d0913c737ca73b5542f6e3a6ebf8decb.png" /><p>注意时间是如何从第4行的结果中删除的。这个公式严格地只返回日期值。结果仍然需要格式化为日期。</p><p>以下公式使用VALUE函数。</p><code>=VALUE(A2)</code><img class="content_img" src="/image/17/176d96912477844b20bcb9ebf694dfdb.png" /><p>此公式将产生相同的结果，但在第4行中，时间值也会保持不变。</p><p>然后可以将结果格式化为日期和时间，或设置为日期以隐藏时间值(但不能删除)。</p><div class="item_info"><span class="item_key"><a href="/tag/日期/">日期</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/替换/">替换</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14375.html">如何在Google Sheet中计算两个日期之间的天数</a><li><a href="/story/13443.html">如何在Linux上使用最后一个命令</a><li><a href="/story/12791.html">使用Excel计算距离事件发生还有多少天</a><li><a href="/story/10691.html">如何在自动更新的Word文档中插入当前月份和年份</a><li><a href="/story/10444.html">如何更改Mac的语言和区域设置</a><li><a href="/story/10314.html">如何使用记事本创建带日期的日志或日记文件</a><li><a href="/story/9831.html">如何在Windows10中更改日期和时间的格式</a><li><a href="/story/9800.html">如何在Excel中使用日期中的句点</a><li><a href="/story/8282.html">如何设置Word中使用的默认短日期和长日期和时间格式</a><li><a href="/story/8247.html">如何在Microsoft Word中轻松插入格式化的日期和时间</a><li><a href="/story/7194.html">如何将星期几放入Windows任务栏时钟中</a><li><a href="/story/6576.html">您应该了解的有用函数</a><li><a href="/story/5695.html">如何在Outlook 2013中快速跳转到日期</a><li><a href="/story/4937.html">如何在Windows计算器中执行日期计算</a><li><a href="/story/3238.html">如何自定义Windows 7任务栏中的日期格式</a><li><a href="/story/1537.html">在Windows 7中更改系统托盘时钟下的显示</a><li><a href="/story/714.html">如何在Windows Vista和7中从特定日期范围搜索文件</a><li><a href="/story/585.html">使用Outlook 2007的待办事项栏从任务快速创建约会</a><li><a href="/story/394.html">Outlook 2007中的“制作待办事项栏”仅显示今天的任务</a><li><a href="/story/96.html">在Solaris上设置日期和时间</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>