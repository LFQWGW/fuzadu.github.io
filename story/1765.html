<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何在Excel中使用VLOOKUP</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何在Excel中使用VLOOKUP</h2></div><div class="content"><img class="content_img" src="/image/35/3542315dfd037968a0b15da00fbb45e6.png" /><p>VLOOKUP是Excel中最有用的函数之一，也是最不被理解的函数之一。在本文中，我们将通过一个真实的例子来揭开VLOOKUP的神秘面纱。“我们将为一家虚构的公司创建一个可用的发票模板。</p><p>VLOOKUP是一个Excel函数。本文将假定读者已经对Excel函数有了较好的了解，并且可以使用诸如SUM、Average和TODAY等基本函数。在其最常见的用法中，VLOOKUP是一个数据库函数，这意味着它可以处理数据库表-或者更简单地说，是Excel工作表中的内容列表。什么类型的内容？嗯，任何类型的内容。您可能有一个包含员工列表、产品列表、客户列表或CD列表的工作表</p><p>下面是一个列表或数据库的示例。在本例中，它是我们虚构的公司销售的产品列表：</p><img class="content_img" src="/image/fa/fab514e8153bd412814c5e67603fb627.png" /><p>通常，这样的列表对列表中的每一项都有某种唯一标识符。在这种情况下，唯一标识符在“Item Code”列中。1注意：要使VLOOKUP函数与数据库/列表一起使用，该列表必须有一个包含唯一标识符(或“key”或“ID”)的列，并且该列必须是表中的第一列。我们上面的示例数据库满足此条件。</p><p>使用VLOOKUP最困难的部分是准确地理解它的用途。所以让我们看看我们是否能先弄清楚这一点：</p><p>在上面的示例中，您将把VLOOKUP函数插入到另一个带有项目代码的电子表格中，它将返回给您原始列表中描述的相应项目的描述、价格或可用性(其“库存”数量)。它将向您返回这些信息中的哪一条？嗯，您可以在创建公式时决定这一点。</p><p>如果您所需要的只是数据库中的一条信息，那么使用VLOOKUP函数构造公式将会非常麻烦。通常您会在可重用的电子表格(如模板)中使用这种功能。*每次有人输入有效的项目代码时，系统都会检索有关相应项目的所有必要信息。*如果您需要的只是数据库中的一条信息，那么构建一个带有VLOOKUP函数的公式将会非常麻烦。通常情况下，您会在可重用的电子表格(如模板)中使用这种功能。</p><p>让我们创建一个这样的示例：创建一个发票模板，我们可以在我们虚构的公司中反复使用它。</p><p>首先，我们启动Excel，然后为自己创建一张空白发票：</p><img class="content_img" src="/image/5d/5d087e0a838d89dd321543183c41d912.png" /><p>它的工作原理是这样的：使用发票模板的人将在“A”栏中填写一系列项目代码，系统将从我们的产品数据库中检索每一项项目的描述和价格。该信息将用于计算每个项目的行合计(假设我们输入了有效数量)。</p><p>为保持此示例的简单性，我们将产品数据库定位在同一工作簿中的单独工作表上：</p><img class="content_img" src="/image/e9/e9e49e8e500ae641fe0b553e06047bc8.jpg" /><p>实际上，产品数据库更有可能位于单独的工作簿中。这对VLOOKUP函数几乎没有影响，它实际上并不关心数据库位于同一工作表、不同的工作表还是完全不同的工作簿上。</p><p>因此，我们已经创建了我们的产品数据库，如下所示：</p><img class="content_img" src="/image/fa/fab514e8153bd412814c5e67603fb627.png" /><p>为了测试我们即将编写的VLOOKUP公式，我们首先在空白发票的单元格A11中输入有效的项目代码：</p><img class="content_img" src="/image/a5/a569f85c5343022d121ab17676964a9c.png" /><p>接下来，我们将活动单元格移动到希望存储VLOOKUP从数据库中检索到的信息的单元格。有趣的是，这是大多数人都会犯错误的步骤。我想进一步解释：“我们即将创建一个VLOOKUP公式，该公式将检索与单元格A11中的项目代码相对应的说明。当我们获得此描述时，我们希望将其放在哪里？当然是放在单元格B11中。因此，我们就是在这里编写VLOOKUP公式：in。现在选择单元格B11。</p><img class="content_img" src="/image/ef/efd2dc9e1466dabcf0ea3fd81a91f99e.png" /><p>我们需要找到Excel必须提供的所有可用函数的列表，以便我们可以选择VLOOKUP，并在完成公式时获得一些帮助。要找到此列表，请先单击Forms选项卡，然后单击Insert Function：</p><img class="content_img" src="/image/53/53a5fed7de7e12882b834063233bb13c.jpg" /><p>此时会出现一个框，允许我们选择Excel中的任何可用函数。</p><img class="content_img" src="/image/1d/1d979f1c6572688b3d209d01e2dc553e.png" /><p>要查找我们要查找的函数，我们可以键入类似“Lookup”的搜索词(因为我们感兴趣的函数是查找函数)。系统将返回Excel中所有与查找相关的函数的列表。“VLOOKUP”是列表中的第二个函数。“选择它并单击”确定“。”</p><img class="content_img" src="/image/5d/5d64cbf5e6e7f06b48ecc696c466c177.png" /><p>此时会出现函数参数框，提示我们输入完成VLOOKUP函数所需的所有参数(或参数)。您可以将此框视为询问以下问题的函数：</p><p>
您在数据库中查找的唯一标识符是什么？
数据库在哪里？
您希望从数据库中检索与唯一标识符关联的哪条信息？</p><p>前三个参数以粗体显示，表示它们是必选参数(VLOOKUP函数没有它们是不完整的，不会返回有效值)。*第四个参数不是粗体，表示它是可选的：</p><img class="content_img" src="/image/0a/0af720246ebb1fc43879a15e4dc8088d.png" /><p>我们将按照从上到下的顺序完成论证。</p><p>我们需要完成的第一个参数是LOOKUP_VALUE参数。该函数需要我们告诉它在哪里可以找到它应该返回描述的唯一标识符(在本例中是项目代码)。我们必须选择我们之前输入的项目代码(在A11中)。</p><p>单击第一个参数右侧的选择器图标：</p><img class="content_img" src="/image/43/43b9a894fb6bb865cc49c5e909cb27ce.png" /><p>然后在包含项目代码(A11)的单元格上单击一次，然后按Enter键：</p><img class="content_img" src="/image/4e/4efaa6b86b1c4aa0578f9b0e2a420fef.jpg" /><p>“A11”的值被插入到第一个参数中。</p><p>现在我们需要为TABLE_ARRAY参数输入值。*换句话说，我们需要告诉VLOOKUP在哪里可以找到数据库/列表。*单击第二个参数旁边的选择器图标：</p><img class="content_img" src="/image/05/05ab0c3d8f7fa6c56991d5312a67d1e8.png" /><p>现在找到数据库/列表并选择整个列表-不包括标题行。*在我们的示例中，数据库位于单独的工作表上，因此我们首先单击该工作表选项卡：</p><img class="content_img" src="/image/25/25e19bdf9da16fd648961e12baba9bec.jpg" /><p>接下来，我们选择整个数据库，不包括标题行：</p><img class="content_img" src="/image/a7/a73e0b895005cb3d9928fb153d02da73.jpg" /><p>…。然后按Enter键。表示数据库的单元格范围(在本例中为“‘Product Database’！A2：D7”)将自动输入到第二个参数中。</p><p>现在我们需要输入第三个参数COL_INDEX_NUM。-我们使用此参数向VLOOKUP指定我们希望返回给我们的数据库中与我们的项目代码A11相关联的哪一条信息。*在此特定示例中，我们希望将项目的描述返回给我们。如果您查看数据库工作表，您会注意到“DESCRIPTION”列是数据库中的第二列。这意味着我们必须在COL_INDEX中输入值“2”。这意味着我们必须将值“2”输入到COL_INDEX中。*如果您查看数据库工作表，您会注意到“Description”列是数据库中的第二列。这意味着我们必须在COL_INDEX中输入值“2”</p><img class="content_img" src="/image/4f/4fe240c56b9598995fa2f05201099ca7.png" /><p>重要的是要注意，我们在这里输入的不是“2”，因为“Description”列在该工作表的B列中。*如果数据库恰好从工作表的K列开始，我们仍然会在此字段中输入“2”，因为“Description”列是我们在指定“Table_array”时选择的单元格集中的第二列。</p><p>最后，我们需要决定是否在最终的VLOOKUP参数RANGE_LOOKUP中输入值。*此参数需要TRUE或FALSE值，或者应保留为空。当将VLOOKUP与数据库一起使用时(90%的情况下为TRUE)，决定在此参数中输入什么内容的方法可以考虑如下：</p><p>由于数据库的第一列未排序，因此我们在此参数中输入False：</p><img class="content_img" src="/image/ba/baf0bc295123efe9e2b6ced5bc683a96.png" /><p>就是这样！！我们已经输入了VLOOKUP返回我们需要的值所需的所有信息。_点击OK按钮，注意到与项目代码“R99245”相对应的描述已经正确地输入到单元格B11中：</p><img class="content_img" src="/image/9b/9b49a8c94268b3e22c65f0489e2fabf5.png" /><p>为我们创建的公式如下所示：</p><img class="content_img" src="/image/c8/c83f2341302c2d14934f1912268c8eba.png" /><p>如果我们在单元格A11中输入不同的项目代码，我们将开始看到VLOOKUP函数的威力：说明单元格会更改以匹配新的项目代码：</p><img class="content_img" src="/image/66/6625a306d8996594e060a064da6096be.png" /><p>我们可以执行一组类似的步骤，将商品的价格返回到单元格E11。请注意，必须在单元格E11中创建新公式。结果将如下所示：</p><img class="content_img" src="/image/62/6256271f8aa6e804ff5c81e7c82629d9.png" /><p>…。公式将如下所示：</p><img class="content_img" src="/image/41/41d7b5a199963e433c9d8c9a1bcb4212.png" /><p>请注意，这两个公式之间的唯一区别是第三个参数(COL_INDEX_NUM)已从“2”变为“3”(因为我们希望从数据库的第三列检索数据)。</p><p>如果我们决定购买其中2个项目，我们将在单元格D11中输入“2”。“然后，我们将在单元格F11中输入一个简单的公式，以获得行总数：</p><p>…。它看起来像这个…</p><img class="content_img" src="/image/79/79b84b8aa3b9a50c5274860343946a1e.png" /><p>填写发票模板</p><p>到目前为止，我们已经了解了很多关于VLOOKUP的知识。事实上，我们已经了解了我们在这篇文章中将要学到的所有知识。*需要注意的是，除了数据库之外，VLOOKUP还可以在其他情况下使用。*这不太常见，可能会在未来的How-to Geek文章中介绍。</p><p>我们的发票模板尚未完成。为了完成它，我们将执行以下操作：</p><p>
我们将从单元格A11中删除样本项目代码，并从单元格D11中删除“2”。这将导致我们新创建的VLOOKUP公式显示错误消息：

我们可以通过明智地使用EXCEL的IF()和ISBLANK()函数来纠正这一点。“我们从这个…更改了我们的公式。*=VLOOKUP(A11，‘产品数据库’！A2：D7，2，FALSE)…。到此…。=IF(ISBLANK(A11)，“”，VLOOKUP(A11，‘产品数据库’！A2：D7，2，FALSE))。

我们会将单元格B11、E11和F11中的公式向下复制到发票项目行的其余部分。*请注意，如果这样做，生成的公式将不再正确引用数据库表。*我们可以通过将数据库的单元格引用更改为绝对单元格引用来解决此问题。此外，我们还可以为整个产品数据库(如“Products”)创建一个范围名称(例如“Products”)，并使用此范围名称而不是单元格引用。*公式将从此…更改。=if(ISBLANK(A11)，“”，VLOOKUP(A11，‘产品数据库’！A2：D7，2，FALSE))…。到此…。=if(ISBLANK(A11)，“”，VLOOKUP(A11，Products，2，False))…。然后将公式向下复制到发票项目的其余行。
我们可能会“锁定”包含我们的公式的单元格(或者更确切地说，解锁其他单元格)，然后保护工作表，以确保在有人填写发票时，我们精心构建的公式不会被意外覆盖。
我们会将文件另存为模板，这样我们公司的每个人都可以重用它</p><p>如果我们感觉真的很聪明，我们会在另一个工作表中创建所有客户的数据库，然后使用在单元格F5中输入的客户ID自动在单元格B6、B7和B8中填写客户的名称和地址。</p><img class="content_img" src="/image/88/88588ae56fa39b81e84fa2a911ff4f9e.png" /><p>如果您想练习VLOOKUP，或者只是想看看我们生成的发票模板，可以从这里下载。</p><div class="item_info"><span class="item_key"><a href="/tag/单元格/">单元格</a></span><span class="item_key"><a href="/tag/数据库/">数据库</a></span><span class="item_key"><a href="/tag/函数/">函数</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14509.html">如何在Google Sheet中对单元格中的文本进行换行</a><li><a href="/story/14376.html">如何在Google Sheets中连接多个单元格中的数据</a><li><a href="/story/14349.html">使用Google Sheet的模式函数查找频繁出现的值</a><li><a href="/story/14348.html">如何计算Google Sheet中的空白或空单元格</a><li><a href="/story/14280.html">如何在谷歌表格中进行数字除法</a><li><a href="/story/14143.html">如何从另一个Google工作表导入数据</a><li><a href="/story/13834.html">关于Excel中的联合创作，您需要了解的所有内容</a><li><a href="/story/12576.html">如何使用Microsoft Excel计算Z分数</a><li><a href="/story/11565.html">如何将下拉列表添加到Excel中的单元格</a><li><a href="/story/9181.html">如何在Excel中跨多个单元格居中显示文本</a><li><a href="/story/8454.html">如何在Excel中隐藏注释、公式、溢出文本和网格线</a><li><a href="/story/6574.html">相对和绝对单元格引用，以及格式设置</a><li><a href="/story/5592.html">向Excel 2013中的公式和单元格添加注释</a><li><a href="/story/2787.html">如何使用条件格式在Excel中突出显示行</a><li><a href="/story/1045.html">使用条件格式在Excel2007中查找重复数据</a><li><a href="/story/648.html">如何在Word中将表嵌套在表中</a><li><a href="/story/389.html">使Excel 2007在单元格中自动换行</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>