<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何使用Google Sheets中的查询功能</title><link rel="stylesheet" href="/css.css"></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>如何使用Google Sheets中的查询功能</h2></div><div class="content"><img class="content_img" src="/image/fe/fe1320b4b97a870f7679cfbe7ea097c2.jpg" /><p>如果您需要操作Google Sheet中的数据，查询功能可以提供帮助！它为您的电子表格带来了强大的数据库式搜索，因此您可以按您喜欢的任何格式查找和过滤数据。我们将向您介绍如何使用它。</p><p>使用查询功能</p><p>如果您曾经使用SQL与数据库交互，那么掌握查询函数并不太难。典型查询函数的格式类似于SQL，并为Google Sheet带来了数据库搜索的强大功能。</p><p>使用查询函数的公式格式为=Query(Data，Query，Header)。您可以将“data”替换为您的单元格区域(例如，“A2：D12”或“A：D”)，并将“query”替换为您的搜索查询。</p><p>可选的“Headers”参数设置要包括在数据区域顶部的标题行数。如果有一个标题分布在两个单元格上，如A1中的“First”和A2中的“Name”，这将指定查询使用前两行的内容作为组合标题。</p><p>在下面的示例中，Google Sheets电子表格的一个表格(称为“员工列表”)包括一个员工列表。它包括他们的姓名、员工ID号、出生日期，以及他们是否参加了强制性的员工培训课程。</p><img class="content_img" src="/image/cb/cb53b12b63bfcbc05154d4c6d5e803d5.png" /><p>在第二张工作表上，您可以使用查询公式提取所有未参加强制性培训课程的员工的列表。此列表将包括员工ID号码、名字、姓氏以及他们是否参加了培训课程。</p><p>要对上面显示的数据执行此操作，您可以键入=query(‘Staff List’！A2：E12，“SELECT A，B，C，E where E=‘No’”)。这将查询“人员列表”工作表上A2到E12范围内的数据。</p><p>与典型的SQL查询一样，查询函数选择要显示的列(SELECT)并标识搜索参数(WHERE)。它返回列A、B、C和E，提供所有匹配行的列表，其中列E(“Attendted Training”)中的值是包含“No”的文本字符串。</p><img class="content_img" src="/image/00/00c94436849f9a7e514d27c39f14bf2c.png" /><p>如上所示，最初名单中的四名员工没有参加过培训课程。查询函数提供了此信息，以及匹配列，以便在单独的列表中显示他们的姓名和员工ID号。</p><p>此示例使用非常特定的数据范围。您可以将其更改为查询A到E列中的所有数据。这将允许您继续向列表中添加新员工。每当您添加新员工或有人参加培训课程时，您使用的查询公式也会自动更新。</p><p>此操作的正确公式为=Query(‘Staff List’！A2：E，“Select A，B，C，E where E=‘No’”)。此公式忽略单元格A1中的初始“Employees”头衔。</p><p>如果将未参加培训的第11名员工添加到初始列表中，如下所示(Christine Smith)，则查询公式也会更新，并显示新员工。</p><img class="content_img" src="/image/ce/cee0b7c8be856346b96a06b469122226.png" /><p>高级查询公式</p><p>查询功能多种多样。它允许您使用其他逻辑运算(如AND和OR)或Google函数(如COUNT)作为搜索的一部分。还可以使用比较运算符(大于、小于等)查找两个图形之间的值。</p><p>将比较运算符用于查询</p><p>您可以使用带有比较运算符(如小于、大于或等于)的查询来缩小和筛选数据范围。为此，我们将在“员工列表”表中添加一个额外的列(F)，其中包含每个员工获得的奖励数量。</p><p>使用查询，我们可以搜索至少获得一个奖项的所有员工。此公式的格式为=Query(‘Staff List’！A2：F12，“SELECT A，B，C，D，E，F where F where F&gt;0”)。</p><p>它使用大于比较运算符(&gt;)在F列中搜索大于零的值。</p><img class="content_img" src="/image/14/14b7aa101af12c8e3751efb2325d6591.png" /><p>上面的示例显示了查询函数返回了获得一个或多个奖项的八名员工的列表。在总共11名员工中，有3名从未获奖。</p><p>使用AND和OR WITH QUERY</p><p>嵌套的逻辑运算符函数(如AND和OR)可以在较大的查询公式中很好地工作，以将多个搜索条件添加到您的公式中。</p><p>相关：如何在Google Sheets中使用AND和OR函数</p><p>测试和的一个好方法是搜索两个日期之间的数据。如果我们使用员工列表示例，我们可以列出1980到1989年间出生的所有员工。</p><p>这还利用了比较运算符，如大于或等于(&gt;=)和小于或等于(&lt;=)。</p><p>此公式的格式为=Query(‘Staff List’！A2：E12，“SELECT A，B，C，D，E where D&gt;=date‘1980-1-1’and D&lt;=date‘1989-12-31’”)。它还使用一个额外的嵌套日期函数来正确解析日期时间戳，并查找1980年1月1日和1989年12月31日之间的所有生日。</p><img class="content_img" src="/image/02/02cdac08de33ce885743edc6d6b14189.png" /><p>如上所示，出生于1980年、1986年和1983年的三名员工符合这些要求。</p><p>也可以使用OR产生类似的结果。如果我们使用相同的数据，但更改日期并使用OR，我们可以排除所有80年代出生的员工。</p><p>此公式的格式将为=Query(‘Staff List’！A2：E12，“SELECT A，B，C，D，E where D&gt;=date‘1989-12-31’or D&lt;=date‘1980-1-1’”)。</p><img class="content_img" src="/image/d9/d9798c502eadb5b4963973d7ff48df12.png" /><p>在最初的10名员工中，有3名出生于80年代。上面的例子显示了剩下的7个人，他们都出生在我们排除的日期之前或之后。</p><p>使用COUNT WITH QUERY</p><p>除了简单地搜索和返回数据之外，您还可以将查询与其他函数(如Count)混合使用来操作数据。比方说，我们要清除名单上所有参加过和没有参加过强制性培训课程的员工。</p><p>为此，您可以将查询与计数结合使用，如下所示：=query(‘Staff List’！A2：E12，“SELECT E，COUNT(E)GROUP BY E”)。</p><img class="content_img" src="/image/70/70c6e7da08efe19c9c196dc35e1509a9.png" /><p>聚焦于E列(“已参加培训”)，查询函数使用COUNT计算找到每种类型的值(“是”或“否”文本字符串)的次数。从我们的名单中，有6名员工完成了培训，4名员工没有完成培训。</p><p>您可以很容易地更改此公式，并将其与其他类型的Google函数(如SUM)一起使用。</p><div class="item_info"><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/查询/">查询</a></span><span class="item_key"><a href="/tag/员工/">员工</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/14584.html">如何检查Linux上安装了哪个GPU</a><li><a href="/story/14577.html">如何检查Linux上安装了哪个GPU</a><li><a href="/story/14572.html">如何使用Jouralctl读取Linux系统日志</a><li><a href="/story/14555.html">2020年CES最佳：我们今年看到的所有最好的东西</a><li><a href="/story/14467.html">如何在Windows 10上切换到本地用户帐户</a><li><a href="/story/14450.html">如何在Excel中将一长列变为多列</a><li><a href="/story/14438.html">如何在iPhone上创建和使用Memoji和Animoji</a><li><a href="/story/14419.html">如何在Linux中获取文件或目录的大小</a><li><a href="/story/14377.html">如何在Google Sheets中使用AND和OR函数</a><li><a href="/story/14353.html">如何使用触摸板、鼠标或键盘右键单击任何Mac</a><li><a href="/story/14296.html">如果您的Windows 10键盘或鼠标无法工作，该怎么办</a><li><a href="/story/14262.html">iPhone11上的Deep Fusion摄像头是什么？</a><li><a href="/story/14257.html">如何在Linux上编写fstab文件</a><li><a href="/story/14202.html">什么是利特语，你是如何使用它的？</a><li><a href="/story/14168.html">刚刚更新到iOS 13吗？立即更改这八个设置</a><li><a href="/story/14142.html">为什么您应该登录Google、Facebook或Apple</a><li><a href="/story/14130.html">如何在Windows 10中的每个显示器上设置不同的墙纸</a><li><a href="/story/14121.html">如何在Linux上使用chroot命令</a><li><a href="/story/14036.html">如何在Chrome中从图像中抓取文本</a><li><a href="/story/14026.html">如何在Linux上使用chgrp命令</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>