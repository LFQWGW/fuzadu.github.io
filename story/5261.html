<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>极客学校：学习在PowerShell中使用Cmdlet</title><link rel="stylesheet" href="/css.css"><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?f75329719d379998b2421a4cc2396366";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="header"><a class="site_title" href="http://www.fuzadu.com">复杂度</a></div><div><div><h2>极客学校：学习在PowerShell中使用Cmdlet</h2></div><div class="content"><img class="content_img" src="/image/20/207ea41ab315096bfcdb3ed62317373a.png" /><p>如果您已经通过命令提示符使用了ipconfig或ping，那么您就已经成为PowerShell忍者的一半了。所以，快来加入我们的行列吧，我们将在这部极客学校的安装中发现cmdlet。</p><p>请务必阅读我们介绍PowerShell的第一篇文章，并在接下来的一周里继续关注我们的系列文章。</p><p>一个Cmdlet的解剖</p><p>在本系列的第一部分中，我们看到了一个类似以下内容的cmdlet：</p><p>PowerShell cmdlet具有动词-名词语法，如上所示。需要注意的重要一点是，即使cmdlet可能返回多个结果，名词也始终是单数。若要查看PowerShell中的合法谓词列表，可以使用Get-Verb cmdlet。</p><img class="content_img" src="/image/3b/3b859290175d3a03d45f0d5e7e1cfc8b.png" /><p>了解法律动词并记住单数名词规则确实有助于猜测cmdlet名称。例如，假设您想要获取服务及其状态的列表-没错，这就像Get-Service一样简单。您认为我们将如何获得正在运行的进程的列表-没错，get-process就可以做到这一点。</p><img class="content_img" src="/image/7b/7b801f56668a660e312ff1e518c3f828.png" /><p>这使得使用任何技术都变得非常容易。例如，如果您加载了Exchange cmdlet，我们可以使用以下命令轻松获取服务器上的邮箱列表：</p><p>然而，有一个例外。撇开Exchange不谈，所有其他特定于技术的命令都需要前缀。例如，如果我们想要获取当前通过远程桌面登录的用户，我们将键入：</p><p>这可以在下面的屏幕截图中看到。</p><p>注意：此屏幕截图是在Server 2012机顶盒上拍摄的，因为您可以在那里找到大多数特定于技术的模块。</p><img class="content_img" src="/image/9f/9f7a1cf055fe69f2c2768482bf14bfa2.png" /><p>不久前，我读到PowerShell教父Don Jones的一篇文章，他在文章中解释说，Exchange在此前缀被添加到cmdlet之前发货，因此它从未实现过它们，将来也永远不会实现它们。</p><p>别名</p><p>PowerShell附带的另一个功能是能够以多种方式运行相同的命令别名(如果您愿意的话)。令人敬畏的是，它们包含了许多您可能在命令提示符中使用的命令，以及一些Linux别名。例如，在PowerShell中，我们可以使用以下命令获取目录列表：</p><img class="content_img" src="/image/d3/d32851750b3c2e731f875422817403d3.png" /><p>习惯于使用命令提示符吗？别担心，他们会掩护你的。</p><img class="content_img" src="/image/92/92680ef89522e352e31a183d0e93528d.png" /><p>有Linux背景吗？他们也在那里掩护你。</p><img class="content_img" src="/image/b4/b45ea83899bd1025c9880c8fb0391fc0.png" /><p>如果您已经编写脚本几年了，您往往会变得懒惰，并且开始大量使用别名，但这对将要阅读我们代码的新手没有任何帮助。要查看别名在幕后运行的命令，可以使用以下命令：</p><img class="content_img" src="/image/f8/f83bccdcfd5dbee2cb1353fec7f557e3.png" /><p>另一方面，如果您觉得是时候升级游戏了，可以使用Definition参数获取cmdlet的所有别名：</p><img class="content_img" src="/image/77/77034f593004d00ad320fa42d1fadf98.png" /><p>如果您来自其他背景，您可以通过执行以下操作来添加您自己的别名：</p><p>显然，您需要将“icanhazfilez”替换为新别名的名称，并将Get-ChildItem替换为您希望它在引擎盖下运行的cmdlet。</p><img class="content_img" src="/image/67/670f9fa0cdfa70f42e8d4c0494f49af8.png" /><p>需要注意的一件事是，关闭shell时会丢失您定义的所有别名。您可以通过将它们的定义添加到您的配置文件脚本来解决此问题。</p><p>截断参数</p><p>Windows PowerShell还允许您截断参数名称，直到它们变得不明确为止，也就是说，直到PowerShell无法再找出您正在谈论的参数为止。例如：</p><img class="content_img" src="/image/34/34203628642651eddd8a1cffe2f1ef98.png" /><p>等同于：</p><img class="content_img" src="/image/c2/c2824234031871dfb206068add12ece9.png" /><p>如果您碰巧将参数名称设置得太不明确，您会得到一个错误。</p><p>旧版命令</p><p>最后，您熟悉和喜爱的命令仍然可以在PowerShell中使用。</p><img class="content_img" src="/image/30/3010c7446818e08dcd67daf64ee266c0.png" /><p>只需记住，像ping这样的遗留应用程序会输出一个字符串，而且使用PowerShell cmdlet通常有更好的方法来做同样的事情。</p><img class="content_img" src="/image/1d/1d6d275a3318277f38765fc088d57866.png" /><p>我们现在没有输出一长串文本，而是只剩下一个对象，我们将在明天的“极客学校”中来看看。</p><div class="item_info"><span class="item_key"><a href="/tag/powershell/">powershell</a></span><span class="item_key"><a href="/tag/使用/">使用</a></span><span class="item_key"><a href="/tag/cmdlet/">cmdlet</a></span></div></div><div class="relate_story"><div><h3>相关文章</h3></div><ul><li><a href="/story/11856.html">如何在Windows PowerShell中使用命令历史记录</a><li><a href="/story/11319.html">如何检查您的PC上是否启用了安全引导</a><li><a href="/story/10708.html">如何在Linux或OS X上安装Microsoft PowerShell</a><li><a href="/story/7708.html">如何配置Windows以更轻松地使用PowerShell脚本</a><li><a href="/story/7704.html">如何使用批处理文件使PowerShell脚本更易于运行</a><li><a href="/story/5949.html">从Microsoft下载免费PowerShell快速参考指南</a><li><a href="/story/5748.html">如何将“Open PowerShell here”添加到Windows文件夹的右键单击菜单中</a><li><a href="/story/5735.html">如何使用PowerShell解压ZIP文件</a><li><a href="/story/5632.html">PowerShell与Windows命令提示符的不同之处</a><li><a href="/story/5415.html">极客学校：编写您的第一个完整的PowerShell脚本</a><li><a href="/story/5395.html">极客学派：学习PowerShell变量、输入和输出</a><li><a href="/story/5297.html">Windows Server 2012中的DCPromo发生了什么变化？</a><li><a href="/story/5274.html">极客学校：学习在PowerShell中使用远程处理</a><li><a href="/story/5248.html">极客学校：了解如何使用PowerShell自动化Windows</a><li><a href="/story/5071.html">如何使用PowerShell映射网络驱动器</a><li><a href="/story/4817.html">如何创建PowerShell配置文件</a><li><a href="/story/4457.html">如何在远程计算机上运行PowerShell命令</a><li><a href="/story/4342.html">如何在Windows 8中同时运行PowerShell 2和PowerShell 3</a><li><a href="/story/2805.html">自定义PowerShell配置文件</a><li><a href="/story/2804.html">在PowerShell中添加带别名的快捷方式</a></ul></div></div><div id="footer">&copy 2020 fuzadu.com</div></body></html>